(()=>{"use strict";var n={461:function(e,r,t){var n=this&&this.__spreadArray||function(e,r,t){if(t||2===arguments.length)for(var n,a=0,i=r.length;a<i;a++)!n&&a in r||((n=n||Array.prototype.slice.call(r,0,a))[a]=r[a]);return e.concat(n||Array.prototype.slice.call(r))},t=(Object.defineProperty(r,"__esModule",{value:!0}),r.parse_shape=r.array=r.asarray=r.as_number=r.as_boolean=r.number_collapse=r.NDArray=void 0,t(216)),a=t.GLOBALS.np,t=t.GLOBALS.NDArray;if(!t)throw new Error("Programming error: NDArray not defined");function i(e,r){if(!e.shape.length)return e.flat[0];if(r=void 0===r?!1:r)throw new Error("Expected constant. Got array with shape ".concat(e.shape));return e}r.NDArray=t,r.number_collapse=i,r.as_boolean=function(e){if(e instanceof a.NDArray)e=i(e,!0);else if("string"==typeof e)throw new Error("'string' object can not be interpreted as boolean: ".concat(e));return!!(0+e)},r.as_number=function(e){if(e instanceof a.NDArray)e=i(e,!0);else if("string"==typeof e)throw new Error("'string' object can not be interpreted as boolean: ".concat(e));return parseFloat(e)},r.asarray=function(e){return e instanceof a.NDArray?e:a.fromJS(e)},r.array=function(e){var r;return e instanceof a.NDArray?(r=null==e._simpleIndexes?n([],e.flat,!0):e.flat,new a.NDArray(r,e.shape,e.dtype)):a.fromJS(e)},r.parse_shape=function(e){if(Array.isArray(e))return e;if(e instanceof a.NDArray){if(1<e.shape.length)throw new Error("Expected flat list. Got array with shape ".concat(e.shape));return e.flat}if("number"==typeof e)return[e];throw new Error("Expected list. Got ".concat(e))}},17:function(e,r,t){var s=this&&this.__spreadArray||function(e,r,t){if(t||2===arguments.length)for(var n,a=0,i=r.length;a<i;a++)!n&&a in r||((n=n||Array.prototype.slice.call(r,0,a))[a]=r[a]);return e.concat(n||Array.prototype.slice.call(r))},p=(Object.defineProperty(r,"__esModule",{value:!0}),r.ravel=r.reshape=r._new=void 0,t(461));r._new=function(e,r,t){var n=(e=(0,p.parse_shape)(e)).reduce(function(e,r){return e*r},1),n=Array.from({length:n},r);return new p.NDArray(n,e,t)},r.reshape=function(e,r){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];e=(0,p.asarray)(e),r=t.length?s([r],t,!0).map(p.as_number):(0,p.parse_shape)(r);var a=e.size,i=r.indexOf(-1);if(-1!==i){var o=r.filter(function(e){return-1!==e}).reduce(function(e,r){return e*r},1);if(a%o!=0)throw new Error("Invalid shape. The total number of elements must match the product of the known dimensions.");r[i]=a/o}return new p.NDArray(e.flat,r,e.dtype)},r.ravel=function(e){return e=(0,p.asarray)(e),new p.NDArray(e.flat,[e.size],e.dtype)}},811:function(e,r,t){var a=this&&this.__spreadArray||function(e,r,t){if(t||2===arguments.length)for(var n,a=0,i=r.length;a<i;a++)!n&&a in r||((n=n||Array.prototype.slice.call(r,0,a))[a]=r[a]);return e.concat(n||Array.prototype.slice.call(r))},s=(Object.defineProperty(r,"__esModule",{value:!0}),r.__parse_sliceRange=r.shape_shifts=void 0,t(461));Object.defineProperty(n.prototype,"indices",{get:function(){var e;return this._indices||(e=i(this.internalShape,this.__slices),this._indices=e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"__slices",{get:function(){return this.axisIndexes.map(function(e){return e.indices})},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"size",{get:function(){return this._size||(this._size=this.axisIndexes.map(function(e){return e.size}).reduce(function(e,r){return e*r},0))},enumerable:!1,configurable:!0});var d=n;function n(e,r,t){this.shape=e,this.internalShape=r,this.axisIndexes=t,this._indices=null,this._size=null,this.isSimple=this.axisIndexes.map(function(e){return e.isSimple}).reduce(function(e,r){return e&&r},!0),this.isConstant=this.axisIndexes.map(function(e){return e.isConstant}).reduce(function(e,r){return e&&r},!0)}function f(e){var r=Array.from({length:e.length},function(e){return 0});r[e.length-1]=1;for(var t=e.length-2;0<=t;t--)r[t]=r[t+1]*e[t+1];return r}function i(e,r){for(var t=0,n=r;t<n.length;t++)if(0==n[t].length)return[];for(var i=f(e),a=r.map(function(e,r){for(var t=[],n=e.length,a=0;a<n-1;a++)t.push(i[r]*(e[a+1]-e[a]));return t[n-1]=i[r]*(e[0]-e[n-1]),t}),o=[],s=e.length-1,p=new Array(e.length).fill(0),c=r.map(function(e,r){return e[p[r]]*i[r]}).reduce(function(e,r){return e+r},0);;){if(!isFinite(c))throw new Error("Programming error");o.push(c);for(var l=s;0<=l&&(c+=a[l][p[l]++],!(p[l]<a[l].length));)p[l--]=0;if(l<0)break}return o}r.shape_shifts=f,r.__parse_sliceRange=function(e,r){var t=r.start,n=r.stop,a=r.step;if(null==t?t=0:t<0&&(t=e+t),null==n?n=e:n<0&&(n=e+n),null==a)a=1;else if(0==a)throw new Error("Slice range with step size of zero");if(!isFinite(t)||!isFinite(n)||!isFinite(a))throw new Error("Invalid slice ".concat([t,n,a],". Axis size ").concat(e));var i=[];if(0<a)for(var t=Math.max(t,0),n=Math.min(n,e),o=t;o<n;o+=a)i.push(o);else{n=Math.max(n,0);for(o=t=Math.min(t,e);n<o;o+=a)i.push(o)}return i};Object.defineProperty(o.prototype,"indices",{get:function(){if(this._indices)return this._indices;if(":"==this.spec.type)a=Array.from({length:this.spec.size},function(e,r){return r});else if("number"===this.spec.type)a=[this.spec.index];else if("array"===this.spec.type)a=this.spec.indices;else{if("range"!=this.spec.type)throw new Error("Unknown spec type ".concat(this.spec.type));var e=this.spec.range,r=e.nSteps,t=e.step,n=e.start,a=Array.from({length:r},function(e,r){return n+r*t})}return this._indices=a},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"size",{get:function(){if(":"==this.spec.type)return this.spec.size;if("number"===this.spec.type)return 1;if("array"===this.spec.type)return this.spec.indices.length;if("range"==this.spec.type)return this.spec.range.nSteps;throw new Error("Unknown spec type ".concat(this.spec.type))},enumerable:!1,configurable:!0});var g=o;function o(e){this.spec=e,this._indices=null,this.isSimple="array"!=this.spec.type,this.isConstant="number"==this.spec.type}g.prototype.parse_range=function(a,e,r,t){if(void 0===e&&(e=null),void 0===r&&(r=null),null==(t=void 0===t?null:t))t=1;else if(0==t)throw new Error("Index specification error. Step must be different from zero.");function n(e,r,t,n){return null==e?r:(e<0&&(e=Math.max(0,a-e)),Math.min(n,Math.max(t,e)))}return r=0<t?(e=n(e,0,0,a-1),n(r,a,0,a)):(e=n(e,a-1,0,a-1),n(r,a-1,-1,a-1)),r=Math.max(r,e),{start:e,step:t,nSteps:Math.floor(Math.abs(r-e)/t)}},g.prototype.parse_range_spec=function(e){var r=e.split(":").map(function(e){if(""==(e=e.trim()))return null;var r=parseInt(e);if(Number.isInteger(r))return r;throw new Error("Wrong input. Slice index unrecognized: ".concat(e))});if(0==r.length)throw new Error("Unexpected empty index. Expected colons.");if(3<r.length)throw new Error("Too many colons in index ".concat(e));var e=a(a([],r,!0),[null,null,null],!1),r=e[0],t=e[1],n=e[2];e.slice(3);return{start:r,stop:t,step:n}},g.prototype.parse=function(e,r){var t=1;if(":"==e||void 0===e)o={type:":",size:r};else if("number"==typeof e){var n=e;if((n=n<0?r+n:n)<0||r<=n)throw new Error("Index ".concat(n," out of bounds [0..").concat(r,")"));o={type:"number",index:n}}else if(e instanceof s.NDArray||Array.isArray(e)){var a,n=(0,s.asarray)(e);if(n.dtype==Number){if(1<n.shape.length)throw new Error("Expected 1D array of indices or nD array of booleans. "+"Found shape=".concat(n.shape," and dtype=").concat(n.dtype));a=n.flat}else a=[],n.flat.forEach(function(e,r){return e&&a.push(r)}),t=Math.max(1,n.shape.length);o={type:"array",indices:a}}else{if("string"!=typeof e)throw new Error("Unknown index type. Found ".concat(typeof e,": ").concat(e));var n=g.prototype.parse_range_spec(e),e=n.start,i=n.stop,n=n.step,e=g.prototype.parse_range(r,e,i,n),o=0==e.start&&e.nSteps==r&&1==e.step?{type:":",size:r}:{type:"range",range:e}}return{axisIndex:new g(o),span:t}},d.prototype.parse=function(e,r){for(var t=null==r?[]:r,n={axisIndexes:[],apparentShape:[],internalShape:[]},a=1,i={axisIndexes:NaN,apparentShape:NaN,internalShape:NaN},o=0,s=0,p=e.length;0<p;){var c=t[s];if(t[s]=void 0,s+=a,"None"==c||null===c)n.apparentShape.push(1);else if("..."==c){if(-1==a)throw new Error("Index can only have a single ellipsis ('...')");for(var l in a=-1,i)i[l]=n[l].length;s=t.length-1,o=e.length-1}else{for(var c=g.prototype.parse(c,e[o]),f=c.axisIndex,u=c.span,h=(p-=u,1),y=0;y<u;y++){if(o<0||o>=e.length)throw new Error("Index spans over more dimensions than available");h*=e[o],o+=a}n.axisIndexes.push(f),"number"!=f.spec.type&&n.apparentShape.push(f.size),n.internalShape.push(h)}}if(-1==a)for(var l in n)n[l].splice(0,i[l]).concat(n[l].reverse());return new d(n.apparentShape,n.internalShape,n.axisIndexes)},r.default={index:function(e,r){var t,n,a,i=Object.assign({copy:!1},e.__popKwArgs()).copy;if(e instanceof s.NDArray)return(r=d.prototype.parse(e.shape,r)).isConstant?(n=r.indices[0],e.flat[n]):r.isSimple?(n=function(e,r){if(null==e)return r;for(var t=[],n=0,a=0;a<e.axisIndexes.length;a++){var i=e.axisIndexes[a].spec,o=r.axisIndexes[n].spec;if("array"==i.type)throw new Error("Expected simple index. Found advanced: ".concat(i.type));if("array"==o.type)throw new Error("Expected simple index. Found advanced: ".concat(o.type));var s=void 0;if("number"==i.type)s=i;else if(n++,":"==i.type)s=o;else if(":"==o.type)s=i;else{var i=i.range,p=i.start,c=i.step,i=i.nSteps;if("number"==o.type){var l=o.index;if((l=l<0?i+l:l)<0||i<=l)throw new Error("Index ".concat(l," out of bounds [0..").concat(i,")"));s={type:"number",index:l=p+l*c}}else{var l=o.range,o=l.start,f=l.step,u=l.nSteps,i=g.prototype.parse_range(i,o,o+u*f,f),o=i.step*c,u=p+i.start*o,f=i.nSteps;s={type:"range",range:{start:u,step:o,nSteps:f}}}}t.push(new g(s))}if(n<r.axisIndexes.length)throw new Error("Index too long. Expected ".concat(n," axes. Found ").concat(r.axisIndexes.length));var h=r.shape,y=e.internalShape;return new d(h,y,t)}(e._simpleIndexes,r),(a=new s.NDArray(e._flat,r.shape,e.dtype))._simpleIndexes=n,e.__warnAssignments&&(a.__warnAssignments=!0),i?a.copy():a):(t=e.flat,n=r.indices.map(function(e){return t[e]}),a=new s.NDArray(n,r.shape,e.dtype),i||(a.__warnAssignments=!0),a);throw new Error("Expected NDArray. Found ".concat(typeof e,": ").concat(e))},AxesIndex:d,AxisIndex:g,__slices_to_indices:i}},530:function(e,r,t){var n=this&&this.__spreadArray||function(e,r,t){if(t||2===arguments.length)for(var n,a=0,i=r.length;a<i;a++)!n&&a in r||((n=n||Array.prototype.slice.call(r,0,a))[a]=r[a]);return e.concat(n||Array.prototype.slice.call(r))},a=(Object.defineProperty(r,"__esModule",{value:!0}),r.toJS=r.fromJS=void 0,t(461));r.fromJS=function(e){if(e instanceof a.NDArray)return e;if("number"==typeof e)return new a.NDArray([e],[],Number);if("boolean"==typeof e)return new a.NDArray([e?1:0],[],Boolean);if(e===a.NDArray.prototype)throw new Error("Programming error");if(!Array.isArray(e))throw new Error("Can't parse input of type ".concat(typeof e,": ").concat(e));for(var p=[],r=e;Array.isArray(r);)if(p.push(r.length),r=r[0],256<p.length)throw new Error("Circular reference or excessive array depth");function c(e,r){if(r==p.length-1)for(var t=0,n=e;t<n.length;t++){var a=n[t];if(Array.isArray(a))throw new Error("Inconsistent shape");l.push(a)}else{if(!Array.isArray(e))throw new Error("Inconsistent shape");for(var i=0,o=e;i<o.length;i++){var s=o[i];if(s.length!=p[r+1])throw new Error("Inconsistent shape: found sibling arrays of lengths ".concat(s.length," and ").concat(p[r+1]));c(s,r+1)}}}var t="boolean"==typeof r?Boolean:Number,l=[];return c(e,0),new a.NDArray(l,p,t)},r.toJS=function e(r){if(this instanceof a.NDArray)return e;if(null===r||"number"==typeof r||"boolean"==typeof r)return r;if(Array.isArray(r))return r.map(e);if(r instanceof a.NDArray)return(r=(0,a.number_collapse)(r))instanceof a.NDArray?function e(r,t){if(0===t.length)return r.shift();for(var n=t.slice(1),a=t[0],i=[],o=0;o<a;o++)i.push(e(r,n));return i}(n([],r.flat,!0),r.shape):r;throw new Error("Expected MyArray. Got ".concat(typeof r,": ").concat(r))}},847:function(e,r,t){var n=this&&this.__generator||function(n,a){var i,o,s,p={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(t){return function(e){var r=[t,e];if(i)throw new TypeError("Generator is already executing.");for(;p=c&&r[c=0]?0:p;)try{if(i=1,o&&(s=2&r[0]?o.return:r[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,r[1])).done)return s;switch(o=0,(r=s?[2&r[0],s.value]:r)[0]){case 0:case 1:s=r;break;case 4:return p.label++,{value:r[1],done:!1};case 5:p.label++,o=r[1],r=[0];continue;case 7:r=p.ops.pop(),p.trys.pop();continue;default:if(!(s=0<(s=p.trys).length&&s[s.length-1])&&(6===r[0]||2===r[0])){p=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3]))p.label=r[1];else if(6===r[0]&&p.label<s[1])p.label=s[1],s=r;else{if(!(s&&p.label<s[2])){s[2]&&p.ops.pop(),p.trys.pop();continue}p.label=s[2],p.ops.push(r)}}r=a.call(n,p)}catch(e){r=[6,e],o=0}finally{i=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}}},a=(Object.defineProperty(r,"__esModule",{value:!0}),t(216)),i=(a.GLOBALS.np,Object.defineProperty(o.prototype,"size",{get:function(){return null==this._simpleIndexes?this._flat.length:this._simpleIndexes.size},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"flat",{get:function(){var r=this;return null==this._simpleIndexes?this._flat:this._simpleIndexes.indices.map(function(e){return r._flat[e]})},set:function(e){if(e.length!=this.size)throw new Error("Length mismatch. Can't write ".concat(e.length," values into ").concat(this.size," available positions."));var r=this.size;if(null==this._simpleIndexes)for(var t=0;t<r;t++)this._flat[t]=e[t];else for(var n=this._simpleIndexes.indices,t=0;t<r;t++)this._flat[n[t]]=e[t]},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"T",{get:function(){throw new Error("NOT IMPLEMENTED")},enumerable:!1,configurable:!0}),o.prototype.__popKwArgs=function(){var e=this.__kwArgs;return void 0===e?{}:(delete this.__kwArgs,e)},o.prototype.withKwArgs=function(e){return this.__kwArgs=e,this},o.prototype[Symbol.iterator]=function(){return n(this,function(e){throw new Error("NOT IMPLEMENTED")})},Object.defineProperty(o.prototype,"length",{get:function(){return this.shape[0]||0},enumerable:!1,configurable:!0}),o);function o(e,r,t){void 0===t&&(t=Number),this.shape=r,this._flat=e,this.dtype=t,this._simpleIndexes=null}a.GLOBALS.NDArray=i;var a=t(461),s=t(17),t=t(811);i.prototype.modules={casting:a,basic:s,indexes:t},r.default=i},216:(e,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.GLOBALS=void 0;r.GLOBALS={NDArray:null,np:null}},341:function(e,r,t){var i=this&&this.__spreadArray||function(e,r,t){if(t||2===arguments.length)for(var n,a=0,i=r.length;a<i;a++)!n&&a in r||((n=n||Array.prototype.slice.call(r,0,a))[a]=r[a]);return e.concat(n||Array.prototype.slice.call(r))},o=(Object.defineProperty(r,"__esModule",{value:!0}),function(e){for(var r,t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var a="Usage example: np`np.arange(10)+${5}` or np([0,1,2]).";if("number"==typeof e)return e;if(e instanceof o.NDArray)return e;if(!Array.isArray(e))throw new Error("Expected template or array. ".concat(a));if(!e.length)throw new Error("Expected argument. ".concat(a));if("string"==typeof e[0]){if(t.length+1!=e.length)throw new Error("Wrong input. ".concat(a));return(r=o.modules.grammar).parse.apply(r,i([e],t,!1))}if(t.length)throw new Error("Wrong input. ".concat(a));return o.asarray(e)}),n=(t(216).GLOBALS.np=o,t(847)),a=(o.NDArray=n.default,o.transpose=function(){},t(530));o.fromJS=a.fromJS,o.JS=function(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];return a.toJS(o.apply(void 0,i([e],r,!1)))},r.default=o}},a={};var e,r=function e(r){var t=a[r];return void 0===t&&(t=a[r]={exports:{}},n[r].call(t.exports,t,t.exports,e)),t.exports}(341),t=exports;for(e in r)t[e]=r[e];r.__esModule&&Object.defineProperty(t,"__esModule",{value:!0})})();
//# sourceMappingURL=caph1993-numpy-js.js.map