(()=>{var n={89:(e,t,r)=>{const s=r(696).GLOBALS["np"];function a(e,t=null){let r,n;return n=null===t?(r=0,e):(r=e,t),s.NDArray.prototype._new(n-r,(e,t)=>r+t,Number)}function i(e,t,r=50,n=!0){({stop:t,num:r,endpoint:n}=Object.assign({stop:t,num:r,endpoint:n},this));var i=s.NDArray.prototype["__as_number"],i=(e=i(e),t=i(t),r-(n?1:0));return s.add(s.multiply(a(r),(t-e)/i),e)}e.exports={empty:function(e,t=Number){return s.NDArray.prototype._new(e,e=>{},t)},zeros:function(e,t=Number){const r=t!=Boolean&&0;return s.NDArray.prototype._new(e,e=>r,t)},ones:function(e,t=Number){const r=t==Boolean||1;return s.NDArray.prototype._new(e,e=>r,t)},arange:a,linspace:i,geomspace:function(e,t,r=50,n=!0){return{stop:t,num:r,endpoint:n}=Object.assign({stop:t,num:r,endpoint:n},this),e=s.log(e),t=s.log(t),s.exp(i(e,t,r,n))}}},499:(e,t,r)=>{const s=r(696).GLOBALS["NDArray"];function a(e){return e instanceof s?e:s.prototype.fromJS(e)}e.exports={asarray:a,array:function(e){var t;return e instanceof s?(t=null==e._simpleIndexes?[...e.flat]:e.flat,new s(t,e.shape,e.dtype)):s.prototype.fromJS(e)},reshape:function(e,t,...r){e=a(e);var{__parse_shape:n,__as_number:i}=s.prototype,r=(t=r.length?[t,...r].map(i):n(t),e.size);if(-1!==(i=t.indexOf(-1))){n=t.filter(e=>-1!==e).reduce((e,t)=>e*t,1);if(r%n!=0)throw new Error("Invalid shape. The total number of elements must match the product of the known dimensions.");t[i]=r/n}return new s(e.flat,t,e.dtype)},ravel:function(e){return e=a(e),new s(e.flat,[e.size],e.dtype)},copy:function(e){return e=a(e),new s([...e.flat],e.shape,e.dtype)}}},90:(e,t,r)=>{const n=r(696).GLOBALS["NDArray"];function i(e,t,r){return e=n.prototype.modules.basic.asarray(e),new n(e.flat.map(t),e.shape,r)}e.exports={elementwise:i,bitwise_not:function(e){return i(e,e=>~e,Number)},logical_not:function(e){return i(e,e=>!e,Boolean)},round:function(e,t=0){return 0==t&&i(e,Math.round,Number),i(e,e=>parseFloat(e.toFixed(t)),Number)},__make_elementwise:function(t,r=Number){return function(e){return i(e,t,r)}}}},230:(e,t,r)=>{const p=r(696).GLOBALS["NDArray"];class h{constructor(e,t,r){this.shape=e,this.internalShape=t,this.axisIndexes=r,this._indices=null,this._size=null,this.isSimple=this.axisIndexes.map(e=>e.isSimple).reduce((e,t)=>e&&t,!0),this.isConstant=this.axisIndexes.map(e=>e.isConstant).reduce((e,t)=>e&&t,!0)}get indices(){var e;return this._indices||(e=n(this.internalShape,this.__slices),this._indices=e)}get __slices(){return this.axisIndexes.map(e=>e.indices)}get size(){return this._size||(this._size=this.axisIndexes.map(e=>e.size).reduce((e,t)=>e*t,0))}}function n(e,t){var r,n=p.prototype["__shape_shifts"];for(r of t)if(0==r.length)return[];const s=n(e);var i=t.map((t,r)=>{var n=[],i=t.length;for(let e=0;e<i-1;e++)n.push(s[r]*(t[e+1]-t[e]));return n[i-1]=s[r]*(t[0]-t[i-1]),n}),a=[],o=e.length-1;const l=new Array(e.length).fill(0);let u=t.map((e,t)=>e[l[t]]*s[t]).reduce((e,t)=>e+t,0);for(;;){if(!isFinite(u))throw new Error("Programming error");a.push(u);let e=o;for(;0<=e&&(u+=i[e][l[e]++],!(l[e]<i[e].length));)l[e--]=0;if(e<0)break}return a}e.exports.__parse_sliceRange=function(t,{start:r,stop:n,step:i}){if(null==r?r=0:r<0&&(r=t+r),null==n?n=t:n<0&&(n=t+n),null==i)i=1;else if(0==i)throw new Error("Slice range with step size of zero");if(!isFinite(r)||!isFinite(n)||!isFinite(i))throw new Error(`Invalid slice ${[r,n,i]}. Axis size `+t);var s=[];if(0<i){r=Math.max(r,0),n=Math.min(n,t);for(let e=r;e<n;e+=i)s.push(e)}else{n=Math.max(n,0);for(let e=r=Math.min(r,t);e>n;e+=i)s.push(e)}return s};class m{constructor(e){this.spec=e,this._indices=null,this.isSimple="array"!=this.spec.type,this.isConstant="number"==this.spec.type}get indices(){if(this._indices)return this._indices;let e;if(":"==this.spec.type)e=Array.from({length:this.spec.size},(e,t)=>t);else if("number"===this.spec.type)e=[this.spec.index];else if("array"===this.spec.type)e=this.spec.indices;else{if("range"!=this.spec.type)throw new Error("Unknown spec type "+this.spec.type);{const{nSteps:t,step:r,start:n}=this.spec.range;e=Array.from({length:t},(e,t)=>n+t*r)}}return this._indices=e}get size(){if(":"==this.spec.type)return this.spec.size;if("number"===this.spec.type)return 1;if("array"===this.spec.type)return this.spec.indices.length;if("range"==this.spec.type)return this.spec.range.nSteps;throw new Error("Unknown spec type "+this.spec.type)}}m.prototype.parse_range=function(i,e=null,t=null,r=null){if(null==r)r=1;else if(0==r)throw new Error("Index specification error. Step must be different from zero.");var n=(e,t,r,n)=>null==e?t:(e<0&&(e=Math.max(0,i-e)),Math.min(n,Math.max(r,e)));return t=0<r?(e=n(e,0,0,i-1),n(t,i,0,i)):(e=n(e,i-1,0,i-1),n(t,i-1,-1,i-1)),t=Math.max(t,e),{start:e,step:r,nSteps:Math.floor(Math.abs(t-e)/r)}},m.prototype.parse_range_spec=function(e){var t=e.split(":").map(e=>{if(""==(e=e.trim()))return null;var t=parseInt(e);if(Number.isInteger(t))return t;throw new Error("Wrong input. Slice index unrecognized: "+e)});if(0==t.length)throw new Error("Unexpected empty index. Expected colons.");if(3<t.length)throw new Error("Too many colons in index "+e);var[e,t,r]=[...t,null,null,null];return{start:e,stop:t,step:r}},m.prototype.parse=function(t,r){let n,e=1;if(":"==t||void 0===t)n={type:":",size:r};else if("number"==typeof t){let e=t;if((e=e<0?r+e:e)<0||e>=r)throw new Error(`Index ${e} out of bounds [0..${r})`);n={type:"number",index:e}}else if(t instanceof p||Array.isArray(t)){var i=p.prototype.modules.basic.asarray(t);let r;if(i.dtype==Number){if(1<i.shape.length)throw new Error("Expected 1D array of indices or nD array of booleans. "+`Found shape=${i.shape} and dtype=`+i.dtype);r=i.flat}else r=[],i.flat.forEach((e,t)=>e&&r.push(t)),e=Math.max(1,i.shape.length);n={type:"array",indices:r}}else{if("string"!=typeof t)throw new Error(`Unknown index type. Found ${typeof t}: `+t);var{start:i,stop:t,step:s}=m.prototype.parse_range_spec(t),i=m.prototype.parse_range(r,i,t,s);n=0==i.start&&i.nSteps==r&&1==i.step?{type:":",size:r}:{type:"range",range:i}}return{axisIndex:new m(n),span:e}},h.prototype.parse=function(r,e){var n={axisIndexes:[],apparentShape:[],internalShape:[]};let i=1;var t={axisIndexes:NaN,apparentShape:NaN,internalShape:NaN};let s=0,a=0,o=r.length;for(;0<o;){var l=e[a];if(e[a]=void 0,a+=i,"None"==l||null===l)n.apparentShape.push(1);else if("..."==l){if(-1==i)throw new Error("Index can only have a single ellipsis ('...')");for(var u in i=-1,t)t[u]=n[u].length;a=e.length-1,s=r.length-1}else{var{axisIndex:l,span:p}=m.prototype.parse(l,r[s]);o-=p;let t=1;for(let e=0;e<p;e++){if(s<0||s>=r.length)throw new Error("Index spans over more dimensions than available");t*=r[s],s+=i}n.axisIndexes.push(l),"number"!=l.spec.type&&n.apparentShape.push(l.size),n.internalShape.push(t)}}if(-1==i)for(var c in n)n[c].splice(0,t[c]).concat(n[c].reverse());return new h(n.apparentShape,n.internalShape,n.axisIndexes)},e.exports={index:function(e,...t){var r=Object.assign({copy:!1},e.__popKwArgs())["copy"];if(!(e instanceof p))throw new Error(`Expected NDArray. Found ${typeof e}: `+e);if((t=h.prototype.parse(e.shape,t)).isConstant)return[n]=t.indices,e.flat[n];if(t.isSimple)return n=function(r,n){if(null==r)return n;var i=[];let s=0;for(let e=0;e<r.axisIndexes.length;e++){var a=r.axisIndexes[e]["spec"],o=n.axisIndexes[s]["spec"];if("array"==a.type)throw new Error("Expected simple index. Found advanced: "+a.type);if("array"==o.type)throw new Error("Expected simple index. Found advanced: "+o.type);let t;if("number"==a.type)t=a;else if(s++,":"==a.type)t=o;else if(":"==o.type)t=a;else{var{start:a,step:l,nSteps:u}=a.range;if("number"==o.type){let e=o["index"];if((e=e<0?u+e:e)<0||e>=u)throw new Error(`Index ${e} out of bounds [0..${u})`);e=a+e*l,t={type:"number",index:e}}else{var{start:o,step:p,nSteps:c}=o.range,u=m.prototype.parse_range(u,o,o+c*p,p),o=u.step*l,c=a+u.start*o,p=u.nSteps;t={type:"range",range:{start:c,step:o,nSteps:p}}}}i.push(new m(t))}if(s<n.axisIndexes.length)throw new Error(`Index too long. Expected ${s} axes. Found `+n.axisIndexes.length);var e=n.shape,t=r.internalShape;return new h(e,t,i)}(e._simpleIndexes,t),(i=new p(e._flat,t.shape,e.dtype))._simpleIndexes=n,e.__warnAssignments&&(i.__warnAssignments=!0),r?i.copy():i;{const s=e.flat;var n=t.indices.map(e=>s[e]),i=new p(n,t.shape,e.dtype);return r||(i.__warnAssignments=!0),i}},AxesIndex:h,AxisIndex:m,__slices_to_indices:n}},897:(e,t,r)=>{const n=r(696).GLOBALS["NDArray"];e.exports={fromJS:function(e){if(e instanceof n)return e;if("number"==typeof e)return new n([e],[],Number);if("boolean"==typeof e)return new n([e?1:0],[],Boolean);if(e===n.prototype)throw new Error("Programming error");if(!Array.isArray(e))throw new Error(`Can't parse input of type ${typeof e}: `+e);const i=[];let t=e;for(;Array.isArray(t);)if(i.push(t.length),t=t[0],256<i.length)throw new Error("Circular reference or excessive array depth");var r="boolean"==typeof t?Boolean:Number;const s=[],a=(e,t)=>{if(t==i.length-1)for(var r of e){if(Array.isArray(r))throw new Error("Inconsistent shape");s.push(r)}else{if(!Array.isArray(e))throw new Error("Inconsistent shape");for(var n of e){if(n.length!=i[t+1])throw new Error(`Inconsistent shape: found sibling arrays of lengths ${n.length} and `+i[t+1]);a(n,t+1)}}};return a(e,0),new n(s,i,r)},toJS:function e(t){if(this instanceof n)return e;if(null===t||"number"==typeof t||"boolean"==typeof t)return t;if(Array.isArray(t))return t.map(e);if(t instanceof n)return(t=n.prototype.__number_collapse(t))instanceof n?function t(r,e){if(0===e.length)return r.shift();var n=e.slice(1),i=e[0],s=[];for(let e=0;e<i;e++)s.push(t(r,n));return s}([...t.flat],t.shape):t;throw new Error(`Expected MyArray. Got ${typeof t}: `+t)}}},334:(e,t,r)=>{const f=r(696).GLOBALS["NDArray"],h=r(230);r=r(90);const g=f.prototype.modules.basic.asarray,m=f.prototype.modules.basic.ravel;function l(e,t,i,r,n=null){if(this instanceof f)return i.bind(f.prototype)(this,...arguments);var{__shape_shifts:s,__number_collapse:a}=f.prototype,[o,l,u]=(e=g(e),t=g(t),function(t,r){var n=[],i=Math.max(t.length,r.length);t=[...Array.from({length:i-t.length},()=>1),...t],r=[...Array.from({length:i-r.length},()=>1),...r];for(let e=i-1;0<=e;e--){var s=t[e],a=r[e];if(1!==s&&1!==a&&s!==a)throw new Error(`Can not broadcast axis ${e} with sizes ${s} and `+a);n.unshift(Math.max(s,a))}return[n,t,r]}(e.shape,t.shape));if(null==n)n=f.prototype._new(o,e=>{},r);else if(!(n instanceof f))throw new Error(`Out must be of type ${f}. Got `+typeof n);var p=[],c=s(l),h=s(u),m=e.flat,d=t.flat;for(let e=0;e<n.size;e++){let t=0,r=0,n=e;for(let e=o.length-1;0<=e;e--)t+=c[e]*(n%l[e]),r+=h[e]*(n%u[e]),n=Math.floor(n/o[e]);p.push(i(m[t],d[r]))}return n.flat=p,a(n)}function n(n,i){function s(e,t,r=null){return this instanceof f?s.bind(f.prototype)(this,...arguments):l(e,t,i,n,r)}return s}function i(s,a){function o(e,t,r=null){if(this instanceof f)return o.bind(f.prototype)(this,...arguments);e=g(e),t=g(t);let n=e.dtype,i;return e.dtype!=t.dtype&&console.warn("Warning: operating arrays of different dtypes. Using "+n),l(e,t,i=n==Boolean?a:s,n,r)}return o}var s={"+":n(Number,(e,t)=>e+t),"-":n(Number,(e,t)=>e-t),"*":n(Number,(e,t)=>e*t),"/":n(Number,(e,t)=>e/t),"%":n(Number,(e,t)=>e%t),"//":n(Number,(e,t)=>Math.floor(e/t)),"**":n(Number,(e,t)=>Math.pow(e,t)),"<":n(Boolean,(e,t)=>e<t),">":n(Boolean,(e,t)=>t<e),">=":n(Boolean,(e,t)=>t<=e),"<=":n(Boolean,(e,t)=>e<=t),"==":n(Boolean,(e,t)=>e==t),"!=":n(Boolean,(e,t)=>e!=t),"|":i((e,t)=>e|t,(e,t)=>e||t),"&":i((e,t)=>e&t,(e,t)=>e&&t),"^":n(Number,(e,t)=>e^t),"<<":n(Number,(e,t)=>e<<t),">>":n(Number,(e,t)=>e>>t),or:n(Boolean,(e,t)=>e||t),and:n(Boolean,(e,t)=>e&&t),xor:n((e,t)=>!e!=!t),max:n(Number,(e,t)=>Math.max(e,t)),min:n(Number,(e,t)=>Math.min(e,t))},r=(s["↑"]=s.max,s["↓"]=s.min,s["≤"]=s.leq,s["≥"]=s.geq,s["≠"]=s.neq,s["↑="]=s["max="],s["↓="]=s["min="],{"~":r.bitwise_not,not:r.logical_not});function d(t,r,n,i,s){if(this instanceof f)return d(this,...arguments);t.__warnAssignment&&(console.warn(`Warning: You are assigning on a copy that resulted from an advanced index on a source array.
If this is intentional, use yourArray = source.withKwArgs({copy:true}).index(...yourIndex) to make explicit your awareness of the copy operation.
Instead, if you want to assign to the source array, use source.op('=', other, ...yourIndex).
`),delete t.__warnAssignment);var a=f.prototype["_binary_operation"];if(t instanceof f)if(n){r=g(r);var o,l=h.AxesIndex.prototype.parse(t.shape,n)["indices"];let e;a(e=null==i?(i=(e,t)=>t,f.prototype._new(l.length,()=>{},t.dtype)):g(l.map(e=>t._flat[e])),m(r),i,s,e);for(o of l)t._flat[o]=e._flat[o]}else a(t,r,i,s,t);else{var e=t,l=r,a=n,u=i,p=s;if(!Array.isArray(e))throw new Error(`Can not assign to a non-array. Found ${typeof e}: `+e);console.warn("Assignment to JS array is experimental and slow.");for(var c=g(e),l=(d(c,l,a,u,p),f.prototype.modules.jsInterface.toJS(c));e.length;)e.pop();e.push(...l)}}function a(n,i){function s(e,t,r){return this instanceof f?s.bind(f.prototype)(this,...arguments):d(e,t,r,i,n)}return s}var o={"=":a(Number,(e,t)=>t),"+=":a(Number,(e,t)=>e+t),"-=":a(Number,(e,t)=>e-t),"*=":a(Number,(e,t)=>e*t),"/=":a(Number,(e,t)=>e/t),"%=":a(Number,(e,t)=>e%t),"//=":a(Number,(e,t)=>Math.floor(e/t)),"**=":a(Number,(e,t)=>Math.pow(e,t)),"|=":a(Number,(e,t)=>e|t),"&=":a(Number,(e,t)=>e&t),"^=":a(Number,(e,t)=>e^t),"<<=":a(Number,(e,t)=>e<<t),">>=":a(Number,(e,t)=>e>>t),"max=":a(Number,(e,t)=>Math.max(e,t)),"min=":a(Number,(e,t)=>Math.min(e,t)),"or=":a(Boolean,(e,t)=>e||t),"and=":a(Boolean,(e,t)=>e&&t)};e.exports={op_binary:s,op_assign:o,op_unary:r,binary_operation:l,assign_operation:d,isclose:function(e,t,r=1e-5,n=1e-8,i=!1){return{rtol:r,atol:n,equal_nan:i}=Object.assign({rtol:r,atol:n,equal_nan:i},this),l(e,t,(e,t)=>Number.isFinite(e)&&Number.isFinite(t)?Math.abs(e-t)<=n+r*t:e==t||i&&Number.isNaN(e)&&Number.isNaN(t),Boolean)},allclose:function(e,t,r=1e-5,n=1e-8,i=!1){({rtol:r,atol:n,equal_nan:i}=Object.assign({rtol:r,atol:n,equal_nan:i},this));const s=(e,t)=>Number.isFinite(e)&&Number.isFinite(t)?Math.abs(e-t)<=n+r*t:e==t||i&&Number.isNaN(e)&&Number.isNaN(t),a=new Error("");try{l(e,t,(e,t)=>{if(s(e,t))return 0;throw a},Number)}catch(e){if(e===a)return!1;throw e}return!0}}},17:(e,t,r)=>{const p=r(696).GLOBALS["NDArray"];e.exports={humanReadable:function(o){if(0==o.shape.length)return o.flat[0].toString();let i=o.shape.map(e=>1),t=30;for(let e=0;e<o.shape.length;e++){var r=i[e];i[e]=Math.min(o.shape[e],t),i[e]>r&&(t=Math.floor(t/(i[e]-r)))}let n=30;for(let e=o.shape.length-1;0<=e;e--){var s=i[e];i[e]=Math.min(o.shape[e],n),i[e]>s&&(n=Math.floor(n/(i[e]-s)))}let l=o.shape.length-1;for(;0<l&&1==o.shape[l];)l--;o.dtype==Number&&(o=p.prototype.modules.elementwise.round(o,2));var e=p.prototype.modules.jsInterface.toJS(o),a=`, shape=(${o.shape}), dtype=`+o.dtype.name;let u=function t(r,n=0,i=0){if("..."==r||i>=o.shape.length)return r;if(i==o.shape.length-1)return`[${r.join(", ")}]`;var e=i>=l?" ":"\n"+" ".repeat(n+1),s=[];for(let e=0;e<r.length;e++){var a=t(r[e],n+1,i+1)+",";s.push(e<r.length-1?a:a.slice(0,-1))}return`[${s.join(e)}]`}(function t(e,r=0){var n;return r==o.shape.length?e:2*i[r]>=e.length?e.map(e=>t(e,r+1)):(n=e.slice(0,i[r]).map(e=>t(e,r+1)),e=e.slice(-i[r]).map(e=>t(e,r+1)),[...n,"...",...e])}(e),1+"np".length);return u=(u=function(e,n=","){var e=e.split("\n"),t=Array(e[0].split(n).length).fill(0);for(const a of e){var r=a.split(n);for(let e=0;e<r.length;e++)t[e]=Math.max(t[e],r[e].trim().length)}let i="";for(const o of e){let r=o.split(n);r=r.map((e,t)=>t==r.length-1?e:e+n);for(let e=0;e<r.length;e++){var s=r[e].trim();i+=s.padStart(t[e]+1).padEnd(t[e]+2)}i+="\n"}return i}("np("+(u=u.replace(/.*?(\n|$)/g,e=>e.replace(/(.{60,}?,)/g,"$1\n")).replace(/\n+/g,"\n"))).trim())+a+")"}}},534:(e,t,r)=>{const f=r(696).GLOBALS["NDArray"];function s(e,r,t,n,i=Number){var{__shape_shifts:s,__as_boolean:a,__number_collapse:o}=f.prototype;if(t=a(t),e=f.prototype.modules.basic.asarray(e),null==r)return n(e.flat);r<0&&(r=e.shape.length-1);let l=e.shape[r],u=s(e.shape)[r];const p=Array.from({length:l},e=>[]);e.flat.forEach((e,t)=>p[Math.floor(t/u)%l].push(e));var c=e.size/l,h=[];for(let t=0;t<c;t++){var m=[];for(let e=0;e<l;e++)m.push(p[e][t]);h.push(m)}a=h.map(n);let d=[...e.shape];return t?d[r]=1:d=d.filter((e,t)=>t!=r),o(new f(a,d,i))}function n(n,i){return function(e,t=null,r=!1){return{axis:t,keepdims:r}=Object.assign({axis:t,keepdims:r},this),s(e,t,r,i,n)}}const a={};a.sum=n(Number,e=>e.reduce((e,t)=>e+t,0)),a.product=n(Number,e=>e.reduce((e,t)=>e*t,1)),a.any=n(Boolean,e=>{for(var t of e)if(t)return!0;return!1}),a.all=n(Boolean,e=>{for(var t of e)if(!t)return!1;return!0}),a.max=n(Number,e=>Math.max(...e)),a.min=n(Number,e=>Math.min(...e)),a.argmax=n(Number,e=>e.indexOf(Math.max(...e))),a.argmin=n(Number,e=>e.indexOf(Math.min(...e))),a.mean=n(Number,e=>e.reduce((e,t)=>e+t,0)/e.length),a.var=function(e,t=null,r=!1){({axis:t,keepdims:r}=Object.assign({axis:t,keepdims:r},this));var n=a.mean.bind({axis:t,keepdims:!0})(e),i=f.prototype.modules.operators["op_binary"];return e=i["-"](e,n),e=i["*"](e,e),a.mean.bind({axis:t,keepdims:r})(e)},a.std=function(e,t=null,r=!1){({axis:t,keepdims:r}=Object.assign({axis:t,keepdims:r},this));t=a.var.bind({axis:t,keepdims:r})(e),r=f.prototype.modules.operators.op_binary;return r["**"](t,.5)},e.exports={reduce:s,reducers:a}},378:(e,t,r)=>{const m=r(696).GLOBALS["NDArray"],o=r(478)["allEq"];function d(e,t,r,n=Number){if(e=m.prototype.modules.basic.asarray(e),null==t)return r(e.flat);var i=e.shape.length;if((t=t<0?i+t:t)!==i-1){const c=f(e,t,-1),h=d(c,-1,r,n);return f(h,t,-1)}let s=e.shape[t],a=m.prototype.__shape_shifts(e.shape)[t];const o=Array.from({length:s},e=>[]);e.flat.forEach((e,t)=>o[Math.floor(t/a)%s].push(e));var l=e.size/s,u=[];for(let t=0;t<l;t++){var p=[];for(let e=0;e<s;e++)p.push(o[e][t]);u.push(p)}i=u.map(r);const c=m.prototype.fromJS(i);r=[...e.shape.slice(0,t),...c.shape.slice(1),...e.shape.slice(t+1)];const h=new m(c.flat,r,n);return m.prototype.__number_collapse(h)}function h(t,r=null){r=Object.assign({axes:r},this).axes;var n=t.shape.length;if(null==r)return h(t,Array.from({length:n},(e,t)=>t).reverse());if(r.length!==n)throw new Error(`Axes must have length ${n}. Found `+r.length);var i=Array.from({length:n},()=>-1);for(let e=0;e<n;e++)i[r[e]]=e;for(let e=0;e<n;e++)if(-1==i[e])throw new Error(`Axes must contain all dimensions. Missing ${e}.`);const s=m.prototype.__shape_shifts(t.shape);var a=r.map(e=>t.shape[e]),o=r.map(e=>s[e]),l=[],u=new Array(a.length).fill(0);let p=0;for(;;){if(!isFinite(p))throw new Error("Programming error");l.push(p);let e=n-1;for(;0<=e&&(u[e]++,p+=o[e],!(u[e]<a[e]));)p-=o[e]*a[e],u[e]=0,e--;if(e<0)break}const c=t.flat;return new m(l.map(e=>c[e]),a,t.dtype)}function f(e,t,r){var n=(e=m.prototype.modules.basic.asarray(e)).shape.length,n=(t<0&&(t=n+t),r<0&&(r=n+r),Array.from({length:n},(e,t)=>t));return n[t]=r,n[r]=t,h(e,n)}function a(e,r=null){if(r=Object.assign({axis:r},this)["axis"],e=(e=e instanceof m?[...e]:e).map(m.prototype.modules.basic.asarray),null==r&&(e=e.map(e=>m.prototype.modules.basic.reshape(e,-1)),r=0),!e.length)throw new Error("Expected at least two arrays");var t=e[0].shape.length;r<0&&(r=t+r);const n=[...e[0].shape];var i,s=[],a=n.map((e,t)=>0==t?0:n[t==r?0:t]);for(i of e){if(!o(i.shape.filter((e,t)=>t!=r),n.filter((e,t)=>t!=r)))throw new Error(`Inconsistent input shape ${n} with respect to `+i.shape.map((e,t)=>t==r?"?":e));a[0]+=i.shape[r],i=0==r?i:f(i,r,0),s.push(...i.flat)}t=new m(s,a);return 0==r?t:f(t,r,0)}e.exports={apply_along_axis:d,sort:function(e,t=-1){return t=Object.assign({axis:t},this)["axis"],d(e,t,e=>{e=[...e];return e.sort((e,t)=>e-t),e},e.dtype)},transpose:h,concatenate:a,stack:function(e,t=0){if(t=Object.assign({axis:t},this)["axis"],e instanceof m&&(e=[...e]),!Array.isArray(e))throw new Error("Expected list of arrays. Found "+typeof e);if(!(e=e.map(m.prototype.modules.basic.asarray)).length)throw new Error("Expected at least two arrays");var r,n=[...e[0].shape],i=[...n.slice(0,t=t<0?n.length+1+t:t),1,...n.slice(t)],s=(console.log({shapeBroadcast:i}),[]);for(r of e){if(!o(r.shape,n))throw new Error(`Inconsistent input shape ${r.shape} with respect to `+r.shape);s.push(r.reshape(i))}return a(s,t)}}},895:(e,t,r)=>{class i{constructor(e,t,r=Number){this.shape=t,this._flat=e,this.dtype=r,this._simpleIndexes=null}_simpleIndexes;get size(){return null==this._simpleIndexes?this._flat.length:this._simpleIndexes.size}get flat(){return null==this._simpleIndexes?this._flat:this._simpleIndexes.indices.map(e=>this._flat[e])}set flat(t){if(t.length!=this.size)throw new Error(`Length mismatch. Can't write ${t.length} values into ${this.size} available positions.`);var r=this.size;if(null==this._simpleIndexes)for(let e=0;e<r;e++)this._flat[e]=t[e];else{var n=this._simpleIndexes.indices;for(let e=0;e<r;e++)this._flat[n[e]]=t[e]}}get T(){return this.transpose()}__popKwArgs(){var e=this.__kwArgs;return void 0===e?{}:(delete this.__kwArgs,e)}withKwArgs(e){return this.__kwArgs=e,this}*[Symbol.iterator](){for(let e=0;e<this.shape[0];e++)yield this.index(e)}get length(){return this.shape[0]||0}}r(696).GLOBALS.NDArray=i;const n={},s=((i.prototype.modules=n).basic=r(499),n.indexes=r(230),n.elementwise=r(90),n.print=r(17),n.reduce=r(534),n.operators=r(334),n.transform=r(378),n.jsInterface=r(897),n.basic);function a(r){return function(e=null,t=!1){return{axis:e,keepdims:t}=Object.assign({axis:e,keepdims:t},this.__popKwArgs()),r(this,e,t)}}function o(r){return function(e,t=null){return t=Object.assign({out:t},this.__popKwArgs())["out"],r(this,e,t)}}function l(t){return function(e=null){return e=Object.assign({out:e},this.__popKwArgs())["out"],t(this,e)}}function u(t){return function(...e){return t(this,...e)}}i.prototype.reshape=function(e,...t){return s.reshape(this,e,...t)},i.prototype.ravel=function(){return s.ravel(this)},i.prototype.copy=function(){return s.copy(this)},i.prototype.__shape_shifts=function(t){var r=Array.from({length:t.length},e=>0);r[t.length-1]=1;for(let e=t.length-2;0<=e;e--)r[e]=r[e+1]*t[e+1];return r},i.prototype.__number_collapse=function(e,t=!1){if(!e.shape.length)return e.flat[0];if(t)throw new Error("Expected constant. Got array with shape "+e.shape);return e},i.prototype.__parse_shape=function(e){if(Array.isArray(e))return e;if(e instanceof i){if(1<e.shape.length)throw new Error("Expected flat list. Got array with shape "+e.shape);return e.flat}if("number"==typeof e)return[e];throw new Error("Expected list. Got "+e)},i.prototype.__as_boolean=function(e){if(e instanceof i)e=i.prototype.__number_collapse(e,!0);else if("string"==typeof e)throw new Error("'string' object can not be interpreted as boolean: "+e);return!!(0+e)},i.prototype.__as_number=function(e){if(e instanceof i)e=i.prototype.__number_collapse(e,!0);else if("string"==typeof e)throw new Error("'string' object can not be interpreted as boolean: "+e);return parseFloat(e)},i.prototype._new=function(e,t,r){var n=(e=i.prototype.__parse_shape(e)).reduce((e,t)=>e*t,1),n=Array.from({length:n},t);return new i(n,e,r)},i.prototype.index=function(...e){return n.indexes.index(this,...e)},i.prototype.toString=function(){return n.print.humanReadable(this)},i.prototype.sum=a(n.reduce.reducers.sum),i.prototype.product=a(n.reduce.reducers.product),i.prototype.any=a(n.reduce.reducers.any),i.prototype.all=a(n.reduce.reducers.all),i.prototype.max=a(n.reduce.reducers.max),i.prototype.min=a(n.reduce.reducers.min),i.prototype.argmax=a(n.reduce.reducers.argmax),i.prototype.argmin=a(n.reduce.reducers.argmin),i.prototype.mean=a(n.reduce.reducers.mean),i.prototype.var=a(n.reduce.reducers.var),i.prototype.std=a(n.reduce.reducers.std),i.prototype._binary_operation=n.operators.binary_operation,i.prototype.add=o(n.operators.op_binary["+"]),i.prototype.subtract=o(n.operators.op_binary["-"]),i.prototype.multiply=o(n.operators.op_binary["*"]),i.prototype.divide=o(n.operators.op_binary["/"]),i.prototype.mod=o(n.operators.op_binary["%"]),i.prototype.divide_int=o(n.operators.op_binary["//"]),i.prototype.pow=o(n.operators.op_binary["**"]),i.prototype.maximum=o(n.operators.op_binary["↑"]),i.prototype.minimum=o(n.operators.op_binary["↓"]),i.prototype.bitwise_or=o(n.operators.op_binary["|"]),i.prototype.bitwise_and=o(n.operators.op_binary["&"]),i.prototype.bitwise_xor=o(n.operators.op_binary["^"]),i.prototype.bitwise_shift_left=o(n.operators.op_binary["<<"]),i.prototype.bitwise_shift_right=o(n.operators.op_binary[">>"]),i.prototype.logical_or=o(n.operators.op_binary.or),i.prototype.logical_and=o(n.operators.op_binary.and),i.prototype.logical_xor=o(n.operators.op_binary.xor),i.prototype.greater=o(n.operators.op_binary[">"]),i.prototype.less=o(n.operators.op_binary["<"]),i.prototype.greater_equal=o(n.operators.op_binary[">="]),i.prototype.less_equal=o(n.operators.op_binary["<="]),i.prototype.equal=o(n.operators.op_binary["=="]),i.prototype.not_equal=o(n.operators.op_binary["!="]),i.prototype.bitwise_not=l(n.operators.op_unary["~"]),i.prototype.logical_not=l(n.operators.op_unary.not),i.prototype.isclose=n.operators.isclose,i.prototype.allclose=n.operators.allclose,i.prototype.assign=u(n.operators.op_assign["="]),i.prototype.add_assign=u(n.operators.op_assign["+="]),i.prototype.subtract_assign=u(n.operators.op_assign["-="]),i.prototype.multiply_assign=u(n.operators.op_assign["*="]),i.prototype.divide_assign=u(n.operators.op_assign["/="]),i.prototype.mod_assign=u(n.operators.op_assign["%="]),i.prototype.divide_int_assign=u(n.operators.op_assign["//="]),i.prototype.pow_assign=u(n.operators.op_assign["**="]),i.prototype.maximum_assign=u(n.operators.op_assign["↑="]),i.prototype.minimum_assign=u(n.operators.op_assign["↓="]),i.prototype.bitwise_or_assign=u(n.operators.op_assign["|="]),i.prototype.bitwise_and_assign=u(n.operators.op_assign["&="]),i.prototype.bitwise_shift_left_assign=u(n.operators.op_assign["<<="]),i.prototype.bitwise_shift_right_assign=u(n.operators.op_assign[">>="]),i.prototype.logical_or_assign=u(n.operators.op_assign["or="]),i.prototype.logical_and_assign=u(n.operators.op_assign["and="]),i.prototype.JS=function(){return n.jsInterface.toJS(this)},i.prototype.fromJS=function(e){return n.jsInterface.fromJS(e)},i.prototype.round=function(e=0){return e=Object.assign({decimals:e},this.__popKwArgs())["decimals"],n.elementwise.round(this,e)},i.prototype.transpose=function(e=null){return e=Object.assign({axes:e},this.__popKwArgs())["axes"],n.transform.transpose(this,e)},i.prototype.sort=function(e=-1){return e=Object.assign({axis:e},this.__popKwArgs())["axis"],n.transform.sort(this,e),null},e.exports=i},696:e=>{e.exports={GLOBALS:{NDArray:null,np:null}}},258:(e,t,r)=>{const{NDArray:o,np:a}=r(696).GLOBALS;r=r(636);const l={};l.grammar=String.raw`
ArrayGrammar {
  Instruction
  = Variable "[" Slice "]" AssignSymbol ArithmeticLogicExp -- sliceAssignment
  | ArithmeticLogicExp                       -- expression
  
  Variable
   = "#" digit+ "#"
  
  AssignSymbol
  ="="|"+="|"-="|"/="|"%="|"&="|"|="|"^="|"@="
  
  /* Declaration in precedence order (weakest first) */
  ArithmeticLogicExp = Precedence11

  /* https://docs.python.org/3/reference/expressions.html */
  Operator11 = "<" | "<=" | ">" | ">=" | "!=" | "=="
  Operator10 = "|"
  Operator09 = "^"
  Operator08 = "&"
  Operator07 = "<<" | ">>"
  Operator06 = "+" | "-"
  Operator05 = "*" | "@" | "/" | "//" | "%"
  Operator04 = "~" /* Unary */
  Operator03 = "+" | "-" /* Unary. Special treatment to prevent "-1.3" to be "-(array of 1.3)" */
  Operator02 = "**"
  /* Operator01 = "x[index]" | "x[index:index]" | "x(arguments...)" | "x.attribute" */
  /* Operator00 = "(expressions...)" */

  Precedence11 = Precedence11 Operator11 Precedence10 | "" "" Precedence10
  Precedence10 = Precedence10 Operator10 Precedence09 | "" "" Precedence09
  Precedence09 = Precedence09 Operator09 Precedence08 | "" "" Precedence08
  Precedence08 = Precedence08 Operator08 Precedence07 | "" "" Precedence07
  Precedence07 = Precedence07 Operator07 Precedence06 | "" "" Precedence06
  Precedence06 = Precedence06 Operator06 Precedence05 | "" "" Precedence05
  Precedence05 = Precedence05 Operator05 Precedence04 | "" "" Precedence04
  Precedence04 = ""           Operator04 Precedence03 | "" "" Precedence03 /* Unary */
  Precedence03 = ""           Operator03 Precedence02 | "" "" Precedence02 /* Special */
  Precedence02 = Precedence02 Operator02 Precedence03 | "" "" Precedence01
  Precedence01 = Arr
  
  Parenthesis = "(" ArithmeticLogicExp ")"
  Arr
    = Arr "." Name CallArgs     -- method
    | Arr "." Name              -- attribute
    | Arr "[" Slice "]"         -- slice
    | Parenthesis
    | Name ("." Name)* CallArgs -- call
    | number
    | Variable

  Name  (an identifier)
    = (letter|"_") (letter|"_"|digit)*

  number  (a number)
    = ("+"|"-")? digit* "." digit+ "E" ("+"|"-")? "digit+"
    | ("+"|"-")? digit* "." digit+ "e" ("+"|"-")? "digit+"
    | ("+"|"-")? digit* "." digit+  ""  ""        ""
    | ("+"|"-")? digit+ ""  ""      ""  ""        ""
  
  int (an integer) = ""  digit+ | "-" digit+ | "+" digit+

  CallArgs // Using empty strings instead of separate rules
   = "(" Args ","  KwArgs ","? ")"
   | "(" Args ","? ""      ""  ")"
   | "(" ""   ","? KwArgs ","? ")"
   | "(" ""    ""  ""      ""  ")"
   
  Args = NonemptyListOf<ArgValue, ",">
  KwArgs = NonemptyListOf<KwArg, ",">
  KwArg = Name "=" ArgValue

  ArgValue = Constant | JsArray | ArithmeticLogicExp | String
  Constant = "True" | "False" | "None" | "np.nan" | "np.inf"
  JsArray
    = "[" ListOf<ArgValue, ","> ","? "]"
    | "(" ListOf<ArgValue, ","> ","? ")"

  String = "\'" any* "\'" | "\"" any* "\""
   
  Slice = NonemptyListOf<SliceTerm, ",">
  SliceTerm
    = SliceRange
    | (":" | "..." | "None") -- constant
    | JsArray
    | ArithmeticLogicExp
  
  SliceRange
    = int ":" int ":" int
    | int ":" int ""  ""
    | int ":" ""  ":" int
    | int ":" ""  ""  ""
    | ""  ":" int ":" int
    | ""  ":" int ""  ""
    | ""  ":" ""  ":" int
    | ""  ":" ""  ""  ""
}
`,l.ohmGrammar=r.grammar(l.grammar),l.__makeSemantics=()=>{const i=[];var e={Instruction_sliceAssignment(e,t,r,n,i,s){var a=e.parse(),e=s.parse(),s=i.sourceString,i=r.parse(),r=o.prototype.modules.basic.asarray(a);if(o.prototype.modules.operators.op_assign[s](a,e,i),r!==a){for(o.prototype.modules.jsInterface.toJS(r);a.length;)a.pop();a.push(...a)}return null},Instruction_expression(e){let t=e.parse();return"number"==typeof t||"boolean"==typeof t||Array.isArray(t)||t instanceof o&&(t=o.prototype.__number_collapse(t)),t},Precedence11:t,Precedence10:t,Precedence09:t,Precedence08:t,Precedence07:t,Precedence06:t,Precedence05:t,Precedence04:r,Precedence03:r,Precedence02:t,number:function(e,t,r,n,i,s,a){return parseFloat(this.sourceString)},Arr_slice(e,t,r,n){e=e.parse(),r=r.parse();return e.index(...r)},SliceTerm_constant(e){return e.sourceString},Arr_call(e,t,r,n){let i=e.sourceString+t.sourceString;e=(i="np."==i.slice(0,3)?i.slice(3):i).split(".").reduce((e,t)=>e[t],a);if(void 0===e)throw new Error("Unrecognized function "+i);var{args:t,kwArgs:n}=n.parse();return e.bind(n)(...t)},Arr_method(e,t,r,n){var e=e.parse(),r=r.sourceString,{args:n,kwArgs:i}=n.parse();if(void 0===e[r])throw new Error("Unrecognized method "+r);return e.withKwArgs(i)[r](...n)},Parenthesis(e,t,r){return t.parse()},Arr_attribute(e,t,r){return e.parse()[r.sourceString]},Variable(e,t,r){t=parseInt(t.sourceString);let n=i[t];t=Array.isArray(n)&&n.length&&n[0]instanceof o;return n=Array.isArray(n)&&!t?a.array(n):n},int(e,t){t=parseInt(t.sourceString);return"-"==e.sourceString?-t:t},SliceRange(e,t,r,n,i){return this.sourceString},Constant(e){switch(e.sourceString){case"True":return!0;case"False":return!1;case"None":return null;case"np.nan":return Number.NaN;case"np.inf":return Number.POSITIVE_INFINITY}throw new Error("Unrecognized constant "+e.sourceString)},String(e,t,r){return t.sourceString},CallArgs(e,t,r,n,i,s){t=t.parse()||[],n=n.parse()||[];return{args:t,kwArgs:Object.fromEntries(n)}},KwArg(e,t,r){return[e.sourceString,r.parse()]},NonemptyListOf(e,t,r){return[e,...r.children].map(e=>e.parse())},JsArray(e,t,r,n){var i,s=t.parse(),a=o.prototype.modules.jsInterface["toJS"];for(i in s)s[i]instanceof o&&(s[i]=a(s[i]));return s},_terminal(){return null}};function t(e,t,r){var n,e=e.parse(),r=r.parse(),t=t.sourceString;return""==t&&null===e?r:(n=o.prototype.modules.operators["op_binary"],n[t](e,r))}function r(e,t,r){var n=r.parse(),r=t.sourceString;if(""==r)return n;var{op_binary:i,unary_op:s}=o.prototype.modules.operators;switch(r){case"+":return n;case"-":return i["*"](-1,n);case"~":return s["~"](n);case"!":return s.not(n)}throw new Error("Programming Error: "+r)}const n=l["ohmGrammar"],s=n.createSemantics();return s.addOperation("parse",e),{parse:function(e,...t){let r=0;if(e=e.join("###").replace(/###/g,()=>`#${r++}#`),i.length=0,i.push(...t),(t=n.match(e)).succeeded())return s(t).parse();throw new Error(t.message)},ohmSemantics:s,semantics:e,semanticVariables:i,busy:0}},l.__parser_pool=[l.__makeSemantics()],l.parse=function(t,...r){var n=l["__parser_pool"];for(let e=0;e<n.length;e++){var i=n[e];if(0==i.busy++)try{return i.parse(t,...r)}finally{i.busy=0}e==n.length&&n.push(l.__makeSemantics())}},e.exports=l},138:(e,t,r)=>{function n(e,...t){var r="Usage example: np`np.arange(10)+${5}` or np([0,1,2]).";if("number"==typeof e)return e;if(e instanceof n.NDArray)return e;if(!Array.isArray(e))throw new Error("Expected template or array. "+r);if(!e.length)throw new Error("Expected argument. "+r);if("string"==typeof e[0]){if(t.length+1!=e.length)throw new Error("Wrong input. "+r);return n.modules.grammar.parse(e,...t)}if(t.length)throw new Error("Wrong input. "+r);return n.asarray(e)}r(696).GLOBALS.np=n;var i=r(895);n.NDArray=i,n.modules={NDArray:i,grammar:r(258),constructors:r(89),jsUtils:r(478),random:r(593)},n.random=n.modules.random;const s=i.prototype.modules.jsInterface;n.fromJS=s.fromJS,n.JS=function(e,...t){return s.toJS(n(e,...t))},n.ravel=i.prototype.modules.basic.ravel,n.reshape=i.prototype.modules.basic.reshape,n.array=i.prototype.modules.basic.array,n.asarray=i.prototype.modules.basic.asarray;r=i.prototype.modules.reduce,n.sum=r.reducers.sum,n.product=r.reducers.product,n.prod=n.product,n.any=r.reducers.any,n.all=r.reducers.all,n.max=r.reducers.max,n.min=r.reducers.min,n.argmax=r.reducers.argmax,n.argmin=r.reducers.argmin,n.mean=r.reducers.mean,n.var=r.reducers.var,n.std=r.reducers.std,r=i.prototype.modules.transform,n.transpose=r.transpose,n.apply_along_axis=r.apply_along_axis,n.sort=r.sort,n.concatenate=r.concatenate,n.stack=r.stack,r=i.prototype.modules.operators,n.add=r.op_binary["+"],n.subtract=r.op_binary["-"],n.multiply=r.op_binary["*"],n.divide=r.op_binary["/"],n.mod=r.op_binary["%"],n.divide_int=r.op_binary["//"],n.pow=r.op_binary["**"],n.bitwise_or=r.op_binary["|"],n.bitwise_and=r.op_binary["&"],n.bitwise_xor=r.op_binary["^"],n.bitwise_shift_left=r.op_binary["<<"],n.bitwise_shift_right=r.op_binary[">>"],n.greater=r.op_binary[">"],n.less=r.op_binary["<"],n.greater_equal=r.op_binary[">="],n.less_equal=r.op_binary["<="],n.equal=r.op_binary["=="],n.not_equal=r.op_binary["!="],n.maximum=r.op_binary["↑"],n.minimum=r.op_binary["↓"],n.logical_or=r.op_binary.or,n.logical_and=r.op_binary.and,n.bitwise_not=r.op_unary["~"],n.logical_not=r.op_unary.not,r=i.prototype.modules.elementwise,n.sign=r.__make_elementwise(Math.sign),n.sqrt=r.__make_elementwise(Math.sqrt),n.square=r.__make_elementwise(e=>e*e),n.abs=r.__make_elementwise(Math.abs),n.exp=r.__make_elementwise(Math.exp),n.log=r.__make_elementwise(Math.log),n.log2=r.__make_elementwise(Math.log2),n.log10=r.__make_elementwise(Math.log10),n.log1p=r.__make_elementwise(Math.log1p),n.sin=r.__make_elementwise(Math.sin),n.cos=r.__make_elementwise(Math.cos),n.tan=r.__make_elementwise(Math.tan),n.asin=r.__make_elementwise(Math.asin),n.acos=r.__make_elementwise(Math.acos),n.atan=r.__make_elementwise(Math.atan),n.atan2=r.__make_elementwise(Math.atan2),n.cosh=r.__make_elementwise(Math.cosh),n.sinh=r.__make_elementwise(Math.sinh),n.tanh=r.__make_elementwise(Math.tanh),n.acosh=r.__make_elementwise(Math.acosh),n.asinh=r.__make_elementwise(Math.asinh),n.atanh=r.__make_elementwise(Math.atanh),n.round=r.round,i=n.modules.constructors;n.empty=i.empty,n.zeros=i.zeros,n.ones=i.ones,n.arange=i.arange,n.linspace=i.linspace,n.geomspace=i.geomspace,e.exports=n},478:e=>{function o(e,t,r){var n=[[e,t,[],0]];let i;for(;;){var s=n.pop();if(!s)return!0;var[a,o,l,u]=s;if(Array.isArray(a)&&Array.isArray(o)&&a.length==o.length)for(var p in a){var c=[];l.push(c),n.push([a[p],o[p],c,u+1])}else l.push(r(a,o));if(1e4<u&&Array.isArray(a)){if((i=i||[]).includes(a))throw new Error("Circular reference found. "+a);i[u-1e4]=a}}}e.exports={ravel:function(e){var t=[[e,0]],r=[];let n;for(;;){var i=t.pop();if(!i)break;const[s,a]=i;if(1e4<a&&Array.isArray(s)){if((n=n||[]).includes(s))throw new Error("Circular reference found. "+s);n[a-1e4]=s}Array.isArray(s)?t.push(...s.map(e=>[e,a+1])):r.push(s)}return r},allEq:function(e,t,r=!1){const n=new Error("");try{o(e,t,(e,t)=>{if(e===t||r&&Number.isNaN(e)&&Number.isNaN(t))return 0;throw n})}catch(e){if(e===n)return!1;throw e}return!0},allClose:function(e,t,r=1e-5,n=1e-8,i=!1){const s=new Error("");var a=(e,t)=>{if(e=e,t=t,Number.isFinite(e)&&Number.isFinite(t)?Math.abs(e-t)<=n+r*Math.abs(t):e===t||i&&Number.isNaN(e)&&Number.isNaN(t))return 0;throw s};try{o(e,t,a)}catch(e){if(e===s)return!1;throw e}return!0},binary_operation:o}},593:(e,t,r)=>{const i=r(696).GLOBALS["np"];function n(e){return i.NDArray.prototype._new(e,e=>Math.random(),Number)}function s(e){var e=[...e],t=e;for(let e=t.length-1;0<=e;e--){var r=Math.floor(Math.random()*(e+1));[t[e],t[r]]=[t[r],t[e]]}return e}e.exports={random:n,uniform:function(e,t,r){return i.add(e,i.multiply(n(r),t-e))},exponential:function(e,t){return i.multiply(e,i.subtract(0,i.log(n(t))))},randn:function(e){var t=function(e){for(var t=[];t.length<e;){var r=2*Math.random()-1,n=2*Math.random()-1,i=r*r+n*n;1<=i||(r=Math.sqrt(-2*Math.log(i)/i)*r,i=Math.sqrt(-2*Math.log(i)/i)*n,t.push(r),t.push(i))}return e<t.length&&t.pop(),t}(i.prod(e));return new i.NDArray(t,e,Number)},normal:function(e,t,r){return i.add(e,i.multiply(t,r))},shuffle:function(e){e.assign(function(t){if(0==t.shape.length)return t;var e;if(1==t.shape.length)return e=s(t.flat),new i.NDArray(e,t.shape,t.dtype);var r=s(Array.from({length:t.length},(e,t)=>t)),n=i.empty(t.shape,t.dtype);for(let e=0;e<t.length;e++)n.assign([e],t.index(r[e]));return n}(e))}}},636:(D,e)=>{"use strict";function t(e){const t=e||"";return function(){throw new Error("this method "+t+" is abstract! (it has no implementation in class "+this.constructor.name+")")}}function m(e,t){if(!e)throw new Error(t||"Assertion failed")}function j(e,t,r){let n;Object.defineProperty(e,t,{get(){return n=n||r.call(this)}})}function T(e,t){for(var r=[];0<t--;)r.push(e());return r}function B(e,t){return new Array(t+1).join(e)}function G(e,t){return T(()=>e,t)}function q(t){var r=[];for(let e=0;e<t.length;e++){var n=t[e];t.lastIndexOf(n)!==e&&r.indexOf(n)<0&&r.push(n)}return r}function z(e){const t=[];return e.forEach(e=>{t.indexOf(e)<0&&t.push(e)}),t}function u(e){e=e[0];return e===e.toUpperCase()}function $(e){return!u(e)}function U(e,t,r){return e.length<t?B(r||" ",t-e.length)+e:e}function d(){this.strings=[]}Object.defineProperty(e,"__esModule",{value:!0}),d.prototype.append=function(e){this.strings.push(e)},d.prototype.contents=function(){return this.strings.join("")};const K=e=>String.fromCodePoint(parseInt(e,16));function V(e){if("\\"!==e.charAt(0))return e;switch(e.charAt(1)){case"b":return"\b";case"f":return"\f";case"n":return"\n";case"r":return"\r";case"t":return"\t";case"v":return"\v";case"x":return K(e.slice(2,4));case"u":return"{"===e.charAt(2)?K(e.slice(3,-1)):K(e.slice(2,6));default:return e.charAt(1)}}function J(t){if(null==t)return String(t);var r=Object.prototype.toString.call(t);try{let e;return(e=t.constructor&&t.constructor.name?t.constructor.name:0===r.indexOf("[object ")?r.slice(8,-1):typeof t)+": "+JSON.stringify(String(t))}catch(e){return r}}var H=Object.freeze({__proto__:null,abstract:t,assert:m,defineLazyProperty:j,clone:function(e){return e&&Object.assign({},e)},repeatFn:T,repeatStr:B,repeat:G,getDuplicates:q,copyWithoutDuplicates:z,isSyntactic:u,isLexical:$,padLeft:U,StringBuffer:d,unescapeCodePoint:V,unexpectedObjToString:J});const W={Lu:/\p{Lu}/u,Ll:/\p{Ll}/u,Lt:/\p{Lt}/u,Lm:/\p{Lm}/u,Lo:/\p{Lo}/u,Nl:/\p{Nl}/u,Nd:/\p{Nd}/u,Mn:/\p{Mn}/u,Mc:/\p{Mc}/u,Pc:/\p{Pc}/u,Zs:/\p{Zs}/u,L:/\p{Letter}/u,Ltmo:/\p{Lt}|\p{Lm}|\p{Lo}/u};class n{constructor(){if(this.constructor===n)throw new Error("PExpr cannot be instantiated -- it's abstract")}withSource(e){return e&&(this.source=e.trimmed()),this}}const r=Object.create(n.prototype),i=Object.create(n.prototype);class p extends n{constructor(e){super(),this.obj=e}}class s extends n{constructor(e,t){super(),this.from=e,this.to=t,this.matchCodePoint=1<e.length||1<t.length}}class a extends n{constructor(e){super(),this.index=e}}class o extends n{constructor(e){super(),this.terms=e}}class l extends o{constructor(e,t,r){super([r,e.rules[t].body]),this.superGrammar=e,this.name=t,this.body=r}}class c extends o{constructor(e,t,r,n){var i=e.rules[t].body;super([...r,i,...n]),this.superGrammar=e,this.ruleName=t,this.expansionPos=r.length}}class h extends n{constructor(e){super(),this.factors=e}}class f extends n{constructor(e){super(),this.expr=e}}class g extends f{}class y extends f{}class v extends f{}g.prototype.operator="*",y.prototype.operator="+",v.prototype.operator="?",g.prototype.minNumMatches=0,y.prototype.minNumMatches=1,v.prototype.minNumMatches=0,g.prototype.maxNumMatches=Number.POSITIVE_INFINITY,y.prototype.maxNumMatches=Number.POSITIVE_INFINITY,v.prototype.maxNumMatches=1;class _ extends n{constructor(e){super(),this.expr=e}}class I extends n{constructor(e){super(),this.expr=e}}class x extends n{constructor(e){super(),this.expr=e}}class b extends n{constructor(e,t=[]){super(),this.ruleName=e,this.args=t}isSyntactic(){return u(this.ruleName)}toMemoKey(){return this._memoKey||Object.defineProperty(this,"_memoKey",{value:this.toString()}),this._memoKey}}class w extends n{constructor(e){super(),this.category=e,this.pattern=W[e]}}function S(e,t){let r;return t?((r=new Error(t.getLineAndColumnMessage()+e)).shortMessage=e,r.interval=t):r=new Error(e),r}function Q(){return S("Interval sources don't match")}function Z(e,t,r){return S("Rule "+e+" is not declared in grammar "+t,r)}function Y(e,t,r,n){let i="Duplicate declaration for rule '"+e+"' in grammar '"+t+"'";return t!==r&&(i+=" (originally declared in '"+r+"')"),S(i,n)}function X(e,t,r,n){return S("Wrong number of parameters for rule "+e+" (expected "+t+", got "+r+")",n)}function ee(e,t,r){return S("Duplicate parameter names in rule "+e+": "+t.join(", "),r)}function te(e,t){return S("Incorrect argument type: expected "+e,t.source)}function re(e,t){var r=0<t.length?t[t.length-1].args:[];let n="Nullable expression "+e.expr.substituteParams(r)+" is not allowed inside '"+e.operator+"' (possible infinite loop)";return 0<t.length&&(r=t.map(e=>new b(e.ruleName,e.args)).join("\n"),n+="\nApplication stack (most recent application last):\n"+r),S(n,e.expr.source)}function ne(e,t,r,n){return S("Rule "+e+" involves an alternation which has inconsistent arity (expected "+t+", got "+r+")",n.source)}function ie(e){if(1===e.length)throw e[0];if(1<e.length)throw t=(e=e).map(e=>e.message),S(["Errors:"].concat(t).join("\n- "),e[0].interval);var t}function se(e,t,r){var n=e.length;return(e.slice(0,r)+t+e.slice(r+t.length)).substr(0,n)}function ae(...t){var r=this,n=r["offset"],i=H["repeatStr"];const s=new d,a=(s.append("Line "+r.lineNum+", col "+r.colNum+":\n"),function(e){let t=0;return e.map(e=>{e=e.toString();return t=Math.max(t,e.length),e}).map(e=>U(e,t))}([null==r.prevLine?0:r.lineNum-1,r.lineNum,null==r.nextLine?0:r.lineNum+1]));var e=(e,t,r)=>{s.append(r+a[e]+" | "+t+"\n")},o=(null!=r.prevLine&&e(0,r.prevLine,"  "),e(1,r.line,"> "),r.line.length);let l=i(" ",o+1);for(let e=0;e<t.length;++e){var u=t[e][0],p=t[e][1],c=(m(0<=u&&u<=p,"range start must be >= 0 and <= end"),n-r.colNum+1),u=Math.max(0,u-c),p=Math.min(p-c,o);l=se(l,i("~",p-u),u)}var h=2+a[1].length+3;return s.append(i(" ",h)),l=se(l,"^",r.colNum-1),s.append(l.replace(/ +$/,"")+"\n"),null!=r.nextLine&&e(2,r.nextLine,"  "),s.contents()}let oe=[];function le(e){oe.push(e)}function ue(e,t){let r=1,n=1,i=0,s=0,a=null,o=null,l=-1;for(;i<t;){var u=e.charAt(i++);"\n"===u?(r++,n=1,l=s,s=i):"\r"!==u&&n++}let p=e.indexOf("\n",s);-1===p?p=e.length:(c=e.indexOf("\n",p+1),a=(a=-1===c?e.slice(p):e.slice(p,c)).replace(/^\r?\n/,"").replace(/\r$/,"")),0<=l&&(o=e.slice(l,s).replace(/\r?\n$/,""));var c=e.slice(s,p).replace(/\r$/,"");return{offset:t,lineNum:r,colNum:n,line:c,prevLine:o,nextLine:a,toString:ae}}function pe(e,t,...r){return ue(e,t).toString(...r)}const ce=(()=>{let t=0;return e=>""+e+t++})();class A{constructor(e,t,r){this.sourceString=e,this.startIdx=t,this.endIdx=r}get contents(){return void 0===this._contents&&(this._contents=this.sourceString.slice(this.startIdx,this.endIdx)),this._contents}get length(){return this.endIdx-this.startIdx}coverageWith(...e){return A.coverage(...e,this)}collapsedLeft(){return new A(this.sourceString,this.startIdx,this.startIdx)}collapsedRight(){return new A(this.sourceString,this.endIdx,this.endIdx)}getLineAndColumn(){return ue(this.sourceString,this.startIdx)}getLineAndColumnMessage(){var e=[this.startIdx,this.endIdx];return pe(this.sourceString,this.startIdx,e)}minus(e){if(this.sourceString!==e.sourceString)throw Q();return this.startIdx===e.startIdx&&this.endIdx===e.endIdx?[]:this.startIdx<e.startIdx&&e.endIdx<this.endIdx?[new A(this.sourceString,this.startIdx,e.startIdx),new A(this.sourceString,e.endIdx,this.endIdx)]:this.startIdx<e.endIdx&&e.endIdx<this.endIdx?[new A(this.sourceString,e.endIdx,this.endIdx)]:this.startIdx<e.startIdx&&e.startIdx<this.endIdx?[new A(this.sourceString,this.startIdx,e.startIdx)]:[this]}relativeTo(e){if(this.sourceString!==e.sourceString)throw Q();return m(this.startIdx>=e.startIdx&&this.endIdx<=e.endIdx,"other interval does not cover this one"),new A(this.sourceString,this.startIdx-e.startIdx,this.endIdx-e.startIdx)}trimmed(){var e=this["contents"],t=this.startIdx+e.match(/^\s*/)[0].length,e=this.endIdx-e.match(/\s*$/)[0].length;return new A(this.sourceString,t,e)}subInterval(e,t){e=this.startIdx+e;return new A(this.sourceString,e,e+t)}}A.coverage=function(e,...t){let{startIdx:r,endIdx:n}=e;for(const i of t){if(i.sourceString!==e.sourceString)throw Q();r=Math.min(r,i.startIdx),n=Math.max(n,i.endIdx)}return new A(e.sourceString,r,n)};class he{constructor(e){this.source=e,this.pos=0,this.examinedLength=0}atEnd(){var e=this.pos>=this.source.length;return this.examinedLength=Math.max(this.examinedLength,this.pos+1),e}next(){var e=this.source[this.pos++];return this.examinedLength=Math.max(this.examinedLength,this.pos),e}nextCharCode(){var e=this.next();return e&&e.charCodeAt(0)}nextCodePoint(){var e=this.source.slice(this.pos++).codePointAt(0);return 65535<e&&(this.pos+=1),this.examinedLength=Math.max(this.examinedLength,this.pos),e}matchString(e,t){let r;if(t)for(r=0;r<e.length;r++){var n=this.next(),i=e[r];if(null==n||n.toUpperCase()!==i.toUpperCase())return!1}else for(r=0;r<e.length;r++)if(this.next()!==e[r])return!1;return!0}sourceSlice(e,t){return this.source.slice(e,t)}interval(e,t){return new A(this.source,e,t||this.pos)}}class me{constructor(e,t,r,n,i,s,a){this.matcher=e,this.input=t,this.startExpr=r,this._cst=n,this._cstOffset=i,this._rightmostFailurePosition=s,this._rightmostFailures=a,this.failed()&&(j(this,"message",function(){var e="Expected "+this.getExpectedText();return pe(this.input,this.getRightmostFailurePosition())+e}),j(this,"shortMessage",function(){var e="expected "+this.getExpectedText(),t=ue(this.input,this.getRightmostFailurePosition());return"Line "+t.lineNum+", col "+t.colNum+": "+e}))}succeeded(){return!!this._cst}failed(){return!this.succeeded()}getRightmostFailurePosition(){return this._rightmostFailurePosition}getRightmostFailures(){var e;return this._rightmostFailures||(this.matcher.setInput(this.input),e=this.matcher._match(this.startExpr,{tracing:!1,positionToRecordFailures:this.getRightmostFailurePosition()}),this._rightmostFailures=e.getRightmostFailures()),this._rightmostFailures}toString(){return this.succeeded()?"[match succeeded]":"[match failed at position "+this.getRightmostFailurePosition()+"]"}getExpectedText(){if(this.succeeded())throw new Error("cannot get expected text of a successful MatchResult");var t=new d;let r=this.getRightmostFailures();r=r.filter(e=>!e.isFluffy());for(let e=0;e<r.length;e++)0<e&&(e===r.length-1?t.append(2<r.length?", or ":" or "):t.append(", ")),t.append(r[e].toString());return t.contents()}getInterval(){var e=this.getRightmostFailurePosition();return new A(this.input,e,e)}}class de{constructor(){this.applicationMemoKeyStack=[],this.memo={},this.maxExaminedLength=0,this.maxRightmostFailureOffset=-1,this.currentLeftRecursion=void 0}isActive(e){return 0<=this.applicationMemoKeyStack.indexOf(e.toMemoKey())}enter(e){this.applicationMemoKeyStack.push(e.toMemoKey())}exit(){this.applicationMemoKeyStack.pop()}startLeftRecursion(e,t){t.isLeftRecursion=!0,t.headApplication=e,t.nextLeftRecursion=this.currentLeftRecursion,this.currentLeftRecursion=t;const r=this["applicationMemoKeyStack"],n=r.indexOf(e.toMemoKey())+1,i=r.slice(n);t.isInvolved=function(e){return 0<=i.indexOf(e)},t.updateInvolvedApplicationMemoKeys=function(){for(let e=n;e<r.length;e++){var t=r[e];this.isInvolved(t)||i.push(t)}}}endLeftRecursion(){this.currentLeftRecursion=this.currentLeftRecursion.nextLeftRecursion}shouldUseMemoizedResult(t){if(t.isLeftRecursion){var r=this["applicationMemoKeyStack"];for(let e=0;e<r.length;e++){var n=r[e];if(t.isInvolved(n))return!1}}return!0}memoize(e,t){return this.memo[e]=t,this.maxExaminedLength=Math.max(this.maxExaminedLength,t.examinedLength),this.maxRightmostFailureOffset=Math.max(this.maxRightmostFailureOffset,t.rightmostFailureOffset),t}clearObsoleteEntries(r,n){if(!(r+this.maxExaminedLength<=n)){const i=this["memo"];this.maxExaminedLength=0,this.maxRightmostFailureOffset=-1,Object.keys(i).forEach(e=>{var t=i[e];r+t.examinedLength>n?delete i[e]:(this.maxExaminedLength=Math.max(this.maxExaminedLength,t.examinedLength),this.maxRightmostFailureOffset=Math.max(this.maxRightmostFailureOffset,t.rightmostFailureOffset))})}}}const fe="⋅",ge="␉",ye="␊",ve="␍",_e={succeeded:1,isRootNode:2,isImplicitSpaces:4,isMemoized:8,isHeadOfLeftRecursion:16,terminatesLR:32};function Ie(e){return"string"==typeof e?e.replace(/ /g,fe).replace(/\t/g,ge).replace(/\n/g,ye).replace(/\r/g,ve):String(e)}class N{constructor(e,t,r,n,i,s,a){this.input=e,this.pos=this.pos1=t,this.pos2=r,this.source=new A(e,t,r),this.expr=n,this.bindings=s,this.children=a||[],this.terminatingLREntry=null,this._flags=i?_e.succeeded:0}get displayString(){return this.expr.toDisplayString()}clone(){return this.cloneWithExpr(this.expr)}cloneWithExpr(e){e=new N(this.input,this.pos,this.pos2,e,this.succeeded,this.bindings,this.children);return e.isHeadOfLeftRecursion=this.isHeadOfLeftRecursion,e.isImplicitSpaces=this.isImplicitSpaces,e.isMemoized=this.isMemoized,e.isRootNode=this.isRootNode,e.terminatesLR=this.terminatesLR,e.terminatingLREntry=this.terminatingLREntry,e}recordLRTermination(e,t){this.terminatingLREntry=new N(this.input,this.pos,this.pos2,this.expr,!1,[t],[e]),this.terminatingLREntry.terminatesLR=!0}walk(e,i){let s=e;function a(t,e,r){let n=!0;(n=s.enter&&s.enter.call(i,t,e,r)===N.prototype.SKIP?!1:n)&&(t.children.forEach(e=>{a(e,t,r+1)}),s.exit)&&s.exit.call(i,t,e,r)}"function"==typeof s&&(s={enter:s}),this.isRootNode?this.children.forEach(e=>{a(e,null,0)}):a(this,null,0)}toString(){const a=new d;return this.walk((e,t,r)=>{if(!e)return this.SKIP;var n,i,s;"Alt"!==e.expr.constructor.name&&(a.append((n=e.input,s=e.pos,i=10,((n=Ie(n.slice(s,s+i))).length<i?n+G(" ",i-n.length).join(""):n)+G(" ",2*r+1).join(""))),a.append((e.succeeded?"✓":"✗")+" "+e.displayString),e.isHeadOfLeftRecursion&&a.append(" (LR)"),e.succeeded&&(s=Ie(e.source.contents),a.append(" ⇒  "),a.append("string"==typeof s?'"'+s+'"':s)),a.append("\n"))}),a.contents()}}N.prototype.SKIP={},Object.keys(_e).forEach(e=>{const t=_e[e];Object.defineProperty(N.prototype,e,{get(){return 0!=(this._flags&t)},set(e){e?this._flags|=t:this._flags&=~t}})}),n.prototype.allowsSkippingPrecedingSpace=t("allowsSkippingPrecedingSpace"),r.allowsSkippingPrecedingSpace=i.allowsSkippingPrecedingSpace=b.prototype.allowsSkippingPrecedingSpace=p.prototype.allowsSkippingPrecedingSpace=s.prototype.allowsSkippingPrecedingSpace=w.prototype.allowsSkippingPrecedingSpace=function(){return!0},o.prototype.allowsSkippingPrecedingSpace=f.prototype.allowsSkippingPrecedingSpace=x.prototype.allowsSkippingPrecedingSpace=I.prototype.allowsSkippingPrecedingSpace=_.prototype.allowsSkippingPrecedingSpace=a.prototype.allowsSkippingPrecedingSpace=h.prototype.allowsSkippingPrecedingSpace=function(){return!1};let O;le(e=>{O=e});let xe;n.prototype.assertAllApplicationsAreValid=function(e,t){xe=0,this._assertAllApplicationsAreValid(e,t)},n.prototype._assertAllApplicationsAreValid=t("_assertAllApplicationsAreValid"),r._assertAllApplicationsAreValid=i._assertAllApplicationsAreValid=p.prototype._assertAllApplicationsAreValid=s.prototype._assertAllApplicationsAreValid=a.prototype._assertAllApplicationsAreValid=w.prototype._assertAllApplicationsAreValid=function(e,t){},x.prototype._assertAllApplicationsAreValid=function(e,t){xe++,this.expr._assertAllApplicationsAreValid(e,t),xe--},o.prototype._assertAllApplicationsAreValid=function(t,r){for(let e=0;e<this.terms.length;e++)this.terms[e]._assertAllApplicationsAreValid(t,r)},h.prototype._assertAllApplicationsAreValid=function(t,r){for(let e=0;e<this.factors.length;e++)this.factors[e]._assertAllApplicationsAreValid(t,r)},f.prototype._assertAllApplicationsAreValid=_.prototype._assertAllApplicationsAreValid=I.prototype._assertAllApplicationsAreValid=function(e,t){this.expr._assertAllApplicationsAreValid(e,t)},b.prototype._assertAllApplicationsAreValid=function(t,r,e=!1){var n=r.rules[this.ruleName],i=u(t)&&0===xe;if(!n)throw Z(this.ruleName,r.name,this.source);if(!e&&u(this.ruleName)&&!i)throw S("Cannot apply syntactic rule "+this.ruleName+" from here (inside a lexical context)",this.source);var s,e=this.args.length,a=n.formals.length;if(e!==a)throw l=this.ruleName,s=this.source,S("Wrong number of arguments for rule "+l+" (expected "+a+", got "+e+")",s);const o=O&&n===O.rules.applySyntactic;var l=O&&n===O.rules.caseInsensitive;if(l&&!(this.args[0]instanceof p))throw te('a Terminal (e.g. "abc")',this.args[0]);if(o){a=this.args[0];if(!(a instanceof b))throw te("a syntactic rule application",a);if(!u(a.ruleName))throw S(`applySyntactic is for syntactic rules, but '${a.ruleName}' is a lexical rule. `+"NOTE: A _syntactic rule_ is a rule whose name begins with a capital letter. See https://ohmjs.org/d/svl for more details.",a.source);if(i)throw S("applySyntactic is not required here (in a syntactic context)",this.source)}this.args.forEach(e=>{if(e._assertAllApplicationsAreValid(t,r,o),1!==e.getArity())throw S("Invalid parameter to rule "+this.ruleName+": "+(e=e)+" has arity "+e.getArity()+", but parameter expressions must have arity 1",e.source)})},n.prototype.assertChoicesHaveUniformArity=t("assertChoicesHaveUniformArity"),r.assertChoicesHaveUniformArity=i.assertChoicesHaveUniformArity=p.prototype.assertChoicesHaveUniformArity=s.prototype.assertChoicesHaveUniformArity=a.prototype.assertChoicesHaveUniformArity=x.prototype.assertChoicesHaveUniformArity=w.prototype.assertChoicesHaveUniformArity=function(e){},o.prototype.assertChoicesHaveUniformArity=function(t){if(0!==this.terms.length){var r=this.terms[0].getArity();for(let e=0;e<this.terms.length;e++){var n=this.terms[e],i=(n.assertChoicesHaveUniformArity(),n.getArity());if(r!==i)throw ne(t,r,i,n)}}},l.prototype.assertChoicesHaveUniformArity=function(e){var t=this.terms[0].getArity(),r=this.terms[1].getArity();if(t!==r)throw ne(e,r,t,this.terms[0])},h.prototype.assertChoicesHaveUniformArity=function(t){for(let e=0;e<this.factors.length;e++)this.factors[e].assertChoicesHaveUniformArity(t)},f.prototype.assertChoicesHaveUniformArity=function(e){this.expr.assertChoicesHaveUniformArity(e)},_.prototype.assertChoicesHaveUniformArity=function(e){},I.prototype.assertChoicesHaveUniformArity=function(e){this.expr.assertChoicesHaveUniformArity(e)},b.prototype.assertChoicesHaveUniformArity=function(e){},n.prototype.assertIteratedExprsAreNotNullable=t("assertIteratedExprsAreNotNullable"),r.assertIteratedExprsAreNotNullable=i.assertIteratedExprsAreNotNullable=p.prototype.assertIteratedExprsAreNotNullable=s.prototype.assertIteratedExprsAreNotNullable=a.prototype.assertIteratedExprsAreNotNullable=w.prototype.assertIteratedExprsAreNotNullable=function(e){},o.prototype.assertIteratedExprsAreNotNullable=function(t){for(let e=0;e<this.terms.length;e++)this.terms[e].assertIteratedExprsAreNotNullable(t)},h.prototype.assertIteratedExprsAreNotNullable=function(t){for(let e=0;e<this.factors.length;e++)this.factors[e].assertIteratedExprsAreNotNullable(t)},f.prototype.assertIteratedExprsAreNotNullable=function(e){if(this.expr.assertIteratedExprsAreNotNullable(e),this.expr.isNullable(e))throw re(this,[])},v.prototype.assertIteratedExprsAreNotNullable=_.prototype.assertIteratedExprsAreNotNullable=I.prototype.assertIteratedExprsAreNotNullable=x.prototype.assertIteratedExprsAreNotNullable=function(e){this.expr.assertIteratedExprsAreNotNullable(e)},b.prototype.assertIteratedExprsAreNotNullable=function(t){this.args.forEach(e=>{e.assertIteratedExprsAreNotNullable(t)})};class be{constructor(e){this.matchLength=e}get ctorName(){throw new Error("subclass responsibility")}numChildren(){return this.children?this.children.length:0}childAt(e){if(this.children)return this.children[e]}indexOfChild(e){return this.children.indexOf(e)}hasChildren(){return 0<this.numChildren()}hasNoChildren(){return!this.hasChildren()}onlyChild(){if(1!==this.numChildren())throw new Error("cannot get only child of a node of type "+this.ctorName+" (it has "+this.numChildren()+" children)");return this.firstChild()}firstChild(){if(this.hasNoChildren())throw new Error("cannot get first child of a "+this.ctorName+" node, which has no children");return this.childAt(0)}lastChild(){if(this.hasNoChildren())throw new Error("cannot get last child of a "+this.ctorName+" node, which has no children");return this.childAt(this.numChildren()-1)}childBefore(e){e=this.indexOfChild(e);if(e<0)throw new Error("Node.childBefore() called w/ an argument that is not a child");if(0===e)throw new Error("cannot get child before first child");return this.childAt(e-1)}childAfter(e){e=this.indexOfChild(e);if(e<0)throw new Error("Node.childAfter() called w/ an argument that is not a child");if(e===this.numChildren()-1)throw new Error("cannot get child after last child");return this.childAt(e+1)}isTerminal(){return!1}isNonterminal(){return!1}isIteration(){return!1}isOptional(){return!1}}class L extends be{get ctorName(){return"_terminal"}isTerminal(){return!0}get primitiveValue(){throw new Error("The `primitiveValue` property was removed in Ohm v17.")}}class we extends be{constructor(e,t,r,n){super(n),this.ruleName=e,this.children=t,this.childOffsets=r}get ctorName(){return this.ruleName}isNonterminal(){return!0}isLexical(){return $(this.ctorName)}isSyntactic(){return u(this.ctorName)}}class Se extends be{constructor(e,t,r,n){super(r),this.children=e,this.childOffsets=t,this.optional=n}get ctorName(){return"_iter"}isIteration(){return!0}isOptional(){return this.optional}}function E(e,t){var r={};return e.source&&t&&(e=e.source.relativeTo(t),r.sourceInterval=[e.startIdx,e.endIdx]),r}function Ae(e){return/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(e)}function Ne(i){const t=Object.create(null);i.forEach(e=>{t[e]=(t[e]||0)+1}),Object.keys(t).forEach(n=>{if(!(t[n]<=1)){let r=1;i.forEach((e,t)=>{e===n&&(i[t]=e+"_"+r++)})}})}n.prototype.eval=t("eval"),r.eval=function(e){var t=e["inputStream"],r=t.pos,t=t.nextCodePoint();return void 0!==t?(e.pushBinding(new L(String.fromCodePoint(t).length),r),!0):(e.processFailure(r,this),!1)},i.eval=function(e){var t=e["inputStream"],r=t.pos;return t.atEnd()?(e.pushBinding(new L(0),r),!0):(e.processFailure(r,this),!1)},p.prototype.eval=function(e){var t=e["inputStream"],r=t.pos;return t.matchString(this.obj)?(e.pushBinding(new L(this.obj.length),r),!0):(e.processFailure(r,this),!1)},s.prototype.eval=function(e){var t=e["inputStream"],r=t.pos,t=this.matchCodePoint?t.nextCodePoint():t.nextCharCode();return void 0!==t&&this.from.codePointAt(0)<=t&&t<=this.to.codePointAt(0)?(e.pushBinding(new L(String.fromCodePoint(t).length),r),!0):(e.processFailure(r,this),!1)},a.prototype.eval=function(e){return e.eval(e.currentApplication().args[this.index])},x.prototype.eval=function(e){e.enterLexifiedContext();var t=e.eval(this.expr);return e.exitLexifiedContext(),t},o.prototype.eval=function(t){for(let e=0;e<this.terms.length;e++)if(t.eval(this.terms[e]))return!0;return!1},h.prototype.eval=function(t){for(let e=0;e<this.factors.length;e++){var r=this.factors[e];if(!t.eval(r))return!1}return!0},f.prototype.eval=function(e){for(var t=e["inputStream"],r=t.pos,n=this.getArity(),i=[],s=[];i.length<n;)i.push([]),s.push([]);let a=0,o=r,l;for(;a<this.maxNumMatches&&e.eval(this.expr);){if(t.pos===o)throw re(this,e._applicationStack);o=t.pos,a++;var u=e._bindings.splice(e._bindings.length-n,n),p=e._bindingOffsets.splice(e._bindingOffsets.length-n,n);for(l=0;l<u.length;l++)i[l].push(u[l]),s[l].push(p[l])}if(a<this.minNumMatches)return!1;let c=e.posToOffset(r),h=0;0<a&&(r=(r=s[n-1])[r.length-1]+(r=i[n-1])[r.length-1].matchLength,c=s[0][0],h=r-c);var m=this instanceof v;for(l=0;l<i.length;l++)e._bindings.push(new Se(i[l],s[l],h,m)),e._bindingOffsets.push(c);return!0},_.prototype.eval=function(e){var t=e["inputStream"],r=t.pos,n=(e.pushFailuresInfo(),e.eval(this.expr));return e.popFailuresInfo(),n?(e.processFailure(r,this),!1):(t.pos=r,!0)},I.prototype.eval=function(e){var t=e["inputStream"],r=t.pos;return!!e.eval(this.expr)&&(t.pos=r,!0)},b.prototype.eval=function(e){var t=e.currentApplication(),t=t?t.args:[],t=this.substituteParams(t),r=e.getCurrentPosInfo();if(r.isActive(t))return t.handleCycle(e);var n=t.toMemoKey(),i=r.memo[n];if(i&&r.shouldUseMemoizedResult(i)){if(e.hasNecessaryInfo(i))return e.useMemoizedResult(e.inputStream.pos,i);delete r.memo[n]}return t.reallyEval(e)},b.prototype.handleCycle=function(e){var t=e.getCurrentPosInfo(),r=t["currentLeftRecursion"],n=this.toMemoKey();let i=t.memo[n];return r&&r.headApplication.toMemoKey()===n?i.updateInvolvedApplicationMemoKeys():i||(i=t.memoize(n,{matchLength:0,examinedLength:0,value:!1,rightmostFailureOffset:-1}),t.startLeftRecursion(this,i)),e.useMemoizedResult(e.inputStream.pos,i)},b.prototype.reallyEval=function(e){var t=e["inputStream"],r=t.pos,n=e.getCurrentPosInfo(),i=e.grammar.rules[this.ruleName],s=i["body"],i=i["description"],a=(e.enterApplication(n,this),i&&e.pushFailuresInfo(),t.examinedLength);t.examinedLength=0;let o=this.evalOnce(s,e);var l=n.currentLeftRecursion,u=this.toMemoKey(),p=l&&l.headApplication.toMemoKey()===u;let c;e.doNotMemoize?e.doNotMemoize=!1:p?(o=this.growSeedResult(s,e,r,l,o),n.endLeftRecursion(),(c=l).examinedLength=t.examinedLength-r,c.rightmostFailureOffset=e._getRightmostFailureOffset(),n.memoize(u,c)):l&&l.isInvolved(u)||(c=n.memoize(u,{matchLength:t.pos-r,examinedLength:t.examinedLength-r,value:o,failuresAtRightmostPosition:e.cloneRecordedFailures(),rightmostFailureOffset:e._getRightmostFailureOffset()}));s=!!o;return i&&(e.popFailuresInfo(),s||e.processFailure(r,this),c)&&(c.failuresAtRightmostPosition=e.cloneRecordedFailures()),e.isTracing()&&c&&(l=e.getTraceEntry(r,this,s,s?[o]:[]),p&&(m(null!=l.terminatingLREntry||!s),l.isHeadOfLeftRecursion=!0),c.traceEntry=l),t.examinedLength=Math.max(t.examinedLength,a),e.exitApplication(n,o),s},b.prototype.evalOnce=function(e,t){var r,n=t["inputStream"],i=n.pos;return!!t.eval(e)&&(e=e.getArity(),r=t._bindings.splice(t._bindings.length-e,e),t=t._bindingOffsets.splice(t._bindingOffsets.length-e,e),e=n.pos-i,new we(this.ruleName,r,t,e))},b.prototype.growSeedResult=function(e,t,r,n,i){if(!i)return!1;for(var s,a=t["inputStream"];n.matchLength=a.pos-r,n.value=i,n.failuresAtRightmostPosition=t.cloneRecordedFailures(),t.isTracing()&&(s=t.trace[t.trace.length-1],n.traceEntry=new N(t.input,r,a.pos,this,!0,[i],[s.clone()])),a.pos=r,i=this.evalOnce(e,t),!(a.pos-r<=n.matchLength);)t.isTracing()&&t.trace.splice(-2,1);return t.isTracing()&&n.traceEntry.recordLRTermination(t.trace.pop(),i),a.pos=r+n.matchLength,n.value},w.prototype.eval=function(e){var t=e["inputStream"],r=t.pos,t=t.next();return t&&this.pattern.test(t)?(e.pushBinding(new L(t.length),r),!0):(e.processFailure(r,this),!1)},n.prototype.getArity=t("getArity"),r.getArity=i.getArity=p.prototype.getArity=s.prototype.getArity=a.prototype.getArity=b.prototype.getArity=w.prototype.getArity=function(){return 1},o.prototype.getArity=function(){return 0===this.terms.length?0:this.terms[0].getArity()},h.prototype.getArity=function(){let t=0;for(let e=0;e<this.factors.length;e++)t+=this.factors[e].getArity();return t},f.prototype.getArity=function(){return this.expr.getArity()},_.prototype.getArity=function(){return 0},I.prototype.getArity=x.prototype.getArity=function(){return this.expr.getArity()},n.prototype.outputRecipe=t("outputRecipe"),r.outputRecipe=function(e,t){return["any",E(this,t)]},i.outputRecipe=function(e,t){return["end",E(this,t)]},p.prototype.outputRecipe=function(e,t){return["terminal",E(this,t),this.obj]},s.prototype.outputRecipe=function(e,t){return["range",E(this,t),this.from,this.to]},a.prototype.outputRecipe=function(e,t){return["param",E(this,t),this.index]},o.prototype.outputRecipe=function(t,r){return["alt",E(this,r)].concat(this.terms.map(e=>e.outputRecipe(t,r)))},l.prototype.outputRecipe=function(e,t){return this.terms[0].outputRecipe(e,t)},c.prototype.outputRecipe=function(t,r){var e=this.terms.slice(0,this.expansionPos),n=this.terms.slice(this.expansionPos+1);return["splice",E(this,r),e.map(e=>e.outputRecipe(t,r)),n.map(e=>e.outputRecipe(t,r))]},h.prototype.outputRecipe=function(t,r){return["seq",E(this,r)].concat(this.factors.map(e=>e.outputRecipe(t,r)))},g.prototype.outputRecipe=y.prototype.outputRecipe=v.prototype.outputRecipe=_.prototype.outputRecipe=I.prototype.outputRecipe=x.prototype.outputRecipe=function(e,t){return[this.constructor.name.toLowerCase(),E(this,t),this.expr.outputRecipe(e,t)]},b.prototype.outputRecipe=function(t,r){return["app",E(this,r),this.ruleName,this.args.map(e=>e.outputRecipe(t,r))]},w.prototype.outputRecipe=function(e,t){return["unicodeChar",E(this,t),this.category]},n.prototype.introduceParams=t("introduceParams"),r.introduceParams=i.introduceParams=p.prototype.introduceParams=s.prototype.introduceParams=a.prototype.introduceParams=w.prototype.introduceParams=function(e){return this},o.prototype.introduceParams=function(n){return this.terms.forEach((e,t,r)=>{r[t]=e.introduceParams(n)}),this},h.prototype.introduceParams=function(n){return this.factors.forEach((e,t,r)=>{r[t]=e.introduceParams(n)}),this},f.prototype.introduceParams=_.prototype.introduceParams=I.prototype.introduceParams=x.prototype.introduceParams=function(e){return this.expr=this.expr.introduceParams(e),this},b.prototype.introduceParams=function(n){var e=n.indexOf(this.ruleName);if(0<=e){if(0<this.args.length)throw new Error("Parameterized rules cannot be passed as arguments to another rule.");return new a(e).withSource(this.source)}return this.args.forEach((e,t,r)=>{r[t]=e.introduceParams(n)}),this},n.prototype.isNullable=function(e){return this._isNullable(e,Object.create(null))},n.prototype._isNullable=t("_isNullable"),r._isNullable=s.prototype._isNullable=a.prototype._isNullable=y.prototype._isNullable=w.prototype._isNullable=function(e,t){return!1},i._isNullable=function(e,t){return!0},p.prototype._isNullable=function(e,t){return"string"==typeof this.obj&&""===this.obj},o.prototype._isNullable=function(t,r){return 0===this.terms.length||this.terms.some(e=>e._isNullable(t,r))},h.prototype._isNullable=function(t,r){return this.factors.every(e=>e._isNullable(t,r))},g.prototype._isNullable=v.prototype._isNullable=_.prototype._isNullable=I.prototype._isNullable=function(e,t){return!0},x.prototype._isNullable=function(e,t){return this.expr._isNullable(e,t)},b.prototype._isNullable=function(e,t){var r,n=this.toMemoKey();return Object.prototype.hasOwnProperty.call(t,n)||(r=e.rules[this.ruleName]["body"],r=r.substituteParams(this.args),t[n]=!1,t[n]=r._isNullable(e,t)),t[n]},n.prototype.substituteParams=t("substituteParams"),r.substituteParams=i.substituteParams=p.prototype.substituteParams=s.prototype.substituteParams=w.prototype.substituteParams=function(e){return this},a.prototype.substituteParams=function(e){return e[this.index]},o.prototype.substituteParams=function(t){return new o(this.terms.map(e=>e.substituteParams(t)))},h.prototype.substituteParams=function(t){return new h(this.factors.map(e=>e.substituteParams(t)))},f.prototype.substituteParams=_.prototype.substituteParams=I.prototype.substituteParams=x.prototype.substituteParams=function(e){return new this.constructor(this.expr.substituteParams(e))},b.prototype.substituteParams=function(t){var e;return 0===this.args.length?this:(e=this.args.map(e=>e.substituteParams(t)),new b(this.ruleName,e))},n.prototype.toArgumentNameList=t("toArgumentNameList"),r.toArgumentNameList=function(e,t){return["any"]},i.toArgumentNameList=function(e,t){return["end"]},p.prototype.toArgumentNameList=function(e,t){return"string"==typeof this.obj&&/^[_a-zA-Z0-9]+$/.test(this.obj)?["_"+this.obj]:["$"+e]},s.prototype.toArgumentNameList=function(e,t){let r=this.from+"_to_"+this.to;return Ae(r)||(r="_"+r),[r=Ae(r)?r:"$"+e]},o.prototype.toArgumentNameList=function(t,e){var r=this.terms.map(e=>e.toArgumentNameList(t,!0)),n=[],i=r[0].length;for(let t=0;t<i;t++){var s=[];for(let e=0;e<this.terms.length;e++)s.push(r[e][t]);var a=z(s);n.push(a.join("_or_"))}return e||Ne(n),n},h.prototype.toArgumentNameList=function(t,e){let r=[];return this.factors.forEach(e=>{e=e.toArgumentNameList(t,!0);r=r.concat(e),t+=e.length}),e||Ne(r),r},f.prototype.toArgumentNameList=function(e,t){e=this.expr.toArgumentNameList(e,t).map(e=>"s"===e[e.length-1]?e+"es":e+"s");return t||Ne(e),e},v.prototype.toArgumentNameList=function(e,t){return this.expr.toArgumentNameList(e,t).map(e=>"opt"+e[0].toUpperCase()+e.slice(1))},_.prototype.toArgumentNameList=function(e,t){return[]},I.prototype.toArgumentNameList=x.prototype.toArgumentNameList=function(e,t){return this.expr.toArgumentNameList(e,t)},b.prototype.toArgumentNameList=function(e,t){return[this.ruleName]},w.prototype.toArgumentNameList=function(e,t){return["$"+e]},a.prototype.toArgumentNameList=function(e,t){return["param"+this.index]},n.prototype.toDisplayString=t("toDisplayString"),o.prototype.toDisplayString=h.prototype.toDisplayString=function(){return this.source?this.source.trimmed().contents:"["+this.constructor.name+"]"},r.toDisplayString=i.toDisplayString=f.prototype.toDisplayString=_.prototype.toDisplayString=I.prototype.toDisplayString=x.prototype.toDisplayString=p.prototype.toDisplayString=s.prototype.toDisplayString=a.prototype.toDisplayString=function(){return this.toString()},b.prototype.toDisplayString=function(){var e;return 0<this.args.length?(e=this.args.map(e=>e.toDisplayString()),this.ruleName+"<"+e.join(",")+">"):this.ruleName},w.prototype.toDisplayString=function(){return"Unicode ["+this.category+"] character"};class P{constructor(e,t,r){if("description"!==(n=r)&&"string"!==n&&"code"!==n)throw new Error("invalid Failure type: "+r);var n;this.pexpr=e,this.text=t,this.type=r,this.fluffy=!1}getPExpr(){return this.pexpr}getText(){return this.text}getType(){return this.type}isDescription(){return"description"===this.type}isStringTerminal(){return"string"===this.type}isCode(){return"code"===this.type}isFluffy(){return this.fluffy}makeFluffy(){this.fluffy=!0}clearFluffy(){this.fluffy=!1}subsumes(e){return this.getText()===e.getText()&&this.type===e.type&&(!this.isFluffy()||this.isFluffy()&&e.isFluffy())}toString(){return"string"===this.type?JSON.stringify(this.getText()):this.getText()}clone(){var e=new P(this.pexpr,this.text,this.type);return this.isFluffy()&&e.makeFluffy(),e}toKey(){return this.toString()+"#"+this.type}}n.prototype.toFailure=t("toFailure"),r.toFailure=function(e){return new P(this,"any object","description")},i.toFailure=function(e){return new P(this,"end of input","description")},p.prototype.toFailure=function(e){return new P(this,this.obj,"string")},s.prototype.toFailure=function(e){return new P(this,JSON.stringify(this.from)+".."+JSON.stringify(this.to),"code")},_.prototype.toFailure=function(e){e=this.expr===r?"nothing":"not "+this.expr.toFailure(e);return new P(this,e,"description")},I.prototype.toFailure=function(e){return this.expr.toFailure(e)},b.prototype.toFailure=function(e){let t=e.rules[this.ruleName]["description"];return t||(e=/^[aeiouAEIOU]/.test(this.ruleName)?"an":"a",t=e+" "+this.ruleName),new P(this,t,"description")},w.prototype.toFailure=function(e){return new P(this,"a Unicode ["+this.category+"] character","description")},o.prototype.toFailure=function(t){var e="("+this.terms.map(e=>e.toFailure(t)).join(" or ")+")";return new P(this,e,"description")},h.prototype.toFailure=function(t){var e="("+this.factors.map(e=>e.toFailure(t)).join(" ")+")";return new P(this,e,"description")},f.prototype.toFailure=function(e){e="("+this.expr.toFailure(e)+this.operator+")";return new P(this,e,"description")},n.prototype.toString=t("toString"),r.toString=function(){return"any"},i.toString=function(){return"end"},p.prototype.toString=function(){return JSON.stringify(this.obj)},s.prototype.toString=function(){return JSON.stringify(this.from)+".."+JSON.stringify(this.to)},a.prototype.toString=function(){return"$"+this.index},x.prototype.toString=function(){return"#("+this.expr.toString()+")"},o.prototype.toString=function(){return 1===this.terms.length?this.terms[0].toString():"("+this.terms.map(e=>e.toString()).join(" | ")+")"},h.prototype.toString=function(){return 1===this.factors.length?this.factors[0].toString():"("+this.factors.map(e=>e.toString()).join(" ")+")"},f.prototype.toString=function(){return this.expr+this.operator},_.prototype.toString=function(){return"~"+this.expr},I.prototype.toString=function(){return"&"+this.expr},b.prototype.toString=function(){var e;return 0<this.args.length?(e=this.args.map(e=>e.toString()),this.ruleName+"<"+e.join(",")+">"):this.ruleName},w.prototype.toString=function(){return"\\p{"+this.category+"}"};class Oe extends n{constructor(e){super(),this.obj=e}_getString(e){e=e.currentApplication().args[this.obj.index];return m(e instanceof p,"expected a Terminal expression"),e.obj}allowsSkippingPrecedingSpace(){return!0}eval(e){var t=e["inputStream"],r=t.pos,n=this._getString(e);return t.matchString(n,!0)?(e.pushBinding(new L(n.length),r),!0):(e.processFailure(r,this),!1)}getArity(){return 1}substituteParams(e){return new Oe(this.obj.substituteParams(e))}toDisplayString(){return this.obj.toDisplayString()+" (case-insensitive)"}toFailure(e){return new P(this,this.obj.toFailure(e)+" (case-insensitive)","description")}_isNullable(e,t){return this.obj._isNullable(e,t)}}var Le=Object.freeze({__proto__:null,CaseInsensitiveTerminal:Oe,PExpr:n,any:r,end:i,Terminal:p,Range:s,Param:a,Alt:o,Extend:l,Splice:c,Seq:h,Iter:f,Star:g,Plus:y,Opt:v,Not:_,Lookahead:I,Lex:x,Apply:b,UnicodeChar:w});let Ee;le(e=>{Ee=e.rules.applySyntactic.body});const Pe=new b("spaces");class Re{constructor(e,t,r){this.matcher=e,this.startExpr=t,this.grammar=e.grammar,this.input=e.getInput(),this.inputStream=new he(this.input),this.memoTable=e._memoTable,this.userData=void 0,this.doNotMemoize=!1,this._bindings=[],this._bindingOffsets=[],this._applicationStack=[],this._posStack=[0],this.inLexifiedContextStack=[!1],this.rightmostFailurePosition=-1,this._rightmostFailurePositionStack=[],this._recordedFailuresStack=[],void 0!==r&&(this.positionToRecordFailures=r,this.recordedFailures=Object.create(null))}posToOffset(e){return e-this._posStack[this._posStack.length-1]}enterApplication(e,t){this._posStack.push(this.inputStream.pos),this._applicationStack.push(t),this.inLexifiedContextStack.push(!1),e.enter(t),this._rightmostFailurePositionStack.push(this.rightmostFailurePosition),this.rightmostFailurePosition=-1}exitApplication(e,t){var r=this._posStack.pop();this._applicationStack.pop(),this.inLexifiedContextStack.pop(),e.exit(),this.rightmostFailurePosition=Math.max(this.rightmostFailurePosition,this._rightmostFailurePositionStack.pop()),t&&this.pushBinding(t,r)}enterLexifiedContext(){this.inLexifiedContextStack.push(!0)}exitLexifiedContext(){this.inLexifiedContextStack.pop()}currentApplication(){return this._applicationStack[this._applicationStack.length-1]}inSyntacticContext(){var e=this.currentApplication();return e?e.isSyntactic()&&!this.inLexifiedContext():this.startExpr.factors[0].isSyntactic()}inLexifiedContext(){return this.inLexifiedContextStack[this.inLexifiedContextStack.length-1]}skipSpaces(){return this.pushFailuresInfo(),this.eval(Pe),this.popBinding(),this.popFailuresInfo(),this.inputStream.pos}skipSpacesIfInSyntacticContext(){return this.inSyntacticContext()?this.skipSpaces():this.inputStream.pos}maybeSkipSpacesBefore(e){return e.allowsSkippingPrecedingSpace()&&e!==Pe?this.skipSpacesIfInSyntacticContext():this.inputStream.pos}pushBinding(e,t){this._bindings.push(e),this._bindingOffsets.push(this.posToOffset(t))}popBinding(){this._bindings.pop(),this._bindingOffsets.pop()}numBindings(){return this._bindings.length}truncateBindings(e){for(;this._bindings.length>e;)this.popBinding()}getCurrentPosInfo(){return this.getPosInfo(this.inputStream.pos)}getPosInfo(e){let t=this.memoTable[e];return t=t||(this.memoTable[e]=new de)}processFailure(e,t){this.rightmostFailurePosition=Math.max(this.rightmostFailurePosition,e),this.recordedFailures&&e===this.positionToRecordFailures&&((e=this.currentApplication())&&(t=t.substituteParams(e.args)),this.recordFailure(t.toFailure(this.grammar),!1))}recordFailure(e,t){var r=e.toKey();this.recordedFailures[r]?this.recordedFailures[r].isFluffy()&&!e.isFluffy()&&this.recordedFailures[r].clearFluffy():this.recordedFailures[r]=t?e.clone():e}recordFailures(t,r){Object.keys(t).forEach(e=>{this.recordFailure(t[e],r)})}cloneRecordedFailures(){if(this.recordedFailures){const t=Object.create(null);return Object.keys(this.recordedFailures).forEach(e=>{t[e]=this.recordedFailures[e].clone()}),t}}getRightmostFailurePosition(){return this.rightmostFailurePosition}_getRightmostFailureOffset(){return 0<=this.rightmostFailurePosition?this.posToOffset(this.rightmostFailurePosition):-1}getMemoizedTraceEntry(e,t){e=this.memoTable[e];if(e&&t instanceof b){var e=e.memo[t.toMemoKey()];if(e&&e.traceEntry)return(e=e.traceEntry.cloneWithExpr(t)).isMemoized=!0,e}return null}getTraceEntry(e,t,r,n){var i;return t instanceof b&&(i=(i=this.currentApplication())?i.args:[],t=t.substituteParams(i)),this.getMemoizedTraceEntry(e,t)||new N(this.input,e,this.inputStream.pos,t,r,n,this.trace)}isTracing(){return!!this.trace}hasNecessaryInfo(e){return!(this.trace&&!e.traceEntry||this.recordedFailures&&this.inputStream.pos+e.rightmostFailureOffset===this.positionToRecordFailures&&!e.failuresAtRightmostPosition)}useMemoizedResult(e,t){this.trace&&this.trace.push(t.traceEntry);var r=this.inputStream.pos+t.rightmostFailureOffset;return this.rightmostFailurePosition=Math.max(this.rightmostFailurePosition,r),this.recordedFailures&&this.positionToRecordFailures===r&&t.failuresAtRightmostPosition&&this.recordFailures(t.failuresAtRightmostPosition,!0),this.inputStream.examinedLength=Math.max(this.inputStream.examinedLength,t.examinedLength+e),!!t.value&&(this.inputStream.pos+=t.matchLength,this.pushBinding(t.value,e),!0)}eval(e){var t=this["inputStream"],r=this._bindings.length,n=this.userData;let i;this.recordedFailures&&(i=this.recordedFailures,this.recordedFailures=Object.create(null));var s=t.pos,a=this.maybeSkipSpacesBefore(e);let o;this.trace&&(o=this.trace,this.trace=[]);var l,u=e.eval(this);return this.trace&&(l=this._bindings.slice(r),(a=this.getTraceEntry(a,e,u,l)).isImplicitSpaces=e===Pe,a.isRootNode=e===this.startExpr,o.push(a),this.trace=o),u?this.recordedFailures&&t.pos===this.positionToRecordFailures&&Object.keys(this.recordedFailures).forEach(e=>{this.recordedFailures[e].makeFluffy()}):(t.pos=s,this.truncateBindings(r),this.userData=n),this.recordedFailures&&this.recordFailures(i,!1),e===Ee&&this.skipSpaces(),u}getMatchResult(){this.grammar._setUpMatchState(this),this.eval(this.startExpr);let e;this.recordedFailures&&(e=Object.keys(this.recordedFailures).map(e=>this.recordedFailures[e]));var t=this._bindings[0];return t&&(t.grammar=this.grammar),new me(this.matcher,this.input,this.startExpr,t,this._bindingOffsets[0],this.rightmostFailurePosition,e)}getTrace(){this.trace=[];var e=this.getMatchResult(),t=this.trace[this.trace.length-1];return t.result=e,t}pushFailuresInfo(){this._rightmostFailurePositionStack.push(this.rightmostFailurePosition),this._recordedFailuresStack.push(this.recordedFailures)}popFailuresInfo(){this.rightmostFailurePosition=this._rightmostFailurePositionStack.pop(),this.recordedFailures=this._recordedFailuresStack.pop()}}class Fe{constructor(e){this.grammar=e,this._memoTable=[],this._input="",this._isMemoTableStale=!1}_resetMemoTable(){this._memoTable=[],this._isMemoTableStale=!1}getInput(){return this._input}setInput(e){return this._input!==e&&this.replaceInputRange(0,this._input.length,e),this}replaceInputRange(t,e,r){var n=this._input,i=this._memoTable;if(t<0||t>n.length||e<0||e>n.length||e<t)throw new Error("Invalid indices: "+t+" and "+e);this._input=n.slice(0,t)+r+n.slice(e),this._input!==n&&0<i.length&&(this._isMemoTableStale=!0);n=i.slice(e);i.length=t;for(let e=0;e<r.length;e++)i.push(void 0);for(const a of n)i.push(a);for(let e=0;e<t;e++){var s=i[e];s&&s.clearObsoleteEntries(e,t)}return this}match(e,t={incremental:!0}){return this._match(this._getStartExpr(e),{incremental:t.incremental,tracing:!1})}trace(e,t={incremental:!0}){return this._match(this._getStartExpr(e),{incremental:t.incremental,tracing:!0})}_match(e,t={}){t={tracing:!1,incremental:!0,positionToRecordFailures:void 0,...t};if(t.incremental){if(this._isMemoTableStale&&!this.grammar.supportsIncrementalParsing)throw S(`Grammar '${this.grammar.name}' does not support incremental parsing`)}else this._resetMemoTable();e=new Re(this,e,t.positionToRecordFailures);return t.tracing?e.getTrace():e.getMatchResult()}_getStartExpr(e){var e=e||this.grammar.defaultStartRule;if(e)return e=this.grammar.parseApplication(e),new h([e,i]);throw new Error("Missing start rule argument -- the grammar has no default start rule.")}}const R=[],ke=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);class Ce{constructor(e,t,r){this._node=e,this.source=t,this._baseInterval=r,e.isNonterminal()&&m(t===r),this._childWrappers=[]}_forgetMemoizedResultFor(t){delete this._node[this._semantics.attributeKeys[t]],this.children.forEach(e=>{e._forgetMemoizedResultFor(t)})}child(t){if(0<=t&&t<this._node.numChildren()){let e=this._childWrappers[t];var r,n,i;return e||(r=this._node.childAt(t),n=this._node.childOffsets[t],n=this._baseInterval.subInterval(n,r.matchLength),i=r.isNonterminal()?n:this._baseInterval,e=this._childWrappers[t]=this._semantics.wrap(r,n,i)),e}}_children(){for(let e=0;e<this._node.numChildren();e++)this.child(e);return this._childWrappers}isIteration(){return this._node.isIteration()}isTerminal(){return this._node.isTerminal()}isNonterminal(){return this._node.isNonterminal()}isSyntactic(){return this.isNonterminal()&&this._node.isSyntactic()}isLexical(){return this.isNonterminal()&&this._node.isLexical()}isOptional(){return this._node.isOptional()}iteration(e){var e=e||[],t=e.map(e=>e._node),t=new Se(t,[],-1,!1),t=this._semantics.wrap(t,null,null);return t._childWrappers=e,t}get children(){return this._children()}get ctorName(){return this._node.ctorName}get numChildren(){return this._node.numChildren()}get sourceString(){return this.source.contents}}class F{constructor(e,t){const n=this;if(this.grammar=e,this.checkedActionDicts=!1,this.Wrapper=class extends(t?t.Wrapper:Ce){constructor(e,t,r){super(e,t,r),n.checkActionDictsIfHaventAlready(),this._semantics=n}toString(){return"[semantics wrapper for "+n.grammar.name+"]"}},this.super=t){if(!e.equals(this.super.grammar)&&!e._inheritsFrom(this.super.grammar))throw new Error("Cannot extend a semantics for grammar '"+this.super.grammar.name+"' for use with grammar '"+e.name+"' (not a sub-grammar)");this.operations=Object.create(this.super.operations),this.attributes=Object.create(this.super.attributes),this.attributeKeys=Object.create(null);for(const r in this.attributes)Object.defineProperty(this.attributeKeys,r,{value:ce(r)})}else this.operations=Object.create(null),this.attributes=Object.create(null),this.attributeKeys=Object.create(null)}toString(){return"[semantics for "+this.grammar.name+"]"}checkActionDictsIfHaventAlready(){this.checkedActionDicts||(this.checkActionDicts(),this.checkedActionDicts=!0)}checkActionDicts(){let e;for(e in this.operations)this.operations[e].checkActionDict(this.grammar);for(e in this.attributes)this.attributes[e].checkActionDict(this.grammar)}toRecipe(e){function u(e){return e.super!==F.BuiltInSemantics._getSemantics()}let p="(function(g) {\n";if(u(this)){p+="  var semantics = "+this.super.toRecipe(!0)+"(g";var t=this.super.grammar;let e=this.grammar;for(;e!==t;)p+=".superGrammar",e=e.superGrammar;p=p+");\n"+"  return g.extendSemantics(semantics)"}else p+="  return g.createSemantics()";return["Operation","Attribute"].forEach(o=>{const l=this[o.toLowerCase()+"s"];Object.keys(l).forEach(e=>{const{actionDict:r,formals:t,builtInDefault:n}=l[e];let i=e;0<t.length&&(i+="("+t.join(", ")+")");let s;s=u(this)&&this.super[o.toLowerCase()+"s"][e]?"extend"+o:"add"+o,p+="\n    ."+s+"("+JSON.stringify(i)+", {";const a=[];Object.keys(r).forEach(t=>{if(r[t]!==n){let e=r[t].toString().trim();e=e.replace(/^.*\(/,"function("),a.push("\n      "+JSON.stringify(t)+": "+e)}}),p+=a.join(",")+"\n    })"})}),p+=";\n  })",p=e?p:"(function() {\n  var grammar = this.fromRecipe("+this.grammar.toRecipe()+");\n  var semantics = "+p+"(grammar);\n  return semantics;\n});\n"}addOperationOrAttribute(a,e,t){const o=a+"s";e=Me(e,a);const l=e["name"];function r(...e){var t=(this._semantics.operations[i]||this._semantics.attributes[i]).formals.map(e=>this.args[e]);if(this.isIteration()||1!==e.length)throw function(e,t,r,n){n=n.slice(0,-1).map(e=>{var t="  "+e[0].name+" > "+e[1];return 3===e.length?t+" for '"+e[2]+"'":t}).join("\n"),n+="\n  "+t+" > "+e;let i="";return(r=S([`Missing semantic action for '${e}' in ${r} '${t}'.`+(i="_iter"===e?["\nNOTE: as of Ohm v16, there is no default action for iteration nodes — see ","  https://ohmjs.org/d/dsa for details."].join("\n"):i),"Action stack (most recent call last):",n].join("\n"))).name="missingSemanticAction",r}(this.ctorName,i,n,R);return s.apply(e[0],t)}var n,i,s,e=e["formals"];this.assertNewName(l,a),n=a,i=l,s=p;const u={_default:r};Object.keys(t).forEach(e=>{u[e]=t[e]});e="operation"===a?new De(l,e,u,r):new je(l,u,r);function p(...e){var t=this._semantics[o][l];if(arguments.length!==t.formals.length)throw new Error("Invalid number of arguments passed to "+l+" "+a+" (expected "+t.formals.length+", got "+arguments.length+")");var r,n,i=Object.create(null);for([r,n]of Object.entries(e))i[t.formals[r]]=n;var e=this.args,s=(this.args=i,t.execute(this._semantics,this));return this.args=e,s}e.checkActionDict(this.grammar),this[o][l]=e,"operation"===a?(this.Wrapper.prototype[l]=p,this.Wrapper.prototype[l].toString=function(){return"["+l+" operation]"}):(Object.defineProperty(this.Wrapper.prototype,l,{get:p,configurable:!0}),Object.defineProperty(this.attributeKeys,l,{value:ce(l)}))}extendOperationOrAttribute(e,t,r){var n=e+"s";if(Me(t,"attribute"),!(this.super&&t in this.super[n]))throw new Error("Cannot extend "+e+" '"+t+"': did not inherit an "+e+" with that name");if(ke(this[n],t))throw new Error("Cannot extend "+e+" '"+t+"' again");var i=this[n][t].formals,s=this[n][t].actionDict;const a=Object.create(s);Object.keys(r).forEach(e=>{a[e]=r[e]}),this[n][t]="operation"===e?new De(t,i,a):new je(t,a),this[n][t].checkActionDict(this.grammar)}assertNewName(e,t){if(ke(Ce.prototype,e))throw new Error("Cannot add "+t+" '"+e+"': that's a reserved name");if(e in this.operations)throw new Error("Cannot add "+t+" '"+e+"': an operation with that name already exists");if(e in this.attributes)throw new Error("Cannot add "+t+" '"+e+"': an attribute with that name already exists")}wrap(e,t,r){r=r||t;return e instanceof this.Wrapper?e:new this.Wrapper(e,t,r)}}function Me(e,t){if(!F.prototypeGrammar)return m(-1===e.indexOf("(")),{name:e,formals:[]};e=F.prototypeGrammar.match(e,"operation"===t?"OperationSignature":"AttributeSignature");if(e.failed())throw new Error(e.message);return F.prototypeGrammarSemantics(e).parse()}F.createSemantics=function(n,e){function r(e){if(!(e instanceof me))throw new TypeError("Semantics expected a MatchResult, but got "+J(e));if(e.failed())throw new TypeError("cannot apply Semantics to "+e.toString());var t=e._cst;if(t.grammar!==n)throw new Error("Cannot use a MatchResult from grammar '"+t.grammar.name+"' with a semantics for '"+n.name+"'");var r=new he(e.input);return i.wrap(t,r.interval(e._cstOffset,e.input.length))}const i=new F(n,void 0!==e?e:F.BuiltInSemantics._getSemantics());return r.addOperation=function(e,t){return i.addOperationOrAttribute("operation",e,t),r},r.extendOperation=function(e,t){return i.extendOperationOrAttribute("operation",e,t),r},r.addAttribute=function(e,t){return i.addOperationOrAttribute("attribute",e,t),r},r.extendAttribute=function(e,t){return i.extendOperationOrAttribute("attribute",e,t),r},r._getActionDict=function(e){var t=i.operations[e]||i.attributes[e];if(t)return t.actionDict;throw new Error('"'+e+'" is not a valid operation or attribute name in this semantics for "'+n.name+'"')},r._remove=function(e){let t;return e in i.operations?(t=i.operations[e],delete i.operations[e]):e in i.attributes&&(t=i.attributes[e],delete i.attributes[e]),delete i.Wrapper.prototype[e],t},r.getOperationNames=function(){return Object.keys(i.operations)},r.getAttributeNames=function(){return Object.keys(i.attributes)},r.getGrammar=function(){return i.grammar},r.toRecipe=function(e){return i.toRecipe(e)},r.toString=i.toString.bind(i),r._getSemantics=function(){return i},r};class De{constructor(e,t,r,n){this.name=e,this.formals=t,this.actionDict=r,this.builtInDefault=n}checkActionDict(e){e._checkTopDownActionDict(this.typeName,this.name,this.actionDict)}execute(e,t){try{var r=t._node["ctorName"];let e=this.actionDict[r];return e?(R.push([this,r]),e.apply(t,t._children())):(t.isNonterminal()&&(e=this.actionDict._nonterminal)?(R.push([this,"_nonterminal",r]),e):(R.push([this,"default action",r]),this.actionDict._default)).apply(t,t._children())}finally{R.pop()}}}De.prototype.typeName="operation";class je extends De{constructor(e,t,r){super(e,[],t,r)}execute(e,t){var r=t._node,n=e.attributeKeys[this.name];return ke(r,n)||(r[n]=De.prototype.execute.call(this,e,t)),r[n]}}je.prototype.typeName="attribute";const Te=["_iter","_terminal","_nonterminal","_default"];function Be(t){return Object.keys(t.rules).sort().map(e=>t.rules[e])}let Ge,qe;class k{constructor(e,t,r,n){if(this.name=e,this.superGrammar=t,this.rules=r,n){if(!(n in r))throw new Error("Invalid start rule: '"+n+"' is not a rule in grammar '"+e+"'");this.defaultStartRule=n}this._matchStateInitializer=void 0,this.supportsIncrementalParsing=!0}matcher(){return new Fe(this)}isBuiltIn(){return this===k.ProtoBuiltInRules||this===k.BuiltInRules}equals(e){if(this===e)return!0;if(null==e||this.name!==e.name||this.defaultStartRule!==e.defaultStartRule||this.superGrammar!==e.superGrammar&&!this.superGrammar.equals(e.superGrammar))return!1;var t=Be(this);const r=Be(e);return t.length===r.length&&t.every((e,t)=>e.description===r[t].description&&e.formals.join(",")===r[t].formals.join(",")&&e.body.toString()===r[t].body.toString())}match(e,t){var r=this.matcher();return r.replaceInputRange(0,0,e),r.match(t)}trace(e,t){var r=this.matcher();return r.replaceInputRange(0,0,e),r.trace(t)}createSemantics(){return F.createSemantics(this)}extendSemantics(e){return F.createSemantics(this,e._getSemantics())}_checkTopDownActionDict(e,t,r){var n,i=[];for(const o in r){var s=r[o];if(Te.includes(o)||o in this.rules)if("function"!=typeof s)i.push(`'${o}' must be a function in an action dictionary for '${this.name}'`);else{var s=s.length,a=this._topDownActionArity(o);if(s!==a){let e;e="_iter"===o||"_nonterminal"===o?`it should use a rest parameter, e.g. \`${o}(...children) {}\`. `+"NOTE: this is new in Ohm v16 — see https://ohmjs.org/d/ati for details.":`expected ${a}, got `+s,i.push(`Semantic action '${o}' has the wrong arity: `+e)}}else i.push(`'${o}' is not a valid semantic action for '${this.name}'`)}if(0<i.length)throw n=i.map(e=>"- "+e),(t=new Error([`Found errors in the action dictionary of the '${t}' ${e}:`,...n].join("\n"))).problems=i,t}_topDownActionArity(e){return Te.includes(e)?0:this.rules[e].body.getArity()}_inheritsFrom(e){let t=this.superGrammar;for(;t;){if(t.equals(e,!0))return!0;t=t.superGrammar}return!1}toRecipe(e=void 0){var t={};this.source&&(t.source=this.source.contents);let r=null;this.defaultStartRule&&(r=this.defaultStartRule);const o={};Object.keys(this.rules).forEach(e=>{var t=this.rules[e],r=t["body"],n=!this.superGrammar||!this.superGrammar.rules[e];let i;i=n?"define":r instanceof l?"extend":"override";var s={},a=(t.source&&this.source&&(a=t.source.relativeTo(this.source),s.sourceInterval=[a.startIdx,a.endIdx]),n?t.description:null),n=r.outputRecipe(t.formals,this.source);o[e]=[i,s,a,t.formals,n]});let n="null";return e?n=e:this.superGrammar&&!this.superGrammar.isBuiltIn()&&(n=this.superGrammar.toRecipe()),`[${[...["grammar",t,this.name].map(JSON.stringify),n,...[r,o].map(JSON.stringify)].join(",")}]`.replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}toOperationActionDictionaryTemplate(){return this._toOperationOrAttributeActionDictionaryTemplate()}toAttributeActionDictionaryTemplate(){return this._toOperationOrAttributeActionDictionaryTemplate()}_toOperationOrAttributeActionDictionaryTemplate(){var e=new d;e.append("{");let t=!0;for(const n in this.rules){var r=this.rules[n]["body"];t?t=!1:e.append(","),e.append("\n"),e.append("  "),this.addSemanticActionTemplate(n,r,e)}return e.append("\n}"),e.contents()}addSemanticActionTemplate(e,t,r){r.append(e),r.append(": function(");e=this._topDownActionArity(e);r.append(G("_",e).join(", ")),r.append(") {\n"),r.append("  }")}parseApplication(e){let t;if(!((t=-1===e.indexOf("<")?new b(e):(e=Ge.match(e,"Base_application"),qe(e,{}))).ruleName in this.rules))throw Z(t.ruleName,this.name);var r,e=this.rules[t.ruleName]["formals"];if(e.length!==t.args.length)throw r=this.rules[t.ruleName]["source"],X(t.ruleName,e.length,t.args.length,r);return t}_setUpMatchState(e){this._matchStateInitializer&&this._matchStateInitializer(e)}}k.ProtoBuiltInRules=new k("ProtoBuiltInRules",void 0,{any:{body:r,formals:[],description:"any character",primitive:!0},end:{body:i,formals:[],description:"end of input",primitive:!0},caseInsensitive:{body:new Oe(new a(0)),formals:["str"],primitive:!0},lower:{body:new w("Ll"),formals:[],description:"a lowercase letter",primitive:!0},upper:{body:new w("Lu"),formals:[],description:"an uppercase letter",primitive:!0},unicodeLtmo:{body:new w("Ltmo"),formals:[],description:"a Unicode character in Lt, Lm, or Lo",primitive:!0},spaces:{body:new g(new b("space")),formals:[]},space:{body:new s("\0"," "),formals:[],description:"a space"}}),k.initApplicationParser=function(e,t){Ge=e,qe=t};class ze{constructor(e){this.name=e}sourceInterval(e,t){return this.source.subInterval(e,t-e)}ensureSuperGrammar(){return this.superGrammar||this.withSuperGrammar("BuiltInRules"===this.name?k.ProtoBuiltInRules:k.BuiltInRules),this.superGrammar}ensureSuperGrammarRuleForOverriding(e,t){var r=this.ensureSuperGrammar().rules[e];if(r)return r;throw r=this.superGrammar.name,S("Cannot override rule "+e+" because it is not declared in "+r,t)}installOverriddenOrExtendedRule(e,t,r,n){var i=q(t);if(0<i.length)throw ee(e,i,n);var i=this.ensureSuperGrammar().rules[e],s=i.formals,s=s?s.length:0;if(t.length!==s)throw X(e,s,t.length,n);return this.install(e,t,r,i.description,n)}install(e,t,r,n,i,s=!1){return this.rules[e]={body:r.introduceParams(t),formals:t,description:n,source:i,primitive:s},this}withSuperGrammar(e){if(this.superGrammar)throw new Error("the super grammar of a GrammarDecl cannot be set more than once");return this.superGrammar=e,this.rules=Object.create(e.rules),e.isBuiltIn()||(this.defaultStartRule=e.defaultStartRule),this}withDefaultStartRule(e){return this.defaultStartRule=e,this}withSource(e){return this.source=new he(e).interval(0,e.length),this}build(){const r=new k(this.name,this.ensureSuperGrammar(),this.rules,this.defaultStartRule),n=(r._matchStateInitializer=r.superGrammar._matchStateInitializer,r.supportsIncrementalParsing=r.superGrammar.supportsIncrementalParsing,[]);let i=!1;return Object.keys(r.rules).forEach(e=>{var t=r.rules[e]["body"];try{t.assertChoicesHaveUniformArity(e)}catch(e){n.push(e)}try{t.assertAllApplicationsAreValid(e,r)}catch(e){n.push(e),i=!0}}),i||Object.keys(r.rules).forEach(e=>{e=r.rules[e].body;try{e.assertIteratedExprsAreNotNullable(r,[])}catch(e){n.push(e)}}),0<n.length&&ie(n),this.source&&(r.source=this.source),r}define(e,t,r,n,i,s){if(this.ensureSuperGrammar(),this.superGrammar.rules[e])throw Y(e,this.name,this.superGrammar.name,i);if(this.rules[e])throw Y(e,this.name,this.name,i);var a=q(t);if(0<a.length)throw ee(e,a,i);return this.install(e,t,r,n,i,s)}override(e,t,r,n,i){return this.ensureSuperGrammarRuleForOverriding(e,i),this.installOverriddenOrExtendedRule(e,t,r,i),this}extend(e,t,r,n,i){var s;if(this.ensureSuperGrammar().rules[e])return(s=new l(this.superGrammar,e,r)).source=r.source,this.installOverriddenOrExtendedRule(e,t,s,i),this;throw r=this.superGrammar.name,S("Cannot extend rule "+e+" because it is not declared in "+r,i)}}class $e{constructor(){this.currentDecl=null,this.currentRuleName=null}newGrammar(e){return new ze(e)}grammar(e,t,r,n,o){const l=new ze(t);return r&&l.withSuperGrammar(r instanceof k?r:this.fromRecipe(r)),n&&l.withDefaultStartRule(n),e&&e.source&&l.withSource(e.source),this.currentDecl=l,Object.keys(o).forEach(e=>{this.currentRuleName=e;var t=o[e],r=t[0],n=t[1],i=t[2],s=t[3],t=this.fromRecipe(t[4]);let a;l.source&&n&&n.sourceInterval&&(a=l.source.subInterval(n.sourceInterval[0],n.sourceInterval[1]-n.sourceInterval[0])),l[r](e,s,t,i,a)}),this.currentRuleName=this.currentDecl=null,l.build()}terminal(e){return new p(e)}range(e,t){return new s(e,t)}param(e){return new a(e)}alt(...e){let t=[];for(var r of e)(r=r instanceof n?r:this.fromRecipe(r))instanceof o?t=t.concat(r.terms):t.push(r);return 1===t.length?t[0]:new o(t)}seq(...e){let t=[];for(var r of e)(r=r instanceof n?r:this.fromRecipe(r))instanceof h?t=t.concat(r.factors):t.push(r);return 1===t.length?t[0]:new h(t)}star(e){return e instanceof n||(e=this.fromRecipe(e)),new g(e)}plus(e){return e instanceof n||(e=this.fromRecipe(e)),new y(e)}opt(e){return e instanceof n||(e=this.fromRecipe(e)),new v(e)}not(e){return e instanceof n||(e=this.fromRecipe(e)),new _(e)}lookahead(e){return e instanceof n||(e=this.fromRecipe(e)),new I(e)}lex(e){return e instanceof n||(e=this.fromRecipe(e)),new x(e)}app(e,t){return t&&0<t.length&&(t=t.map(function(e){return e instanceof n?e:this.fromRecipe(e)},this)),new b(e,t)}splice(e,t){return new c(this.currentDecl.superGrammar,this.currentRuleName,e.map(e=>this.fromRecipe(e)),t.map(e=>this.fromRecipe(e)))}fromRecipe(e){var t="grammar"===e[0]?e.slice(1):e.slice(2),t=this[e[0]](...t),e=e[1];return e&&e.sourceInterval&&this.currentDecl&&t.withSource(this.currentDecl.sourceInterval(...e.sourceInterval)),t}}function Ue(e){return"function"==typeof e?e.call(new $e):("string"==typeof e&&(e=JSON.parse(e)),(new $e).fromRecipe(e))}var Ke,Ve=Ue(["grammar",{source:'BuiltInRules {\n\n  alnum  (an alpha-numeric character)\n    = letter\n    | digit\n\n  letter  (a letter)\n    = lower\n    | upper\n    | unicodeLtmo\n\n  digit  (a digit)\n    = "0".."9"\n\n  hexDigit  (a hexadecimal digit)\n    = digit\n    | "a".."f"\n    | "A".."F"\n\n  ListOf<elem, sep>\n    = NonemptyListOf<elem, sep>\n    | EmptyListOf<elem, sep>\n\n  NonemptyListOf<elem, sep>\n    = elem (sep elem)*\n\n  EmptyListOf<elem, sep>\n    = /* nothing */\n\n  listOf<elem, sep>\n    = nonemptyListOf<elem, sep>\n    | emptyListOf<elem, sep>\n\n  nonemptyListOf<elem, sep>\n    = elem (sep elem)*\n\n  emptyListOf<elem, sep>\n    = /* nothing */\n\n  // Allows a syntactic rule application within a lexical context.\n  applySyntactic<app> = app\n}'},"BuiltInRules",null,null,{alnum:["define",{sourceInterval:[18,78]},"an alpha-numeric character",[],["alt",{sourceInterval:[60,78]},["app",{sourceInterval:[60,66]},"letter",[]],["app",{sourceInterval:[73,78]},"digit",[]]]],letter:["define",{sourceInterval:[82,142]},"a letter",[],["alt",{sourceInterval:[107,142]},["app",{sourceInterval:[107,112]},"lower",[]],["app",{sourceInterval:[119,124]},"upper",[]],["app",{sourceInterval:[131,142]},"unicodeLtmo",[]]]],digit:["define",{sourceInterval:[146,177]},"a digit",[],["range",{sourceInterval:[169,177]},"0","9"]],hexDigit:["define",{sourceInterval:[181,254]},"a hexadecimal digit",[],["alt",{sourceInterval:[219,254]},["app",{sourceInterval:[219,224]},"digit",[]],["range",{sourceInterval:[231,239]},"a","f"],["range",{sourceInterval:[246,254]},"A","F"]]],ListOf:["define",{sourceInterval:[258,336]},null,["elem","sep"],["alt",{sourceInterval:[282,336]},["app",{sourceInterval:[282,307]},"NonemptyListOf",[["param",{sourceInterval:[297,301]},0],["param",{sourceInterval:[303,306]},1]]],["app",{sourceInterval:[314,336]},"EmptyListOf",[["param",{sourceInterval:[326,330]},0],["param",{sourceInterval:[332,335]},1]]]]],NonemptyListOf:["define",{sourceInterval:[340,388]},null,["elem","sep"],["seq",{sourceInterval:[372,388]},["param",{sourceInterval:[372,376]},0],["star",{sourceInterval:[377,388]},["seq",{sourceInterval:[378,386]},["param",{sourceInterval:[378,381]},1],["param",{sourceInterval:[382,386]},0]]]]],EmptyListOf:["define",{sourceInterval:[392,434]},null,["elem","sep"],["seq",{sourceInterval:[438,438]}]],listOf:["define",{sourceInterval:[438,516]},null,["elem","sep"],["alt",{sourceInterval:[462,516]},["app",{sourceInterval:[462,487]},"nonemptyListOf",[["param",{sourceInterval:[477,481]},0],["param",{sourceInterval:[483,486]},1]]],["app",{sourceInterval:[494,516]},"emptyListOf",[["param",{sourceInterval:[506,510]},0],["param",{sourceInterval:[512,515]},1]]]]],nonemptyListOf:["define",{sourceInterval:[520,568]},null,["elem","sep"],["seq",{sourceInterval:[552,568]},["param",{sourceInterval:[552,556]},0],["star",{sourceInterval:[557,568]},["seq",{sourceInterval:[558,566]},["param",{sourceInterval:[558,561]},1],["param",{sourceInterval:[562,566]},0]]]]],emptyListOf:["define",{sourceInterval:[572,682]},null,["elem","sep"],["seq",{sourceInterval:[685,685]}]],applySyntactic:["define",{sourceInterval:[685,710]},null,["app"],["param",{sourceInterval:[707,710]},0]]}]),Je=(k.BuiltInRules=Ve,Ke=k.BuiltInRules,oe.forEach(e=>{e(Ke)}),Ue(["grammar",{source:'Ohm {\n\n  Grammars\n    = Grammar*\n\n  Grammar\n    = ident SuperGrammar? "{" Rule* "}"\n\n  SuperGrammar\n    = "<:" ident\n\n  Rule\n    = ident Formals? ruleDescr? "="  RuleBody  -- define\n    | ident Formals?            ":=" OverrideRuleBody  -- override\n    | ident Formals?            "+=" RuleBody  -- extend\n\n  RuleBody\n    = "|"? NonemptyListOf<TopLevelTerm, "|">\n\n  TopLevelTerm\n    = Seq caseName  -- inline\n    | Seq\n\n  OverrideRuleBody\n    = "|"? NonemptyListOf<OverrideTopLevelTerm, "|">\n\n  OverrideTopLevelTerm\n    = "..."  -- superSplice\n    | TopLevelTerm\n\n  Formals\n    = "<" ListOf<ident, ","> ">"\n\n  Params\n    = "<" ListOf<Seq, ","> ">"\n\n  Alt\n    = NonemptyListOf<Seq, "|">\n\n  Seq\n    = Iter*\n\n  Iter\n    = Pred "*"  -- star\n    | Pred "+"  -- plus\n    | Pred "?"  -- opt\n    | Pred\n\n  Pred\n    = "~" Lex  -- not\n    | "&" Lex  -- lookahead\n    | Lex\n\n  Lex\n    = "#" Base  -- lex\n    | Base\n\n  Base\n    = ident Params? ~(ruleDescr? "=" | ":=" | "+=")  -- application\n    | oneCharTerminal ".." oneCharTerminal           -- range\n    | terminal                                       -- terminal\n    | "(" Alt ")"                                    -- paren\n\n  ruleDescr  (a rule description)\n    = "(" ruleDescrText ")"\n\n  ruleDescrText\n    = (~")" any)*\n\n  caseName\n    = "--" (~"\\n" space)* name (~"\\n" space)* ("\\n" | &"}")\n\n  name  (a name)\n    = nameFirst nameRest*\n\n  nameFirst\n    = "_"\n    | letter\n\n  nameRest\n    = "_"\n    | alnum\n\n  ident  (an identifier)\n    = name\n\n  terminal\n    = "\\"" terminalChar* "\\""\n\n  oneCharTerminal\n    = "\\"" terminalChar "\\""\n\n  terminalChar\n    = escapeChar\n      | ~"\\\\" ~"\\"" ~"\\n" "\\u{0}".."\\u{10FFFF}"\n\n  escapeChar  (an escape sequence)\n    = "\\\\\\\\"                                     -- backslash\n    | "\\\\\\""                                     -- doubleQuote\n    | "\\\\\\\'"                                     -- singleQuote\n    | "\\\\b"                                      -- backspace\n    | "\\\\n"                                      -- lineFeed\n    | "\\\\r"                                      -- carriageReturn\n    | "\\\\t"                                      -- tab\n    | "\\\\u{" hexDigit hexDigit? hexDigit?\n             hexDigit? hexDigit? hexDigit? "}"   -- unicodeCodePoint\n    | "\\\\u" hexDigit hexDigit hexDigit hexDigit  -- unicodeEscape\n    | "\\\\x" hexDigit hexDigit                    -- hexEscape\n\n  space\n   += comment\n\n  comment\n    = "//" (~"\\n" any)* &("\\n" | end)  -- singleLine\n    | "/*" (~"*/" any)* "*/"  -- multiLine\n\n  tokens = token*\n\n  token = caseName | comment | ident | operator | punctuation | terminal | any\n\n  operator = "<:" | "=" | ":=" | "+=" | "*" | "+" | "?" | "~" | "&"\n\n  punctuation = "<" | ">" | "," | "--"\n}'},"Ohm",oe=null,"Grammars",{Grammars:["define",{sourceInterval:[9,32]},null,[],["star",{sourceInterval:[24,32]},["app",{sourceInterval:[24,31]},"Grammar",[]]]],Grammar:["define",{sourceInterval:[36,83]},null,[],["seq",{sourceInterval:[50,83]},["app",{sourceInterval:[50,55]},"ident",[]],["opt",{sourceInterval:[56,69]},["app",{sourceInterval:[56,68]},"SuperGrammar",[]]],["terminal",{sourceInterval:[70,73]},"{"],["star",{sourceInterval:[74,79]},["app",{sourceInterval:[74,78]},"Rule",[]]],["terminal",{sourceInterval:[80,83]},"}"]]],SuperGrammar:["define",{sourceInterval:[87,116]},null,[],["seq",{sourceInterval:[106,116]},["terminal",{sourceInterval:[106,110]},"<:"],["app",{sourceInterval:[111,116]},"ident",[]]]],Rule_define:["define",{sourceInterval:[131,181]},null,[],["seq",{sourceInterval:[131,170]},["app",{sourceInterval:[131,136]},"ident",[]],["opt",{sourceInterval:[137,145]},["app",{sourceInterval:[137,144]},"Formals",[]]],["opt",{sourceInterval:[146,156]},["app",{sourceInterval:[146,155]},"ruleDescr",[]]],["terminal",{sourceInterval:[157,160]},"="],["app",{sourceInterval:[162,170]},"RuleBody",[]]]],Rule_override:["define",{sourceInterval:[188,248]},null,[],["seq",{sourceInterval:[188,235]},["app",{sourceInterval:[188,193]},"ident",[]],["opt",{sourceInterval:[194,202]},["app",{sourceInterval:[194,201]},"Formals",[]]],["terminal",{sourceInterval:[214,218]},":="],["app",{sourceInterval:[219,235]},"OverrideRuleBody",[]]]],Rule_extend:["define",{sourceInterval:[255,305]},null,[],["seq",{sourceInterval:[255,294]},["app",{sourceInterval:[255,260]},"ident",[]],["opt",{sourceInterval:[261,269]},["app",{sourceInterval:[261,268]},"Formals",[]]],["terminal",{sourceInterval:[281,285]},"+="],["app",{sourceInterval:[286,294]},"RuleBody",[]]]],Rule:["define",{sourceInterval:[120,305]},null,[],["alt",{sourceInterval:[131,305]},["app",{sourceInterval:[131,170]},"Rule_define",[]],["app",{sourceInterval:[188,235]},"Rule_override",[]],["app",{sourceInterval:[255,294]},"Rule_extend",[]]]],RuleBody:["define",{sourceInterval:[309,362]},null,[],["seq",{sourceInterval:[324,362]},["opt",{sourceInterval:[324,328]},["terminal",{sourceInterval:[324,327]},"|"]],["app",{sourceInterval:[329,362]},"NonemptyListOf",[["app",{sourceInterval:[344,356]},"TopLevelTerm",[]],["terminal",{sourceInterval:[358,361]},"|"]]]]],TopLevelTerm_inline:["define",{sourceInterval:[385,408]},null,[],["seq",{sourceInterval:[385,397]},["app",{sourceInterval:[385,388]},"Seq",[]],["app",{sourceInterval:[389,397]},"caseName",[]]]],TopLevelTerm:["define",{sourceInterval:[366,418]},null,[],["alt",{sourceInterval:[385,418]},["app",{sourceInterval:[385,397]},"TopLevelTerm_inline",[]],["app",{sourceInterval:[415,418]},"Seq",[]]]],OverrideRuleBody:["define",{sourceInterval:[422,491]},null,[],["seq",{sourceInterval:[445,491]},["opt",{sourceInterval:[445,449]},["terminal",{sourceInterval:[445,448]},"|"]],["app",{sourceInterval:[450,491]},"NonemptyListOf",[["app",{sourceInterval:[465,485]},"OverrideTopLevelTerm",[]],["terminal",{sourceInterval:[487,490]},"|"]]]]],OverrideTopLevelTerm_superSplice:["define",{sourceInterval:[522,543]},null,[],["terminal",{sourceInterval:[522,527]},"..."]],OverrideTopLevelTerm:["define",{sourceInterval:[495,562]},null,[],["alt",{sourceInterval:[522,562]},["app",{sourceInterval:[522,527]},"OverrideTopLevelTerm_superSplice",[]],["app",{sourceInterval:[550,562]},"TopLevelTerm",[]]]],Formals:["define",{sourceInterval:[566,606]},null,[],["seq",{sourceInterval:[580,606]},["terminal",{sourceInterval:[580,583]},"<"],["app",{sourceInterval:[584,602]},"ListOf",[["app",{sourceInterval:[591,596]},"ident",[]],["terminal",{sourceInterval:[598,601]},","]]],["terminal",{sourceInterval:[603,606]},">"]]],Params:["define",{sourceInterval:[610,647]},null,[],["seq",{sourceInterval:[623,647]},["terminal",{sourceInterval:[623,626]},"<"],["app",{sourceInterval:[627,643]},"ListOf",[["app",{sourceInterval:[634,637]},"Seq",[]],["terminal",{sourceInterval:[639,642]},","]]],["terminal",{sourceInterval:[644,647]},">"]]],Alt:["define",{sourceInterval:[651,685]},null,[],["app",{sourceInterval:[661,685]},"NonemptyListOf",[["app",{sourceInterval:[676,679]},"Seq",[]],["terminal",{sourceInterval:[681,684]},"|"]]]],Seq:["define",{sourceInterval:[689,704]},null,[],["star",{sourceInterval:[699,704]},["app",{sourceInterval:[699,703]},"Iter",[]]]],Iter_star:["define",{sourceInterval:[719,736]},null,[],["seq",{sourceInterval:[719,727]},["app",{sourceInterval:[719,723]},"Pred",[]],["terminal",{sourceInterval:[724,727]},"*"]]],Iter_plus:["define",{sourceInterval:[743,760]},null,[],["seq",{sourceInterval:[743,751]},["app",{sourceInterval:[743,747]},"Pred",[]],["terminal",{sourceInterval:[748,751]},"+"]]],Iter_opt:["define",{sourceInterval:[767,783]},null,[],["seq",{sourceInterval:[767,775]},["app",{sourceInterval:[767,771]},"Pred",[]],["terminal",{sourceInterval:[772,775]},"?"]]],Iter:["define",{sourceInterval:[708,794]},null,[],["alt",{sourceInterval:[719,794]},["app",{sourceInterval:[719,727]},"Iter_star",[]],["app",{sourceInterval:[743,751]},"Iter_plus",[]],["app",{sourceInterval:[767,775]},"Iter_opt",[]],["app",{sourceInterval:[790,794]},"Pred",[]]]],Pred_not:["define",{sourceInterval:[809,824]},null,[],["seq",{sourceInterval:[809,816]},["terminal",{sourceInterval:[809,812]},"~"],["app",{sourceInterval:[813,816]},"Lex",[]]]],Pred_lookahead:["define",{sourceInterval:[831,852]},null,[],["seq",{sourceInterval:[831,838]},["terminal",{sourceInterval:[831,834]},"&"],["app",{sourceInterval:[835,838]},"Lex",[]]]],Pred:["define",{sourceInterval:[798,862]},null,[],["alt",{sourceInterval:[809,862]},["app",{sourceInterval:[809,816]},"Pred_not",[]],["app",{sourceInterval:[831,838]},"Pred_lookahead",[]],["app",{sourceInterval:[859,862]},"Lex",[]]]],Lex_lex:["define",{sourceInterval:[876,892]},null,[],["seq",{sourceInterval:[876,884]},["terminal",{sourceInterval:[876,879]},"#"],["app",{sourceInterval:[880,884]},"Base",[]]]],Lex:["define",{sourceInterval:[866,903]},null,[],["alt",{sourceInterval:[876,903]},["app",{sourceInterval:[876,884]},"Lex_lex",[]],["app",{sourceInterval:[899,903]},"Base",[]]]],Base_application:["define",{sourceInterval:[918,979]},null,[],["seq",{sourceInterval:[918,963]},["app",{sourceInterval:[918,923]},"ident",[]],["opt",{sourceInterval:[924,931]},["app",{sourceInterval:[924,930]},"Params",[]]],["not",{sourceInterval:[932,963]},["alt",{sourceInterval:[934,962]},["seq",{sourceInterval:[934,948]},["opt",{sourceInterval:[934,944]},["app",{sourceInterval:[934,943]},"ruleDescr",[]]],["terminal",{sourceInterval:[945,948]},"="]],["terminal",{sourceInterval:[951,955]},":="],["terminal",{sourceInterval:[958,962]},"+="]]]]],Base_range:["define",{sourceInterval:[986,1041]},null,[],["seq",{sourceInterval:[986,1022]},["app",{sourceInterval:[986,1001]},"oneCharTerminal",[]],["terminal",{sourceInterval:[1002,1006]},".."],["app",{sourceInterval:[1007,1022]},"oneCharTerminal",[]]]],Base_terminal:["define",{sourceInterval:[1048,1106]},null,[],["app",{sourceInterval:[1048,1056]},"terminal",[]]],Base_paren:["define",{sourceInterval:[1113,1168]},null,[],["seq",{sourceInterval:[1113,1124]},["terminal",{sourceInterval:[1113,1116]},"("],["app",{sourceInterval:[1117,1120]},"Alt",[]],["terminal",{sourceInterval:[1121,1124]},")"]]],Base:["define",{sourceInterval:[907,1168]},null,[],["alt",{sourceInterval:[918,1168]},["app",{sourceInterval:[918,963]},"Base_application",[]],["app",{sourceInterval:[986,1022]},"Base_range",[]],["app",{sourceInterval:[1048,1056]},"Base_terminal",[]],["app",{sourceInterval:[1113,1124]},"Base_paren",[]]]],ruleDescr:["define",{sourceInterval:[1172,1231]},"a rule description",[],["seq",{sourceInterval:[1210,1231]},["terminal",{sourceInterval:[1210,1213]},"("],["app",{sourceInterval:[1214,1227]},"ruleDescrText",[]],["terminal",{sourceInterval:[1228,1231]},")"]]],ruleDescrText:["define",{sourceInterval:[1235,1266]},null,[],["star",{sourceInterval:[1255,1266]},["seq",{sourceInterval:[1256,1264]},["not",{sourceInterval:[1256,1260]},["terminal",{sourceInterval:[1257,1260]},")"]],["app",{sourceInterval:[1261,1264]},"any",[]]]]],caseName:["define",{sourceInterval:[1270,1338]},null,[],["seq",{sourceInterval:[1285,1338]},["terminal",{sourceInterval:[1285,1289]},"--"],["star",{sourceInterval:[1290,1304]},["seq",{sourceInterval:[1291,1302]},["not",{sourceInterval:[1291,1296]},["terminal",{sourceInterval:[1292,1296]},"\n"]],["app",{sourceInterval:[1297,1302]},"space",[]]]],["app",{sourceInterval:[1305,1309]},"name",[]],["star",{sourceInterval:[1310,1324]},["seq",{sourceInterval:[1311,1322]},["not",{sourceInterval:[1311,1316]},["terminal",{sourceInterval:[1312,1316]},"\n"]],["app",{sourceInterval:[1317,1322]},"space",[]]]],["alt",{sourceInterval:[1326,1337]},["terminal",{sourceInterval:[1326,1330]},"\n"],["lookahead",{sourceInterval:[1333,1337]},["terminal",{sourceInterval:[1334,1337]},"}"]]]]],name:["define",{sourceInterval:[1342,1382]},"a name",[],["seq",{sourceInterval:[1363,1382]},["app",{sourceInterval:[1363,1372]},"nameFirst",[]],["star",{sourceInterval:[1373,1382]},["app",{sourceInterval:[1373,1381]},"nameRest",[]]]]],nameFirst:["define",{sourceInterval:[1386,1418]},null,[],["alt",{sourceInterval:[1402,1418]},["terminal",{sourceInterval:[1402,1405]},"_"],["app",{sourceInterval:[1412,1418]},"letter",[]]]],nameRest:["define",{sourceInterval:[1422,1452]},null,[],["alt",{sourceInterval:[1437,1452]},["terminal",{sourceInterval:[1437,1440]},"_"],["app",{sourceInterval:[1447,1452]},"alnum",[]]]],ident:["define",{sourceInterval:[1456,1489]},"an identifier",[],["app",{sourceInterval:[1485,1489]},"name",[]]],terminal:["define",{sourceInterval:[1493,1531]},null,[],["seq",{sourceInterval:[1508,1531]},["terminal",{sourceInterval:[1508,1512]},'"'],["star",{sourceInterval:[1513,1526]},["app",{sourceInterval:[1513,1525]},"terminalChar",[]]],["terminal",{sourceInterval:[1527,1531]},'"']]],oneCharTerminal:["define",{sourceInterval:[1535,1579]},null,[],["seq",{sourceInterval:[1557,1579]},["terminal",{sourceInterval:[1557,1561]},'"'],["app",{sourceInterval:[1562,1574]},"terminalChar",[]],["terminal",{sourceInterval:[1575,1579]},'"']]],terminalChar:["define",{sourceInterval:[1583,1660]},null,[],["alt",{sourceInterval:[1602,1660]},["app",{sourceInterval:[1602,1612]},"escapeChar",[]],["seq",{sourceInterval:[1621,1660]},["not",{sourceInterval:[1621,1626]},["terminal",{sourceInterval:[1622,1626]},"\\"]],["not",{sourceInterval:[1627,1632]},["terminal",{sourceInterval:[1628,1632]},'"']],["not",{sourceInterval:[1633,1638]},["terminal",{sourceInterval:[1634,1638]},"\n"]],["range",{sourceInterval:[1639,1660]},"\0","􏿿"]]]],escapeChar_backslash:["define",{sourceInterval:[1703,1758]},null,[],["terminal",{sourceInterval:[1703,1709]},"\\\\"]],escapeChar_doubleQuote:["define",{sourceInterval:[1765,1822]},null,[],["terminal",{sourceInterval:[1765,1771]},'\\"']],escapeChar_singleQuote:["define",{sourceInterval:[1829,1886]},null,[],["terminal",{sourceInterval:[1829,1835]},"\\'"]],escapeChar_backspace:["define",{sourceInterval:[1893,1948]},null,[],["terminal",{sourceInterval:[1893,1898]},"\\b"]],escapeChar_lineFeed:["define",{sourceInterval:[1955,2009]},null,[],["terminal",{sourceInterval:[1955,1960]},"\\n"]],escapeChar_carriageReturn:["define",{sourceInterval:[2016,2076]},null,[],["terminal",{sourceInterval:[2016,2021]},"\\r"]],escapeChar_tab:["define",{sourceInterval:[2083,2132]},null,[],["terminal",{sourceInterval:[2083,2088]},"\\t"]],escapeChar_unicodeCodePoint:["define",{sourceInterval:[2139,2243]},null,[],["seq",{sourceInterval:[2139,2221]},["terminal",{sourceInterval:[2139,2145]},"\\u{"],["app",{sourceInterval:[2146,2154]},"hexDigit",[]],["opt",{sourceInterval:[2155,2164]},["app",{sourceInterval:[2155,2163]},"hexDigit",[]]],["opt",{sourceInterval:[2165,2174]},["app",{sourceInterval:[2165,2173]},"hexDigit",[]]],["opt",{sourceInterval:[2188,2197]},["app",{sourceInterval:[2188,2196]},"hexDigit",[]]],["opt",{sourceInterval:[2198,2207]},["app",{sourceInterval:[2198,2206]},"hexDigit",[]]],["opt",{sourceInterval:[2208,2217]},["app",{sourceInterval:[2208,2216]},"hexDigit",[]]],["terminal",{sourceInterval:[2218,2221]},"}"]]],escapeChar_unicodeEscape:["define",{sourceInterval:[2250,2309]},null,[],["seq",{sourceInterval:[2250,2291]},["terminal",{sourceInterval:[2250,2255]},"\\u"],["app",{sourceInterval:[2256,2264]},"hexDigit",[]],["app",{sourceInterval:[2265,2273]},"hexDigit",[]],["app",{sourceInterval:[2274,2282]},"hexDigit",[]],["app",{sourceInterval:[2283,2291]},"hexDigit",[]]]],escapeChar_hexEscape:["define",{sourceInterval:[2316,2371]},null,[],["seq",{sourceInterval:[2316,2339]},["terminal",{sourceInterval:[2316,2321]},"\\x"],["app",{sourceInterval:[2322,2330]},"hexDigit",[]],["app",{sourceInterval:[2331,2339]},"hexDigit",[]]]],escapeChar:["define",{sourceInterval:[1664,2371]},"an escape sequence",[],["alt",{sourceInterval:[1703,2371]},["app",{sourceInterval:[1703,1709]},"escapeChar_backslash",[]],["app",{sourceInterval:[1765,1771]},"escapeChar_doubleQuote",[]],["app",{sourceInterval:[1829,1835]},"escapeChar_singleQuote",[]],["app",{sourceInterval:[1893,1898]},"escapeChar_backspace",[]],["app",{sourceInterval:[1955,1960]},"escapeChar_lineFeed",[]],["app",{sourceInterval:[2016,2021]},"escapeChar_carriageReturn",[]],["app",{sourceInterval:[2083,2088]},"escapeChar_tab",[]],["app",{sourceInterval:[2139,2221]},"escapeChar_unicodeCodePoint",[]],["app",{sourceInterval:[2250,2291]},"escapeChar_unicodeEscape",[]],["app",{sourceInterval:[2316,2339]},"escapeChar_hexEscape",[]]]],space:["extend",{sourceInterval:[2375,2394]},null,[],["app",{sourceInterval:[2387,2394]},"comment",[]]],comment_singleLine:["define",{sourceInterval:[2412,2458]},null,[],["seq",{sourceInterval:[2412,2443]},["terminal",{sourceInterval:[2412,2416]},"//"],["star",{sourceInterval:[2417,2429]},["seq",{sourceInterval:[2418,2427]},["not",{sourceInterval:[2418,2423]},["terminal",{sourceInterval:[2419,2423]},"\n"]],["app",{sourceInterval:[2424,2427]},"any",[]]]],["lookahead",{sourceInterval:[2430,2443]},["alt",{sourceInterval:[2432,2442]},["terminal",{sourceInterval:[2432,2436]},"\n"],["app",{sourceInterval:[2439,2442]},"end",[]]]]]],comment_multiLine:["define",{sourceInterval:[2465,2501]},null,[],["seq",{sourceInterval:[2465,2487]},["terminal",{sourceInterval:[2465,2469]},"/*"],["star",{sourceInterval:[2470,2482]},["seq",{sourceInterval:[2471,2480]},["not",{sourceInterval:[2471,2476]},["terminal",{sourceInterval:[2472,2476]},"*/"]],["app",{sourceInterval:[2477,2480]},"any",[]]]],["terminal",{sourceInterval:[2483,2487]},"*/"]]],comment:["define",{sourceInterval:[2398,2501]},null,[],["alt",{sourceInterval:[2412,2501]},["app",{sourceInterval:[2412,2443]},"comment_singleLine",[]],["app",{sourceInterval:[2465,2487]},"comment_multiLine",[]]]],tokens:["define",{sourceInterval:[2505,2520]},null,[],["star",{sourceInterval:[2514,2520]},["app",{sourceInterval:[2514,2519]},"token",[]]]],token:["define",{sourceInterval:[2524,2600]},null,[],["alt",{sourceInterval:[2532,2600]},["app",{sourceInterval:[2532,2540]},"caseName",[]],["app",{sourceInterval:[2543,2550]},"comment",[]],["app",{sourceInterval:[2553,2558]},"ident",[]],["app",{sourceInterval:[2561,2569]},"operator",[]],["app",{sourceInterval:[2572,2583]},"punctuation",[]],["app",{sourceInterval:[2586,2594]},"terminal",[]],["app",{sourceInterval:[2597,2600]},"any",[]]]],operator:["define",{sourceInterval:[2604,2669]},null,[],["alt",{sourceInterval:[2615,2669]},["terminal",{sourceInterval:[2615,2619]},"<:"],["terminal",{sourceInterval:[2622,2625]},"="],["terminal",{sourceInterval:[2628,2632]},":="],["terminal",{sourceInterval:[2635,2639]},"+="],["terminal",{sourceInterval:[2642,2645]},"*"],["terminal",{sourceInterval:[2648,2651]},"+"],["terminal",{sourceInterval:[2654,2657]},"?"],["terminal",{sourceInterval:[2660,2663]},"~"],["terminal",{sourceInterval:[2666,2669]},"&"]]],punctuation:["define",{sourceInterval:[2673,2709]},null,[],["alt",{sourceInterval:[2687,2709]},["terminal",{sourceInterval:[2687,2690]},"<"],["terminal",{sourceInterval:[2693,2696]},">"],["terminal",{sourceInterval:[2699,2702]},","],["terminal",{sourceInterval:[2705,2709]},"--"]]]}]));const He=Object.create(n.prototype);function We(e,t){for(const r in e)if(r===t)return 1}function Qe(e,s,t){const a=new $e;let o,l,u,i=!1;return(t||Je).createSemantics().addOperation("visit",{Grammars(e){return e.children.map(e=>e.visit())},Grammar(e,t,r,n,i){e=e.visit(),o=a.newGrammar(e),t.child(0)&&t.child(0).visit(),n.children.map(e=>e.visit()),t=o.build();if(t.source=this.source.trimmed(),We(s,e))throw S("Grammar "+t.name+" is already declared in this namespace");return s[e]=t},SuperGrammar(e,t){var r,n,i=t.visit();if("null"===i)o.withSuperGrammar(null);else{if(!s||!We(s,i))throw r=i,n=s,t=t.source,S(n?`Grammar ${r} is not declared in namespace '${n}'`:"Undeclared grammar "+r,t);o.withSuperGrammar(s[i])}},Rule_define(e,t,r,n,i){l=e.visit(),u=t.children.map(e=>e.visit())[0]||[],o.defaultStartRule||o.ensureSuperGrammar()===k.ProtoBuiltInRules||o.withDefaultStartRule(l);e=i.visit(),t=r.children.map(e=>e.visit())[0],i=this.source.trimmed();return o.define(l,u,e,t,i)},Rule_override(e,t,r,n){l=e.visit(),u=t.children.map(e=>e.visit())[0]||[];e=this.source.trimmed(),o.ensureSuperGrammarRuleForOverriding(l,e),i=!0,t=n.visit();return i=!1,o.override(l,u,t,null,e)},Rule_extend(e,t,r,n){l=e.visit(),u=t.children.map(e=>e.visit())[0]||[];e=n.visit(),t=this.source.trimmed();return o.extend(l,u,e,null,t)},RuleBody(e,t){return a.alt(...t.visit()).withSource(this.source)},OverrideRuleBody(e,t){var r,t=t.visit(),n=t.indexOf(He);return(0<=n?(r=t.slice(0,n),(n=t.slice(n+1)).forEach(e=>{if(e===He)throw S("'...' can appear at most once in a rule body",e.source)}),new c(o.superGrammar,l,r,n)):a.alt(...t)).withSource(this.source)},Formals(e,t,r){return t.visit()},Params(e,t,r){return t.visit()},Alt(e){return a.alt(...e.visit()).withSource(this.source)},TopLevelTerm_inline(e,t){var t=l+"_"+t.visit(),e=e.visit(),r=this.source.trimmed(),n=!(o.superGrammar&&o.superGrammar.rules[t]),n=(i&&!n?o.override(t,u,e,null,r):o.define(t,u,e,null,r),u.map(e=>a.app(e)));return a.app(t,n).withSource(e.source)},OverrideTopLevelTerm_superSplice(e){return He},Seq(e){return a.seq(...e.children.map(e=>e.visit())).withSource(this.source)},Iter_star(e,t){return a.star(e.visit()).withSource(this.source)},Iter_plus(e,t){return a.plus(e.visit()).withSource(this.source)},Iter_opt(e,t){return a.opt(e.visit()).withSource(this.source)},Pred_not(e,t){return a.not(t.visit()).withSource(this.source)},Pred_lookahead(e,t){return a.lookahead(t.visit()).withSource(this.source)},Lex_lex(e,t){return a.lex(t.visit()).withSource(this.source)},Base_application(e,t){t=t.children.map(e=>e.visit())[0]||[];return a.app(e.visit(),t).withSource(this.source)},Base_range(e,t,r){return a.range(e.visit(),r.visit()).withSource(this.source)},Base_terminal(e){return a.terminal(e.visit()).withSource(this.source)},Base_paren(e,t,r){return t.visit()},ruleDescr(e,t,r){return t.visit()},ruleDescrText(e){return this.sourceString.trim()},caseName(e,t,r,n,i){return r.visit()},name(e,t){return this.sourceString},nameFirst(e){},nameRest(e){},terminal(e,t,r){return t.children.map(e=>e.visit()).join("")},oneCharTerminal(e,t,r){return t.visit()},escapeChar(t){try{return V(this.sourceString)}catch(e){if(e instanceof RangeError&&e.message.startsWith("Invalid code point "))throw m((r=(t=t)._node)&&r.isNonterminal()&&"escapeChar_unicodeCodePoint"===r.ctorName),S(`U+${(t=(r=t.children.slice(1,-1).map(e=>e.source))[0].coverageWith(...r.slice(1))).contents} is not a valid Unicode code point`,t);throw e}var r},NonemptyListOf(e,t,r){return[e.visit()].concat(r.children.map(e=>e.visit()))},EmptyListOf(){return[]},_terminal(){return this.sourceString}})(e).visit()}var Ze=Ue(["grammar",{source:'OperationsAndAttributes {\n\n  AttributeSignature =\n    name\n\n  OperationSignature =\n    name Formals?\n\n  Formals\n    = "(" ListOf<name, ","> ")"\n\n  name  (a name)\n    = nameFirst nameRest*\n\n  nameFirst\n    = "_"\n    | letter\n\n  nameRest\n    = "_"\n    | alnum\n\n}'},"OperationsAndAttributes",null,"AttributeSignature",{AttributeSignature:["define",{sourceInterval:[29,58]},null,[],["app",{sourceInterval:[54,58]},"name",[]]],OperationSignature:["define",{sourceInterval:[62,100]},null,[],["seq",{sourceInterval:[87,100]},["app",{sourceInterval:[87,91]},"name",[]],["opt",{sourceInterval:[92,100]},["app",{sourceInterval:[92,99]},"Formals",[]]]]],Formals:["define",{sourceInterval:[104,143]},null,[],["seq",{sourceInterval:[118,143]},["terminal",{sourceInterval:[118,121]},"("],["app",{sourceInterval:[122,139]},"ListOf",[["app",{sourceInterval:[129,133]},"name",[]],["terminal",{sourceInterval:[135,138]},","]]],["terminal",{sourceInterval:[140,143]},")"]]],name:["define",{sourceInterval:[147,187]},"a name",[],["seq",{sourceInterval:[168,187]},["app",{sourceInterval:[168,177]},"nameFirst",[]],["star",{sourceInterval:[178,187]},["app",{sourceInterval:[178,186]},"nameRest",[]]]]],nameFirst:["define",{sourceInterval:[191,223]},null,[],["alt",{sourceInterval:[207,223]},["terminal",{sourceInterval:[207,210]},"_"],["app",{sourceInterval:[217,223]},"letter",[]]]],nameRest:["define",{sourceInterval:[227,257]},null,[],["alt",{sourceInterval:[242,257]},["terminal",{sourceInterval:[242,245]},"_"],["app",{sourceInterval:[252,257]},"alnum",[]]]]}]);M=k.BuiltInRules,C={empty(){return this.iteration()},nonEmpty(e,t,r){return this.iteration([e].concat(r.children))}},F.BuiltInSemantics=F.createSemantics(M,null).addOperation("asIteration",{emptyListOf:C.empty,nonemptyListOf:C.nonEmpty,EmptyListOf:C.empty,NonemptyListOf:C.nonEmpty}),M=Ze,F.prototypeGrammarSemantics=M.createSemantics().addOperation("parse",{AttributeSignature(e){return{name:e.parse(),formals:[]}},OperationSignature(e,t){return{name:e.parse(),formals:t.children.map(e=>e.parse())[0]||[]}},Formals(e,t,r){return t.asIteration().children.map(e=>e.parse())},name(e,t){return this.sourceString}}),F.prototypeGrammar=M;const Ye="an indented block",Xe="a dedent";class et extends he{constructor(e){super(e.input),this.state=e}_indentationAt(e){return this.state.userData[e]||0}atEnd(){return super.atEnd()&&0===this._indentationAt(this.pos)}next(){if(0===this._indentationAt(this.pos))return super.next();this.examinedLength=Math.max(this.examinedLength,this.pos)}nextCharCode(){return 0!==this._indentationAt(this.pos)?(this.examinedLength=Math.max(this.examinedLength,this.pos),1114112):super.nextCharCode()}nextCodePoint(){return 0!==this._indentationAt(this.pos)?(this.examinedLength=Math.max(this.examinedLength,this.pos),1114112):super.nextCodePoint()}}class tt extends n{constructor(e=!0){super(),this.isIndent=e}allowsSkippingPrecedingSpace(){return!0}eval(e){var t=e["inputStream"],r=e.userData,t=(e.doNotMemoize=!0,t.pos),n=this.isIndent?1:-1;return 0<(r[t]||0)*n?(e.userData=Object.create(r),e.userData[t]-=n,e.pushBinding(new L(0),t),!0):(e.processFailure(t,this),!1)}getArity(){return 1}_assertAllApplicationsAreValid(e,t){}_isNullable(e,t){return!1}assertChoicesHaveUniformArity(e){}assertIteratedExprsAreNotNullable(e){}introduceParams(e){return this}substituteParams(e){return this}toString(){return this.isIndent?"indent":"dedent"}toDisplayString(){return this.toString()}toFailure(e){var t=this.isIndent?Ye:Xe;return new P(this,t,"description")}}var C=new b("indent"),Ze=new b("dedent"),M=new c(Ve,"any",[C,Ze],[]),C=(new $e).newGrammar("IndentationSensitive").withSuperGrammar(Ve).define("indent",[],new tt(!0),Ye,void 0,!0).define("dedent",[],new tt(!1),Xe,void 0,!0).extend("any",[],M,"any character",void 0).build();Object.assign(C,{_matchStateInitializer(e){e.userData=function(e){let t=0;const r=[0];for(var n=()=>r[r.length-1],i={},s=/( *).*(?:$|\r?\n|\r)/g;null!=(a=s.exec(e));){var[a,o]=a;if(0===a.length)break;var l=o.length,o=n(),u=t+l;if(o<l)r.push(l),i[u]=1;else if(l<o){for(o=r.length;n()!==l;)r.pop();i[u]=-1*(o-r.length)}t+=a.length}return 1<r.length&&(i[t]=1-r.length),i}(e.input),e.inputStream=new et(e)},supportsIncrementalParsing:!1});k.initApplicationParser(Je,Qe);const rt=e=>!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e);function nt(e,t){var r,n,e=Je.match(e,"Grammars");if(e.failed())throw r=e,n=new Error,Object.defineProperty(n,"message",{enumerable:!0,get(){return r.message}}),Object.defineProperty(n,"shortMessage",{enumerable:!0,get(){return"Expected "+r.getExpectedText()}}),n.interval=r.getInterval(),n;Qe(e,t)}function it(e,t){t=Object.create(t||{});if("string"!=typeof e){if(!rt(e))throw new TypeError("Expected string as first argument, got "+J(e));e=e.toString()}return nt(e,t),t}e.ExperimentalIndentationSensitive=C,e._buildGrammar=Qe,e.grammar=function(e,t){var r,e=it(e,t);if(0===(t=Object.keys(e)).length)throw new Error("Missing grammar definition");if(1<t.length)throw r=e[t[1]].source,new Error(pe(r.sourceString,r.startIdx)+"Found more than one grammar definition -- use ohm.grammars() instead.");return e[t[0]]},e.grammars=it,e.makeRecipe=Ue,e.ohmGrammar=Je,e.pexprs=Le,e.version="17.1.0"}},i={};(function e(t){var r=i[t];return void 0===r&&(r=i[t]={exports:{}},n[t](r,r.exports,e)),r.exports})(138)})();
//# sourceMappingURL=caph1993-numpy-js.js.map