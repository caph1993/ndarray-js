(()=>{var e={89:(e,t,r)=>{const{np:n}=r(696).GLOBALS;function s(e,t=null){let r,s;return null===t?(r=0,s=e):(r=e,s=t),n.NDArray.prototype._new(s-r,((e,t)=>r+t),Number)}function i(e,t,r=50,i=!0){({stop:t,num:r,endpoint:i}=Object.assign({stop:t,num:r,endpoint:i},this));const{__as_number:o}=n.NDArray.prototype;e=o(e),t=o(t);let a=r-(i?1:0);return n.add(n.multiply(s(r),(t-e)/a),e)}e.exports={empty:function(e,t=Number){return n.NDArray.prototype._new(e,(e=>{}),t)},zeros:function(e,t=Number){const r=t!=Boolean&&0;return n.NDArray.prototype._new(e,(e=>r),t)},ones:function(e,t=Number){const r=t==Boolean||1;return n.NDArray.prototype._new(e,(e=>r),t)},arange:s,linspace:i,geomspace:function(e,t,r=50,s=!0){return({stop:t,num:r,endpoint:s}=Object.assign({stop:t,num:r,endpoint:s},this)),e=n.log(e),t=n.log(t),n.exp(i(e,t,r,s))}}},499:(e,t,r)=>{const{NDArray:n}=r(696).GLOBALS;function s(e){return e instanceof n?e:n.prototype.fromJS(e)}e.exports={asarray:s,array:function(e){if(e instanceof n){let t=null==e._simpleIndexes?[...e.flat]:e.flat;return new n(t,e.shape,e.dtype)}return n.prototype.fromJS(e)},reshape:function(e,t,...r){e=s(e);const{__parse_shape:i,__as_number:o}=n.prototype;t=r.length?[t,...r].map(o):i(t);const a=e.size,c=t.indexOf(-1);if(-1!==c){const e=t.filter((e=>-1!==e)).reduce(((e,t)=>e*t),1);if(a%e!=0)throw new Error("Invalid shape. The total number of elements must match the product of the known dimensions.");t[c]=a/e}return new n(e.flat,t,e.dtype)},ravel:function(e){return e=s(e),new n(e.flat,[e.size],e.dtype)},copy:function(e){return e=s(e),new n([...e.flat],e.shape,e.dtype)}}},90:(e,t,r)=>{const{NDArray:n}=r(696).GLOBALS;function s(e,t,r){return e=n.prototype.modules.basic.asarray(e),new n(e.flat.map(t),e.shape,r)}e.exports={elementwise:s,bitwise_not:function(e){return s(e,(e=>~e),Number)},logical_not:function(e){return s(e,(e=>!e),Boolean)},round:function(e,t=0){return 0==t&&s(e,Math.round,Number),s(e,(e=>parseFloat(e.toFixed(t))),Number)},__make_elementwise:function(e,t=Number){return function(r){return s(r,e,t)}}}},230:(e,t,r)=>{const{NDArray:n}=r(696).GLOBALS;class s{constructor(e,t,r){this.shape=e,this.internalShape=t,this.axisIndexes=r,this._indices=null,this._size=null,this.isSimple=this.axisIndexes.map((e=>e.isSimple)).reduce(((e,t)=>e&&t),!0),this.isConstant=this.axisIndexes.map((e=>e.isConstant)).reduce(((e,t)=>e&&t),!0)}get indices(){if(this._indices)return this._indices;let e=i(this.internalShape,this.__slices);return this._indices=e}get __slices(){return this.axisIndexes.map((e=>e.indices))}get size(){return this._size?this._size:this._size=this.axisIndexes.map((e=>e.size)).reduce(((e,t)=>e*t),0)}}function i(e,t){const{__shape_shifts:r}=n.prototype;for(let e of t)if(0==e.length)return[];const s=r(e),i=t.map(((e,t)=>{let r=[],n=e.length;for(let i=0;i<n-1;i++)r.push(s[t]*(e[i+1]-e[i]));return r[n-1]=s[t]*(e[0]-e[n-1]),r})),o=[],a=e.length-1,c=new Array(e.length).fill(0);let l=t.map(((e,t)=>e[c[t]]*s[t])).reduce(((e,t)=>e+t),0);for(;;){if(!isFinite(l))throw new Error("Programming error");o.push(l);let e=a;for(;e>=0&&(l+=i[e][c[e]++],!(c[e]<i[e].length));)c[e--]=0;if(e<0)break}return o}e.exports.__parse_sliceRange=function(e,{start:t,stop:r,step:n}){if(null==t?t=0:t<0&&(t=e+t),null==r?r=e:r<0&&(r=e+r),null==n)n=1;else if(0==n)throw new Error("Slice range with step size of zero");if(!isFinite(t)||!isFinite(r)||!isFinite(n))throw new Error(`Invalid slice ${[t,r,n]}. Axis size ${e}`);let s=[];if(n>0){t=Math.max(t,0),r=Math.min(r,e);for(let e=t;e<r;e+=n)s.push(e)}else{r=Math.max(r,0);for(let i=t=Math.min(t,e);i>r;i+=n)s.push(i)}return s};class o{constructor(e){this.spec=e,this._indices=null,this.isSimple="array"!=this.spec.type,this.isConstant="number"==this.spec.type}get indices(){if(this._indices)return this._indices;let e;if(":"==this.spec.type)e=Array.from({length:this.spec.size},((e,t)=>t));else if("number"===this.spec.type)e=[this.spec.index];else if("array"===this.spec.type)e=this.spec.indices;else{if("range"!=this.spec.type)throw new Error(`Unknown spec type ${this.spec.type}`);{const{nSteps:t,step:r,start:n}=this.spec.range;e=Array.from({length:t},((e,t)=>n+t*r))}}return this._indices=e}get size(){if(":"==this.spec.type)return this.spec.size;if("number"===this.spec.type)return 1;if("array"===this.spec.type)return this.spec.indices.length;if("range"==this.spec.type)return this.spec.range.nSteps;throw new Error(`Unknown spec type ${this.spec.type}`)}}o.prototype.parse_range=function(e,t=null,r=null,n=null){if(null==n)n=1;else if(0==n)throw new Error("Index specification error. Step must be different from zero.");const s=(t,r,n,s)=>null==t?r:(t<0&&(t=Math.max(0,e-t)),Math.min(s,Math.max(n,t)));let i;return n>0?(t=s(t,0,0,e-1),r=s(r,e,0,e)):(t=s(t,e-1,0,e-1),r=s(r,e-1,-1,e-1)),r=Math.max(r,t),i=Math.floor(Math.abs(r-t)/n),{start:t,step:n,nSteps:i}},o.prototype.parse_range_spec=function(e){const t=e.split(":").map((e=>{if(""==(e=e.trim()))return null;const t=parseInt(e);if(!Number.isInteger(t))throw new Error(`Wrong input. Slice index unrecognized: ${e}`);return t}));if(0==t.length)throw new Error("Unexpected empty index. Expected colons.");if(t.length>3)throw new Error(`Too many colons in index ${e}`);let[r,n,s,...i]=[...t,null,null,null];return{start:r,stop:n,step:s}},o.prototype.parse=function(e,t){let r,s=1;if(":"==e||void 0===e)r={type:":",size:t};else if("number"==typeof e){let n=e;if(n<0&&(n=t+n),n<0||n>=t)throw new Error(`Index ${n} out of bounds [0..${t})`);r={type:"number",index:n}}else if(e instanceof n||Array.isArray(e)){let t,i=n.prototype.modules.basic.asarray(e);if(i.dtype==Number){if(i.shape.length>1)throw new Error(`Expected 1D array of indices or nD array of booleans. Found shape=${i.shape} and dtype=${i.dtype}`);t=i.flat}else t=[],i.flat.forEach(((e,r)=>e&&t.push(r))),s=Math.max(1,i.shape.length);r={type:"array",indices:t}}else{if("string"!=typeof e)throw new Error(`Unknown index type. Found ${typeof e}: ${e}`);{let{start:n,stop:s,step:i}=o.prototype.parse_range_spec(e);const a=o.prototype.parse_range(t,n,s,i);r=0==a.start&&a.nSteps==t&&1==a.step?{type:":",size:t}:{type:"range",range:a}}}return{axisIndex:new o(r),span:s}},s.prototype.parse=function(e,t){const r={axisIndexes:[],apparentShape:[],internalShape:[]};let n=1;const i={axisIndexes:NaN,apparentShape:NaN,internalShape:NaN};let a=0,c=0,l=e.length;for(;l>0;){let s=t[c];if(t[c]=void 0,c+=n,"None"==s||null===s){r.apparentShape.push(1);continue}if("..."==s){if(-1==n)throw new Error("Index can only have a single ellipsis ('...')");n=-1;for(let e in i)i[e]=r[e].length;c=t.length-1,a=e.length-1;continue}const{axisIndex:u,span:p}=o.prototype.parse(s,e[a]);l-=p;let h=1;for(let t=0;t<p;t++){if(a<0||a>=e.length)throw new Error("Index spans over more dimensions than available");h*=e[a],a+=n}r.axisIndexes.push(u),"number"!=u.spec.type&&r.apparentShape.push(u.size),r.internalShape.push(h)}if(-1==n)for(let e in r)r[e].splice(0,i[e]).concat(r[e].reverse());return new s(r.apparentShape,r.internalShape,r.axisIndexes)},e.exports={index:function(e,...t){let{copy:r}=Object.assign({copy:!1},e.__popKwArgs());if(!(e instanceof n))throw new Error(`Expected NDArray. Found ${typeof e}: ${e}`);const i=s.prototype.parse(e.shape,t);if(i.isConstant){let[t]=i.indices;return e.flat[t]}if(i.isSimple){const t=function(e,t){if(null==e)return t;const r=[];let n=0;for(let s=0;s<e.axisIndexes.length;s++){let i,{spec:a}=e.axisIndexes[s],{spec:c}=t.axisIndexes[n];if("array"==a.type)throw new Error(`Expected simple index. Found advanced: ${a.type}`);if("array"==c.type)throw new Error(`Expected simple index. Found advanced: ${c.type}`);if("number"==a.type)i=a;else if(n++,":"==a.type)i=c;else if(":"==c.type)i=a;else{let{start:e,step:t,nSteps:r}=a.range;if("number"==c.type){let{index:n}=c;if(n<0&&(n=r+n),n<0||n>=r)throw new Error(`Index ${n} out of bounds [0..${r})`);n=e+n*t,i={type:"number",index:n}}else{let{start:n,step:s,nSteps:a}=c.range,l=o.prototype.parse_range(r,n,n+a*s,s),u=l.step*t;i={type:"range",range:{start:e+l.start*u,step:u,nSteps:l.nSteps}}}}r.push(new o(i))}if(n<t.axisIndexes.length)throw new Error(`Index too long. Expected ${n} axes. Found ${t.axisIndexes.length}`);const i=t.shape,a=e.internalShape;return new s(i,a,r)}(e._simpleIndexes,i),a=new n(e._flat,i.shape,e.dtype);return a._simpleIndexes=t,e.__warnAssignments&&(a.__warnAssignments=!0),r?a.copy():a}{const t=e.flat,s=i.indices.map((e=>t[e])),o=new n(s,i.shape,e.dtype);return r||(o.__warnAssignments=!0),o}},AxesIndex:s,AxisIndex:o,__slices_to_indices:i}},897:(e,t,r)=>{const{NDArray:n}=r(696).GLOBALS;e.exports={fromJS:function(e){if(e instanceof n)return e;if("number"==typeof e)return new n([e],[],Number);if("boolean"==typeof e)return new n([e?1:0],[],Boolean);if(e===n.prototype)throw new Error("Programming error");if(!Array.isArray(e))throw new Error(`Can't parse input of type ${typeof e}: ${e}`);const t=[];let r=e;for(;Array.isArray(r);)if(t.push(r.length),r=r[0],t.length>256)throw new Error("Circular reference or excessive array depth");let s="boolean"==typeof r?Boolean:Number;const i=[],o=(e,r)=>{if(r==t.length-1)for(let t of e){if(Array.isArray(t))throw new Error("Inconsistent shape");i.push(t)}else{if(!Array.isArray(e))throw new Error("Inconsistent shape");for(let n of e){if(n.length!=t[r+1])throw new Error(`Inconsistent shape: found sibling arrays of lengths ${n.length} and ${t[r+1]}`);o(n,r+1)}}};return o(e,0),new n(i,t,s)},toJS:function e(t){if(this instanceof n)return e;if(null===t||"number"==typeof t||"boolean"==typeof t)return t;if(Array.isArray(t))return t.map(e);if(!(t instanceof n))throw new Error(`Expected MyArray. Got ${typeof t}: ${t}`);return(t=n.prototype.__number_collapse(t))instanceof n?function e(t,r){if(0===r.length)return t.shift();const n=r.slice(1),s=r[0],i=[];for(let r=0;r<s;r++)i.push(e(t,n));return i}([...t.flat],t.shape):t}}},334:(e,t,r)=>{const{NDArray:n}=r(696).GLOBALS,s=r(230),i=r(90),o=n.prototype.modules.basic.asarray,a=n.prototype.modules.basic.ravel;function c(e,t,r,s,i=null){if(this instanceof n)return r.bind(n.prototype)(this,...arguments);const{__shape_shifts:a,__number_collapse:c}=n.prototype;e=o(e),t=o(t);const[l,u,p]=function(e,t){const r=[],n=Math.max(e.length,t.length);e=[...Array.from({length:n-e.length},(()=>1)),...e],t=[...Array.from({length:n-t.length},(()=>1)),...t];for(let s=n-1;s>=0;s--){const n=e[s],i=t[s];if(1!==n&&1!==i&&n!==i)throw new Error(`Can not broadcast axis ${s} with sizes ${n} and ${i}`);r.unshift(Math.max(n,i))}return[r,e,t]}(e.shape,t.shape);if(null==i)i=n.prototype._new(l,(e=>{}),s);else if(!(i instanceof n))throw new Error(`Out must be of type ${n}. Got ${typeof i}`);const h=[],m=a(u),d=a(p),f=e.flat,g=t.flat;for(let e=0;e<i.size;e++){let t=0,n=0,s=e;for(let e=l.length-1;e>=0;e--)t+=m[e]*(s%u[e]),n+=d[e]*(s%p[e]),s=Math.floor(s/l[e]);h.push(r(f[t],g[n]))}return i.flat=h,c(i)}function l(e,t){return function r(s,i,o=null){return this instanceof n?r.bind(n.prototype)(this,...arguments):c(s,i,t,e,o)}}function u(e,t){return function r(s,i,a=null){if(this instanceof n)return r.bind(n.prototype)(this,...arguments);s=o(s),i=o(i);let l,u=s.dtype;return s.dtype!=i.dtype&&console.warn(`Warning: operating arrays of different dtypes. Using ${u}`),l=u==Boolean?t:e,c(s,i,l,u,a)}}const p={"+":l(Number,((e,t)=>e+t)),"-":l(Number,((e,t)=>e-t)),"*":l(Number,((e,t)=>e*t)),"/":l(Number,((e,t)=>e/t)),"%":l(Number,((e,t)=>e%t)),"//":l(Number,((e,t)=>Math.floor(e/t))),"**":l(Number,((e,t)=>Math.pow(e,t))),"<":l(Boolean,((e,t)=>e<t)),">":l(Boolean,((e,t)=>e>t)),">=":l(Boolean,((e,t)=>e>=t)),"<=":l(Boolean,((e,t)=>e<=t)),"==":l(Boolean,((e,t)=>e==t)),"!=":l(Boolean,((e,t)=>e!=t)),"|":u(((e,t)=>e|t),((e,t)=>e||t)),"&":u(((e,t)=>e&t),((e,t)=>e&&t)),"^":l(Number,((e,t)=>e^t)),"<<":l(Number,((e,t)=>e<<t)),">>":l(Number,((e,t)=>e>>t)),or:l(Boolean,((e,t)=>e||t)),and:l(Boolean,((e,t)=>e&&t)),xor:l(((e,t)=>!e!=!t)),max:l(Number,((e,t)=>Math.max(e,t))),min:l(Number,((e,t)=>Math.min(e,t)))};p["↑"]=p.max,p["↓"]=p.min,p["≤"]=p.leq,p["≥"]=p.geq,p["≠"]=p.neq,p["↑="]=p["max="],p["↓="]=p["min="];const h={"~":i.bitwise_not,not:i.logical_not};function m(e,t,r,i,c){if(this instanceof n)return m(this,...arguments);e.__warnAssignment&&(console.warn("Warning: You are assigning on a copy that resulted from an advanced index on a source array.\nIf this is intentional, use yourArray = source.withKwArgs({copy:true}).index(...yourIndex) to make explicit your awareness of the copy operation.\nInstead, if you want to assign to the source array, use source.op('=', other, ...yourIndex).\n"),delete e.__warnAssignment);const{_binary_operation:l}=n.prototype;if(!(e instanceof n))return function(e,t,r,s,i){if(!Array.isArray(e))throw new Error(`Can not assign to a non-array. Found ${typeof e}: ${e}`);console.warn("Assignment to JS array is experimental and slow.");const a=o(e);m(a,t,r,s,i);const c=n.prototype.modules.jsInterface.toJS(a);for(;e.length;)e.pop();e.push(...c)}(e,t,r,i,c);if(r){t=o(t);let u,{indices:p}=s.AxesIndex.prototype.parse(e.shape,r);null==i?(i=(e,t)=>t,u=n.prototype._new(p.length,(()=>{}),e.dtype)):u=o(p.map((t=>e._flat[t]))),l(u,a(t),i,c,u);for(let t of p)e._flat[t]=u._flat[t]}else l(e,t,i,c,e)}function d(e,t){return function r(s,i,o){return this instanceof n?r.bind(n.prototype)(this,...arguments):m(s,i,o,t,e)}}const f={"=":d(Number,((e,t)=>t)),"+=":d(Number,((e,t)=>e+t)),"-=":d(Number,((e,t)=>e-t)),"*=":d(Number,((e,t)=>e*t)),"/=":d(Number,((e,t)=>e/t)),"%=":d(Number,((e,t)=>e%t)),"//=":d(Number,((e,t)=>Math.floor(e/t))),"**=":d(Number,((e,t)=>Math.pow(e,t))),"|=":d(Number,((e,t)=>e|t)),"&=":d(Number,((e,t)=>e&t)),"^=":d(Number,((e,t)=>e^t)),"<<=":d(Number,((e,t)=>e<<t)),">>=":d(Number,((e,t)=>e>>t)),"max=":d(Number,((e,t)=>Math.max(e,t))),"min=":d(Number,((e,t)=>Math.min(e,t))),"or=":d(Boolean,((e,t)=>e||t)),"and=":d(Boolean,((e,t)=>e&&t))};e.exports={op_binary:p,op_assign:f,op_unary:h,binary_operation:c,assign_operation:m,isclose:function(e,t,r=1e-5,n=1e-8,s=!1){return({rtol:r,atol:n,equal_nan:s}=Object.assign({rtol:r,atol:n,equal_nan:s},this)),c(e,t,((e,t)=>Number.isFinite(e)&&Number.isFinite(t)?Math.abs(e-t)<=n+r*t:e==t||s&&Number.isNaN(e)&&Number.isNaN(t)),Boolean)},allclose:function(e,t,r=1e-5,n=1e-8,s=!1){({rtol:r,atol:n,equal_nan:s}=Object.assign({rtol:r,atol:n,equal_nan:s},this));const i=new Error(""),o=(e,t)=>{if(!((e,t)=>Number.isFinite(e)&&Number.isFinite(t)?Math.abs(e-t)<=n+r*t:e==t||s&&Number.isNaN(e)&&Number.isNaN(t))(e,t))throw i;return 0};try{c(e,t,o,Number)}catch(e){if(e===i)return!1;throw e}return!0}}},17:(e,t,r)=>{const{NDArray:n}=r(696).GLOBALS;e.exports={humanReadable:function(e){if(0==e.shape.length)return e.flat[0].toString();let t=e.shape.map((e=>1)),r=30;for(let n=0;n<e.shape.length;n++){let s=t[n];t[n]=Math.min(e.shape[n],r),t[n]>s&&(r=Math.floor(r/(t[n]-s)))}let s=30;for(let r=e.shape.length-1;r>=0;r--){let n=t[r];t[r]=Math.min(e.shape[r],s),t[r]>n&&(s=Math.floor(s/(t[r]-n)))}let i=e.shape.length-1;for(;i>0&&1==e.shape[i];)i--;e.dtype==Number&&(e=n.prototype.modules.elementwise.round(e,2));let o=n.prototype.modules.jsInterface.toJS(e),a=`, shape=(${e.shape}), dtype=${e.dtype.name}`,c=function t(r,n=0,s=0){if("..."==r||s>=e.shape.length)return r;if(s==e.shape.length-1)return`[${r.join(", ")}]`;let o=s>=i?" ":"\n"+" ".repeat(n+1);const a=[];for(let e=0;e<r.length;e++){let i=t(r[e],n+1,s+1)+",";a.push(e<r.length-1?i:i.slice(0,-1))}return`[${a.join(o)}]`}(function r(n,s=0){return s==e.shape.length?n:2*t[s]>=n.length?n.map((e=>r(e,s+1))):[...n.slice(0,t[s]).map((e=>r(e,s+1))),"...",...n.slice(-t[s]).map((e=>r(e,s+1)))]}(o),3);return c=c.replace(/.*?(\n|$)/g,(e=>e.replace(/(.{60,}?,)/g,"$1\n"))).replace(/\n+/g,"\n"),c=function(e,t=","){const r=e.split("\n"),n=Array(r[0].split(t).length).fill(0);for(const e of r){let r=e.split(t);for(let e=0;e<r.length;e++)n[e]=Math.max(n[e],r[e].trim().length)}let s="";for(const e of r){let r=e.split(t);r=r.map(((e,n)=>n==r.length-1?e:e+t));for(let e=0;e<r.length;e++)s+=r[e].trim().padStart(n[e]+1).padEnd(n[e]+2);s+="\n"}return s}(`np(${c}`).trim(),c=`${c}${a})`,c}}},534:(e,t,r)=>{const{NDArray:n}=r(696).GLOBALS;function s(e,t,r,s,i=Number){const{__shape_shifts:o,__as_boolean:a,__number_collapse:c}=n.prototype;if(r=a(r),e=n.prototype.modules.basic.asarray(e),null==t)return s(e.flat);t<0&&(t=e.shape.length-1);let l=e.shape[t],u=o(e.shape)[t];const p=Array.from({length:l},(e=>[]));e.flat.forEach(((e,t)=>p[Math.floor(t/u)%l].push(e)));let h=e.size/l;const m=[];for(let e=0;e<h;e++){const t=[];for(let r=0;r<l;r++)t.push(p[r][e]);m.push(t)}const d=m.map(s);let f=[...e.shape];return r?f[t]=1:f=f.filter(((e,r)=>r!=t)),c(new n(d,f,i))}function i(e,t){return function(r,n=null,i=!1){return({axis:n,keepdims:i}=Object.assign({axis:n,keepdims:i},this)),s(r,n,i,t,e)}}const o={};o.sum=i(Number,(e=>e.reduce(((e,t)=>e+t),0))),o.product=i(Number,(e=>e.reduce(((e,t)=>e*t),1))),o.any=i(Boolean,(e=>{for(let t of e)if(t)return!0;return!1})),o.all=i(Boolean,(e=>{for(let t of e)if(!t)return!1;return!0})),o.max=i(Number,(e=>Math.max(...e))),o.min=i(Number,(e=>Math.min(...e))),o.argmax=i(Number,(e=>e.indexOf(Math.max(...e)))),o.argmin=i(Number,(e=>e.indexOf(Math.min(...e)))),o.mean=i(Number,(e=>e.reduce(((e,t)=>e+t),0)/e.length)),o.var=function(e,t=null,r=!1){({axis:t,keepdims:r}=Object.assign({axis:t,keepdims:r},this));const s=o.mean.bind({axis:t,keepdims:!0})(e),{op_binary:i}=n.prototype.modules.operators;return e=i["-"](e,s),e=i["*"](e,e),o.mean.bind({axis:t,keepdims:r})(e)},o.std=function(e,t=null,r=!1){({axis:t,keepdims:r}=Object.assign({axis:t,keepdims:r},this));const s=o.var.bind({axis:t,keepdims:r})(e),{op_binary:i}=n.prototype.modules.operators;return i["**"](s,.5)},e.exports={reduce:s,reducers:o}},378:(e,t,r)=>{const{NDArray:n}=r(696).GLOBALS,{allEq:s}=r(478);function i(e,t,r,s=Number){if(e=n.prototype.modules.basic.asarray(e),null==t)return r(e.flat);const o=e.shape.length;if(t<0&&(t=o+t),t!==o-1){const n=a(e,t,-1);return a(i(n,-1,r,s),t,-1)}let c=e.shape[t],l=n.prototype.__shape_shifts(e.shape)[t];const u=Array.from({length:c},(e=>[]));e.flat.forEach(((e,t)=>u[Math.floor(t/l)%c].push(e)));let p=e.size/c;const h=[];for(let e=0;e<p;e++){const t=[];for(let r=0;r<c;r++)t.push(u[r][e]);h.push(t)}const m=h.map(r),d=n.prototype.fromJS(m),f=[...e.shape.slice(0,t),...d.shape.slice(1),...e.shape.slice(t+1)],g=new n(d.flat,f,s);return n.prototype.__number_collapse(g)}function o(e,t=null){({axes:t}=Object.assign({axes:t},this));let r=e.shape.length;if(null==t)return o(e,Array.from({length:r},((e,t)=>t)).reverse());if(t.length!==r)throw new Error(`Axes must have length ${r}. Found ${t.length}`);let s=Array.from({length:r},(()=>-1));for(let e=0;e<r;e++)s[t[e]]=e;for(let e=0;e<r;e++)if(-1==s[e])throw new Error(`Axes must contain all dimensions. Missing ${e}.`);const i=n.prototype.__shape_shifts(e.shape);let a=t.map((t=>e.shape[t])),c=t.map((e=>i[e]));const l=[],u=new Array(a.length).fill(0);let p=0;for(;;){if(!isFinite(p))throw new Error("Programming error");l.push(p);let e=r-1;for(;e>=0&&(u[e]++,p+=c[e],!(u[e]<a[e]));)p-=c[e]*a[e],u[e]=0,e--;if(e<0)break}const h=e.flat;return new n(l.map((e=>h[e])),a,e.dtype)}function a(e,t,r){const s=(e=n.prototype.modules.basic.asarray(e)).shape.length;t<0&&(t=s+t),r<0&&(r=s+r);const i=Array.from({length:s},((e,t)=>t));return i[t]=r,i[r]=t,o(e,i)}function c(e,t=null){if(({axis:t}=Object.assign({axis:t},this)),e instanceof n&&(e=[...e]),e=e.map(n.prototype.modules.basic.asarray),null==t&&(e=e.map((e=>n.prototype.modules.basic.reshape(e,-1))),t=0),!e.length)throw new Error("Expected at least two arrays");const r=e[0].shape.length;t<0&&(t=r+t);const i=[...e[0].shape],o=[],c=i.map(((e,r)=>0==r?0:i[r==t?0:r]));for(let r of e){if(!s(r.shape.filter(((e,r)=>r!=t)),i.filter(((e,r)=>r!=t))))throw new Error(`Inconsistent input shape ${i} with respect to ${r.shape.map(((e,r)=>r==t?"?":e))}`);c[0]+=r.shape[t],r=0==t?r:a(r,t,0),o.push(...r.flat)}const l=new n(o,c);return 0==t?l:a(l,t,0)}e.exports={apply_along_axis:i,sort:function(e,t=-1){return({axis:t}=Object.assign({axis:t},this)),i(e,t,(e=>{const t=[...e];return t.sort(((e,t)=>e-t)),t}),e.dtype)},transpose:o,concatenate:c,stack:function(e,t=0){if(({axis:t}=Object.assign({axis:t},this)),e instanceof n&&(e=[...e]),!Array.isArray(e))throw new Error("Expected list of arrays. Found "+typeof e);if(!(e=e.map(n.prototype.modules.basic.asarray)).length)throw new Error("Expected at least two arrays");const r=[...e[0].shape];t<0&&(t=r.length+1+t);const i=[...r.slice(0,t),1,...r.slice(t)];console.log({shapeBroadcast:i});const o=[];for(let t of e){if(!s(t.shape,r))throw new Error(`Inconsistent input shape ${t.shape} with respect to ${t.shape}`);o.push(t.reshape(i))}return c(o,t)}}},895:(e,t,r)=>{class n{constructor(e,t,r=Number){this.shape=t,this._flat=e,this.dtype=r,this._simpleIndexes=null}_simpleIndexes;get size(){return null==this._simpleIndexes?this._flat.length:this._simpleIndexes.size}get flat(){return null==this._simpleIndexes?this._flat:this._simpleIndexes.indices.map((e=>this._flat[e]))}set flat(e){if(e.length!=this.size)throw new Error(`Length mismatch. Can't write ${e.length} values into ${this.size} available positions.`);const t=this.size;if(null==this._simpleIndexes)for(let r=0;r<t;r++)this._flat[r]=e[r];else{const r=this._simpleIndexes.indices;for(let n=0;n<t;n++)this._flat[r[n]]=e[n]}}get T(){return this.transpose()}__popKwArgs(){let e=this.__kwArgs;return void 0===e?{}:(delete this.__kwArgs,e)}withKwArgs(e){return this.__kwArgs=e,this}*[Symbol.iterator](){for(let e=0;e<this.shape[0];e++)yield this.index(e)}get length(){return this.shape[0]||0}}r(696).GLOBALS.NDArray=n;const s={};n.prototype.modules=s,s.basic=r(499),s.indexes=r(230),s.elementwise=r(90),s.print=r(17),s.reduce=r(534),s.operators=r(334),s.transform=r(378),s.jsInterface=r(897);const i=s.basic;function o(e){return function(t=null,r=!1){return({axis:t,keepdims:r}=Object.assign({axis:t,keepdims:r},this.__popKwArgs())),e(this,t,r)}}function a(e){return function(t,r=null){return({out:r}=Object.assign({out:r},this.__popKwArgs())),e(this,t,r)}}function c(e){return function(t=null){return({out:t}=Object.assign({out:t},this.__popKwArgs())),e(this,t)}}function l(e){return function(...t){return e(this,...t)}}n.prototype.reshape=function(e,...t){return i.reshape(this,e,...t)},n.prototype.ravel=function(){return i.ravel(this)},n.prototype.copy=function(){return i.copy(this)},n.prototype.__shape_shifts=function(e){const t=Array.from({length:e.length},(e=>0));t[e.length-1]=1;for(let r=e.length-2;r>=0;r--)t[r]=t[r+1]*e[r+1];return t},n.prototype.__number_collapse=function(e,t=!1){if(!e.shape.length)return e.flat[0];if(t)throw new Error(`Expected constant. Got array with shape ${e.shape}`);return e},n.prototype.__parse_shape=function(e){if(Array.isArray(e))return e;if(e instanceof n){if(e.shape.length>1)throw new Error(`Expected flat list. Got array with shape ${e.shape}`);return e.flat}if("number"==typeof e)return[e];throw new Error(`Expected list. Got ${e}`)},n.prototype.__as_boolean=function(e){if(e instanceof n)e=n.prototype.__number_collapse(e,!0);else if("string"==typeof e)throw new Error(`'string' object can not be interpreted as boolean: ${e}`);return!!(0+e)},n.prototype.__as_number=function(e){if(e instanceof n)e=n.prototype.__number_collapse(e,!0);else if("string"==typeof e)throw new Error(`'string' object can not be interpreted as boolean: ${e}`);return parseFloat(e)},n.prototype._new=function(e,t,r){const s=(e=n.prototype.__parse_shape(e)).reduce(((e,t)=>e*t),1),i=Array.from({length:s},t);return new n(i,e,r)},n.prototype.index=function(...e){return s.indexes.index(this,...e)},n.prototype.toString=function(){return s.print.humanReadable(this)},n.prototype.sum=o(s.reduce.reducers.sum),n.prototype.product=o(s.reduce.reducers.product),n.prototype.any=o(s.reduce.reducers.any),n.prototype.all=o(s.reduce.reducers.all),n.prototype.max=o(s.reduce.reducers.max),n.prototype.min=o(s.reduce.reducers.min),n.prototype.argmax=o(s.reduce.reducers.argmax),n.prototype.argmin=o(s.reduce.reducers.argmin),n.prototype.mean=o(s.reduce.reducers.mean),n.prototype.var=o(s.reduce.reducers.var),n.prototype.std=o(s.reduce.reducers.std),n.prototype._binary_operation=s.operators.binary_operation,n.prototype.add=a(s.operators.op_binary["+"]),n.prototype.subtract=a(s.operators.op_binary["-"]),n.prototype.multiply=a(s.operators.op_binary["*"]),n.prototype.divide=a(s.operators.op_binary["/"]),n.prototype.mod=a(s.operators.op_binary["%"]),n.prototype.divide_int=a(s.operators.op_binary["//"]),n.prototype.pow=a(s.operators.op_binary["**"]),n.prototype.maximum=a(s.operators.op_binary["↑"]),n.prototype.minimum=a(s.operators.op_binary["↓"]),n.prototype.bitwise_or=a(s.operators.op_binary["|"]),n.prototype.bitwise_and=a(s.operators.op_binary["&"]),n.prototype.bitwise_xor=a(s.operators.op_binary["^"]),n.prototype.bitwise_shift_left=a(s.operators.op_binary["<<"]),n.prototype.bitwise_shift_right=a(s.operators.op_binary[">>"]),n.prototype.logical_or=a(s.operators.op_binary.or),n.prototype.logical_and=a(s.operators.op_binary.and),n.prototype.logical_xor=a(s.operators.op_binary.xor),n.prototype.greater=a(s.operators.op_binary[">"]),n.prototype.less=a(s.operators.op_binary["<"]),n.prototype.greater_equal=a(s.operators.op_binary[">="]),n.prototype.less_equal=a(s.operators.op_binary["<="]),n.prototype.equal=a(s.operators.op_binary["=="]),n.prototype.not_equal=a(s.operators.op_binary["!="]),n.prototype.bitwise_not=c(s.operators.op_unary["~"]),n.prototype.logical_not=c(s.operators.op_unary.not),n.prototype.isclose=s.operators.isclose,n.prototype.allclose=s.operators.allclose,n.prototype.assign=l(s.operators.op_assign["="]),n.prototype.add_assign=l(s.operators.op_assign["+="]),n.prototype.subtract_assign=l(s.operators.op_assign["-="]),n.prototype.multiply_assign=l(s.operators.op_assign["*="]),n.prototype.divide_assign=l(s.operators.op_assign["/="]),n.prototype.mod_assign=l(s.operators.op_assign["%="]),n.prototype.divide_int_assign=l(s.operators.op_assign["//="]),n.prototype.pow_assign=l(s.operators.op_assign["**="]),n.prototype.maximum_assign=l(s.operators.op_assign["↑="]),n.prototype.minimum_assign=l(s.operators.op_assign["↓="]),n.prototype.bitwise_or_assign=l(s.operators.op_assign["|="]),n.prototype.bitwise_and_assign=l(s.operators.op_assign["&="]),n.prototype.bitwise_shift_left_assign=l(s.operators.op_assign["<<="]),n.prototype.bitwise_shift_right_assign=l(s.operators.op_assign[">>="]),n.prototype.logical_or_assign=l(s.operators.op_assign["or="]),n.prototype.logical_and_assign=l(s.operators.op_assign["and="]),n.prototype.JS=function(){return s.jsInterface.toJS(this)},n.prototype.fromJS=function(e){return s.jsInterface.fromJS(e)},n.prototype.round=function(e=0){return({decimals:e}=Object.assign({decimals:e},this.__popKwArgs())),s.elementwise.round(this,e)},n.prototype.transpose=function(e=null){return({axes:e}=Object.assign({axes:e},this.__popKwArgs())),s.transform.transpose(this,e)},n.prototype.sort=function(e=-1){return({axis:e}=Object.assign({axis:e},this.__popKwArgs())),s.transform.sort(this,e),null},e.exports=n},696:e=>{e.exports={GLOBALS:{NDArray:null,np:null}}},258:(e,t,r)=>{const{NDArray:n,np:s}=r(696).GLOBALS;var i=r(636);const o={};o.grammar=String.raw`
ArrayGrammar {
  Instruction
  = Variable "[" Slice "]" AssignSymbol ArithmeticLogicExp -- sliceAssignment
  | ArithmeticLogicExp                       -- expression
  
  Variable
   = "#" digit+ "#"
  
  AssignSymbol
  ="="|"+="|"-="|"/="|"%="|"&="|"|="|"^="|"@="
  
  /* Declaration in precedence order (weakest first) */
  ArithmeticLogicExp = Precedence11

  /* https://docs.python.org/3/reference/expressions.html */
  Operator11 = "<" | "<=" | ">" | ">=" | "!=" | "=="
  Operator10 = "|"
  Operator09 = "^"
  Operator08 = "&"
  Operator07 = "<<" | ">>"
  Operator06 = "+" | "-"
  Operator05 = "*" | "@" | "/" | "//" | "%"
  Operator04 = "~" /* Unary */
  Operator03 = "+" | "-" /* Unary. Special treatment to prevent "-1.3" to be "-(array of 1.3)" */
  Operator02 = "**"
  /* Operator01 = "x[index]" | "x[index:index]" | "x(arguments...)" | "x.attribute" */
  /* Operator00 = "(expressions...)" */

  Precedence11 = Precedence11 Operator11 Precedence10 | "" "" Precedence10
  Precedence10 = Precedence10 Operator10 Precedence09 | "" "" Precedence09
  Precedence09 = Precedence09 Operator09 Precedence08 | "" "" Precedence08
  Precedence08 = Precedence08 Operator08 Precedence07 | "" "" Precedence07
  Precedence07 = Precedence07 Operator07 Precedence06 | "" "" Precedence06
  Precedence06 = Precedence06 Operator06 Precedence05 | "" "" Precedence05
  Precedence05 = Precedence05 Operator05 Precedence04 | "" "" Precedence04
  Precedence04 = ""           Operator04 Precedence03 | "" "" Precedence03 /* Unary */
  Precedence03 = ""           Operator03 Precedence02 | "" "" Precedence02 /* Special */
  Precedence02 = Precedence02 Operator02 Precedence03 | "" "" Precedence01
  Precedence01 = Arr
  
  Parenthesis = "(" ArithmeticLogicExp ")"
  Arr
    = Arr "." Name CallArgs     -- method
    | Arr "." Name              -- attribute
    | Arr "[" Slice "]"         -- slice
    | Parenthesis
    | Name ("." Name)* CallArgs -- call
    | number
    | Variable

  Name  (an identifier)
    = (letter|"_") (letter|"_"|digit)*

  number  (a number)
    = ("+"|"-")? digit* "." digit+ "E" ("+"|"-")? "digit+"
    | ("+"|"-")? digit* "." digit+ "e" ("+"|"-")? "digit+"
    | ("+"|"-")? digit* "." digit+  ""  ""        ""
    | ("+"|"-")? digit+ ""  ""      ""  ""        ""
  
  int (an integer) = ""  digit+ | "-" digit+ | "+" digit+

  CallArgs // Using empty strings instead of separate rules
   = "(" Args ","  KwArgs ","? ")"
   | "(" Args ","? ""      ""  ")"
   | "(" ""   ","? KwArgs ","? ")"
   | "(" ""    ""  ""      ""  ")"
   
  Args = NonemptyListOf<ArgValue, ",">
  KwArgs = NonemptyListOf<KwArg, ",">
  KwArg = Name "=" ArgValue

  ArgValue = Constant | JsArray | ArithmeticLogicExp | String
  Constant = "True" | "False" | "None" | "np.nan" | "np.inf"
  JsArray
    = "[" ListOf<ArgValue, ","> ","? "]"
    | "(" ListOf<ArgValue, ","> ","? ")"

  String = "\'" any* "\'" | "\"" any* "\""
   
  Slice = NonemptyListOf<SliceTerm, ",">
  SliceTerm
    = SliceRange
    | (":" | "..." | "None") -- constant
    | JsArray
    | ArithmeticLogicExp
  
  SliceRange
    = int ":" int ":" int
    | int ":" int ""  ""
    | int ":" ""  ":" int
    | int ":" ""  ""  ""
    | ""  ":" int ":" int
    | ""  ":" int ""  ""
    | ""  ":" ""  ":" int
    | ""  ":" ""  ""  ""
}
`,o.ohmGrammar=i.grammar(o.grammar),o.__makeSemantics=()=>{const e=[],t={Instruction_sliceAssignment(e,t,r,s,i,o){const a=e.parse(),c=o.parse(),l=i.sourceString,u=r.parse();let p=n.prototype.modules.basic.asarray(a);if(n.prototype.modules.operators.op_assign[l](a,c,u),p!==a){for(p=n.prototype.modules.jsInterface.toJS(p);a.length;)a.pop();a.push(...a)}return null},Instruction_expression(e){let t=e.parse();return"number"==typeof t||"boolean"==typeof t||Array.isArray(t)||t instanceof n&&(t=n.prototype.__number_collapse(t)),t},Precedence11:r,Precedence10:r,Precedence09:r,Precedence08:r,Precedence07:r,Precedence06:r,Precedence05:r,Precedence04:i,Precedence03:i,Precedence02:r,number:function(e,t,r,n,s,i,o){return parseFloat(this.sourceString)},Arr_slice(e,t,r,n){const s=e.parse(),i=r.parse();return s.index(...i)},SliceTerm_constant:e=>e.sourceString,Arr_call(e,t,r,n){let i=e.sourceString+t.sourceString;"np."==i.slice(0,3)&&(i=i.slice(3));const o=i.split(".").reduce(((e,t)=>e[t]),s);if(void 0===o)throw new Error(`Unrecognized function ${i}`);const{args:a,kwArgs:c}=n.parse();return o.bind(c)(...a)},Arr_method(e,t,r,n){let s=e.parse(),i=r.sourceString;const{args:o,kwArgs:a}=n.parse();if(void 0===s[i])throw new Error(`Unrecognized method ${i}`);return s.withKwArgs(a)[i](...o)},Parenthesis:(e,t,r)=>t.parse(),Arr_attribute:(e,t,r)=>e.parse()[r.sourceString],Variable(t,r,i){const o=parseInt(r.sourceString);let a=e[o];const c=Array.isArray(a)&&a.length&&a[0]instanceof n;return Array.isArray(a)&&!c&&(a=s.array(a)),a},int(e,t){const r=parseInt(t.sourceString);return"-"==e.sourceString?-r:r},SliceRange(e,t,r,n,s){return this.sourceString},Constant(e){switch(e.sourceString){case"True":return!0;case"False":return!1;case"None":return null;case"np.nan":return Number.NaN;case"np.inf":return Number.POSITIVE_INFINITY}throw new Error(`Unrecognized constant ${e.sourceString}`)},String:(e,t,r)=>t.sourceString,CallArgs(e,t,r,n,s,i){const o=t.parse()||[];let a=n.parse()||[];return{args:o,kwArgs:Object.fromEntries(a)}},KwArg:(e,t,r)=>[e.sourceString,r.parse()],NonemptyListOf:(e,t,r)=>[e,...r.children].map((e=>e.parse())),JsArray(e,t,r,s){const i=t.parse(),{toJS:o}=n.prototype.modules.jsInterface;for(let e in i)i[e]instanceof n&&(i[e]=o(i[e]));return i},_terminal:()=>null};function r(e,t,r){const s=e.parse(),i=r.parse(),o=t.sourceString;if(""==o&&null===s)return i;const{op_binary:a}=n.prototype.modules.operators;return a[o](s,i)}function i(e,t,r){const s=r.parse(),i=t.sourceString;if(""==i)return s;const{op_binary:o,unary_op:a}=n.prototype.modules.operators;switch(i){case"+":return s;case"-":return o["*"](-1,s);case"~":return a["~"](s);case"!":return a.not(s)}throw new Error(`Programming Error: ${i}`)}const{ohmGrammar:a}=o,c=a.createSemantics();return c.addOperation("parse",t),{parse:function(t,...r){let n=0;const s=t.join("###").replace(/###/g,(()=>`#${n++}#`));e.length=0,e.push(...r);const i=a.match(s);if(!i.succeeded())throw new Error(i.message);return c(i).parse()},ohmSemantics:c,semantics:t,semanticVariables:e,busy:0}},o.__parser_pool=[o.__makeSemantics()],o.parse=function(e,...t){const{__parser_pool:r}=o;for(let n=0;n<r.length;n++){const s=r[n];if(0==s.busy++)try{return s.parse(e,...t)}finally{s.busy=0}n==r.length&&r.push(o.__makeSemantics())}},e.exports=o},138:(e,t,r)=>{const n=function(e,...t){const r="Usage example: np`np.arange(10)+${5}` or np([0,1,2]).";if("number"==typeof e)return e;if(e instanceof n.NDArray)return e;if(!Array.isArray(e))throw new Error(`Expected template or array. ${r}`);if(!e.length)throw new Error(`Expected argument. ${r}`);if("string"==typeof e[0]){if(t.length+1!=e.length)throw new Error(`Wrong input. ${r}`);return n.modules.grammar.parse(e,...t)}if(t.length)throw new Error(`Wrong input. ${r}`);return n.asarray(e)};r(696).GLOBALS.np=n;const s=r(895);n.NDArray=s,n.modules={NDArray:s,grammar:r(258),constructors:r(89),jsUtils:r(478),random:r(593)},n.random=n.modules.random;const i=s.prototype.modules.jsInterface;n.fromJS=i.fromJS,n.JS=function(e,...t){return i.toJS(n(e,...t))},n.ravel=s.prototype.modules.basic.ravel,n.reshape=s.prototype.modules.basic.reshape,n.array=s.prototype.modules.basic.array,n.asarray=s.prototype.modules.basic.asarray;const o=s.prototype.modules.reduce;n.sum=o.reducers.sum,n.product=o.reducers.product,n.prod=n.product,n.any=o.reducers.any,n.all=o.reducers.all,n.max=o.reducers.max,n.min=o.reducers.min,n.argmax=o.reducers.argmax,n.argmin=o.reducers.argmin,n.mean=o.reducers.mean,n.var=o.reducers.var,n.std=o.reducers.std;const a=s.prototype.modules.transform;n.transpose=a.transpose,n.apply_along_axis=a.apply_along_axis,n.sort=a.sort,n.concatenate=a.concatenate,n.stack=a.stack;const c=s.prototype.modules.operators;n.add=c.op_binary["+"],n.subtract=c.op_binary["-"],n.multiply=c.op_binary["*"],n.divide=c.op_binary["/"],n.mod=c.op_binary["%"],n.divide_int=c.op_binary["//"],n.pow=c.op_binary["**"],n.bitwise_or=c.op_binary["|"],n.bitwise_and=c.op_binary["&"],n.bitwise_xor=c.op_binary["^"],n.bitwise_shift_left=c.op_binary["<<"],n.bitwise_shift_right=c.op_binary[">>"],n.greater=c.op_binary[">"],n.less=c.op_binary["<"],n.greater_equal=c.op_binary[">="],n.less_equal=c.op_binary["<="],n.equal=c.op_binary["=="],n.not_equal=c.op_binary["!="],n.maximum=c.op_binary["↑"],n.minimum=c.op_binary["↓"],n.logical_or=c.op_binary.or,n.logical_and=c.op_binary.and,n.bitwise_not=c.op_unary["~"],n.logical_not=c.op_unary.not;const l=s.prototype.modules.elementwise;n.sign=l.__make_elementwise(Math.sign),n.sqrt=l.__make_elementwise(Math.sqrt),n.square=l.__make_elementwise((e=>e*e)),n.abs=l.__make_elementwise(Math.abs),n.exp=l.__make_elementwise(Math.exp),n.log=l.__make_elementwise(Math.log),n.log2=l.__make_elementwise(Math.log2),n.log10=l.__make_elementwise(Math.log10),n.log1p=l.__make_elementwise(Math.log1p),n.sin=l.__make_elementwise(Math.sin),n.cos=l.__make_elementwise(Math.cos),n.tan=l.__make_elementwise(Math.tan),n.asin=l.__make_elementwise(Math.asin),n.acos=l.__make_elementwise(Math.acos),n.atan=l.__make_elementwise(Math.atan),n.atan2=l.__make_elementwise(Math.atan2),n.cosh=l.__make_elementwise(Math.cosh),n.sinh=l.__make_elementwise(Math.sinh),n.tanh=l.__make_elementwise(Math.tanh),n.acosh=l.__make_elementwise(Math.acosh),n.asinh=l.__make_elementwise(Math.asinh),n.atanh=l.__make_elementwise(Math.atanh),n.round=l.round;const u=n.modules.constructors;n.empty=u.empty,n.zeros=u.zeros,n.ones=u.ones,n.arange=u.arange,n.linspace=u.linspace,n.geomspace=u.geomspace,e.exports=n},478:e=>{function t(e,t,r){const n=[[e,t,[],0]];let s;for(;;){const e=n.pop();if(!e)return!0;const[t,i,o,a]=e;if(Array.isArray(t)&&Array.isArray(i)&&t.length==i.length)for(let e in t){const r=[];o.push(r),n.push([t[e],i[e],r,a+1])}else o.push(r(t,i));if(a>1e4&&Array.isArray(t)){if(s=s||[],s.includes(t))throw new Error(`Circular reference found. ${t}`);s[a-1e4]=t}}}e.exports={ravel:function(e){const t=[[e,0]],r=[];let n;for(;;){const e=t.pop();if(!e)break;const[s,i]=e;if(i>1e4&&Array.isArray(s)){if(n=n||[],n.includes(s))throw new Error(`Circular reference found. ${s}`);n[i-1e4]=s}Array.isArray(s)?t.push(...s.map((e=>[e,i+1]))):r.push(s)}return r},allEq:function(e,r,n=!1){const s=new Error(""),i=(e,t)=>{if(e!==t&&!(n&&Number.isNaN(e)&&Number.isNaN(t)))throw s;return 0};try{t(e,r,i)}catch(e){if(e===s)return!1;throw e}return!0},allClose:function(e,r,n=1e-5,s=1e-8,i=!1){const o=new Error(""),a=(e,t)=>{if(!((e,t)=>Number.isFinite(e)&&Number.isFinite(t)?Math.abs(e-t)<=s+n*Math.abs(t):e===t||i&&Number.isNaN(e)&&Number.isNaN(t))(e,t))throw o;return 0};try{t(e,r,a)}catch(e){if(e===o)return!1;throw e}return!0},binary_operation:t}},593:(e,t,r)=>{const{np:n}=r(696).GLOBALS;function s(e){return n.NDArray.prototype._new(e,(e=>Math.random()),Number)}function i(e){const t=[...e];return function(e){for(let t=e.length-1;t>=0;t--){const r=Math.floor(Math.random()*(t+1));[e[t],e[r]]=[e[r],e[t]]}}(t),t}e.exports={random:s,uniform:function(e,t,r){return n.add(e,n.multiply(s(r),t-e))},exponential:function(e,t){return n.multiply(e,n.subtract(0,n.log(s(t))))},randn:function(e){const t=function(e){const t=[];for(;t.length<e;){let e=2*Math.random()-1,r=2*Math.random()-1,n=e*e+r*r;if(n>=1)continue;let s=Math.sqrt(-2*Math.log(n)/n)*e,i=Math.sqrt(-2*Math.log(n)/n)*r;t.push(s),t.push(i)}return t.length>e&&t.pop(),t}(n.prod(e));return new n.NDArray(t,e,Number)},normal:function(e,t,r){return n.add(e,n.multiply(t,r))},shuffle:function(e){e.assign(function(e){if(0==e.shape.length)return e;if(1==e.shape.length){const t=i(e.flat);return new n.NDArray(t,e.shape,e.dtype)}const t=i(Array.from({length:e.length},((e,t)=>t))),r=n.empty(e.shape,e.dtype);for(let n=0;n<e.length;n++)r.assign([n],e.index(t[n]));return r}(e))}}},636:(e,t)=>{"use strict";function r(e){const t=e||"";return function(){throw new Error("this method "+t+" is abstract! (it has no implementation in class "+this.constructor.name+")")}}function n(e,t){if(!e)throw new Error(t||"Assertion failed")}function s(e,t,r){let n;Object.defineProperty(e,t,{get(){return n||(n=r.call(this)),n}})}function i(e,t){const r=[];for(;t-- >0;)r.push(e());return r}function o(e,t){return new Array(t+1).join(e)}function a(e,t){return i((()=>e),t)}function c(e){const t=[];for(let r=0;r<e.length;r++){const n=e[r];e.lastIndexOf(n)!==r&&t.indexOf(n)<0&&t.push(n)}return t}function l(e){const t=[];return e.forEach((e=>{t.indexOf(e)<0&&t.push(e)})),t}function u(e){const t=e[0];return t===t.toUpperCase()}function p(e){return!u(e)}function h(e,t,r){const n=r||" ";return e.length<t?o(n,t-e.length)+e:e}function m(){this.strings=[]}Object.defineProperty(t,"__esModule",{value:!0}),m.prototype.append=function(e){this.strings.push(e)},m.prototype.contents=function(){return this.strings.join("")};const d=e=>String.fromCodePoint(parseInt(e,16));function f(e){if("\\"!==e.charAt(0))return e;switch(e.charAt(1)){case"b":return"\b";case"f":return"\f";case"n":return"\n";case"r":return"\r";case"t":return"\t";case"v":return"\v";case"x":return d(e.slice(2,4));case"u":return"{"===e.charAt(2)?d(e.slice(3,-1)):d(e.slice(2,6));default:return e.charAt(1)}}function g(e){if(null==e)return String(e);const t=Object.prototype.toString.call(e);try{let r;return r=e.constructor&&e.constructor.name?e.constructor.name:0===t.indexOf("[object ")?t.slice(8,-1):typeof e,r+": "+JSON.stringify(String(e))}catch(e){return t}}var y=Object.freeze({__proto__:null,abstract:r,assert:n,defineLazyProperty:s,clone:function(e){return e?Object.assign({},e):e},repeatFn:i,repeatStr:o,repeat:a,getDuplicates:c,copyWithoutDuplicates:l,isSyntactic:u,isLexical:p,padLeft:h,StringBuffer:m,unescapeCodePoint:f,unexpectedObjToString:g});const v={Lu:/\p{Lu}/u,Ll:/\p{Ll}/u,Lt:/\p{Lt}/u,Lm:/\p{Lm}/u,Lo:/\p{Lo}/u,Nl:/\p{Nl}/u,Nd:/\p{Nd}/u,Mn:/\p{Mn}/u,Mc:/\p{Mc}/u,Pc:/\p{Pc}/u,Zs:/\p{Zs}/u,L:/\p{Letter}/u,Ltmo:/\p{Lt}|\p{Lm}|\p{Lo}/u};class _{constructor(){if(this.constructor===_)throw new Error("PExpr cannot be instantiated -- it's abstract")}withSource(e){return e&&(this.source=e.trimmed()),this}}const I=Object.create(_.prototype),x=Object.create(_.prototype);class b extends _{constructor(e){super(),this.obj=e}}class w extends _{constructor(e,t){super(),this.from=e,this.to=t,this.matchCodePoint=e.length>1||t.length>1}}class S extends _{constructor(e){super(),this.index=e}}class A extends _{constructor(e){super(),this.terms=e}}class N extends A{constructor(e,t,r){super([r,e.rules[t].body]),this.superGrammar=e,this.name=t,this.body=r}}class O extends A{constructor(e,t,r,n){const s=e.rules[t].body;super([...r,s,...n]),this.superGrammar=e,this.ruleName=t,this.expansionPos=r.length}}class L extends _{constructor(e){super(),this.factors=e}}class E extends _{constructor(e){super(),this.expr=e}}class P extends E{}class R extends E{}class F extends E{}P.prototype.operator="*",R.prototype.operator="+",F.prototype.operator="?",P.prototype.minNumMatches=0,R.prototype.minNumMatches=1,F.prototype.minNumMatches=0,P.prototype.maxNumMatches=Number.POSITIVE_INFINITY,R.prototype.maxNumMatches=Number.POSITIVE_INFINITY,F.prototype.maxNumMatches=1;class k extends _{constructor(e){super(),this.expr=e}}class C extends _{constructor(e){super(),this.expr=e}}class M extends _{constructor(e){super(),this.expr=e}}class D extends _{constructor(e,t=[]){super(),this.ruleName=e,this.args=t}isSyntactic(){return u(this.ruleName)}toMemoKey(){return this._memoKey||Object.defineProperty(this,"_memoKey",{value:this.toString()}),this._memoKey}}class j extends _{constructor(e){super(),this.category=e,this.pattern=v[e]}}function T(e,t){let r;return t?(r=new Error(t.getLineAndColumnMessage()+e),r.shortMessage=e,r.interval=t):r=new Error(e),r}function B(){return T("Interval sources don't match")}function $(e,t,r){return T("Rule "+e+" is not declared in grammar "+t,r)}function G(e,t,r,n){let s="Duplicate declaration for rule '"+e+"' in grammar '"+t+"'";return t!==r&&(s+=" (originally declared in '"+r+"')"),T(s,n)}function q(e,t,r,n){return T("Wrong number of parameters for rule "+e+" (expected "+t+", got "+r+")",n)}function z(e,t,r){return T("Duplicate parameter names in rule "+e+": "+t.join(", "),r)}function U(e,t){return T("Incorrect argument type: expected "+e,t.source)}function K(e,t){const r=t.length>0?t[t.length-1].args:[];let n="Nullable expression "+e.expr.substituteParams(r)+" is not allowed inside '"+e.operator+"' (possible infinite loop)";return t.length>0&&(n+="\nApplication stack (most recent application last):\n"+t.map((e=>new D(e.ruleName,e.args))).join("\n")),T(n,e.expr.source)}function V(e,t,r,n){return T("Rule "+e+" involves an alternation which has inconsistent arity (expected "+t+", got "+r+")",n.source)}function J(e,t,r){const n=e.length;return(e.slice(0,r)+t+e.slice(r+t.length)).substr(0,n)}function H(...e){const t=this,{offset:r}=t,{repeatStr:s}=y,i=new m;i.append("Line "+t.lineNum+", col "+t.colNum+":\n");const o=function(e){let t=0;return e.map((e=>{const r=e.toString();return t=Math.max(t,r.length),r})).map((e=>h(e,t)))}([null==t.prevLine?0:t.lineNum-1,t.lineNum,null==t.nextLine?0:t.lineNum+1]),a=(e,t,r)=>{i.append(r+o[e]+" | "+t+"\n")};null!=t.prevLine&&a(0,t.prevLine,"  "),a(1,t.line,"> ");const c=t.line.length;let l=s(" ",c+1);for(let i=0;i<e.length;++i){let o=e[i][0],a=e[i][1];n(o>=0&&o<=a,"range start must be >= 0 and <= end");const u=r-t.colNum+1;o=Math.max(0,o-u),a=Math.min(a-u,c),l=J(l,s("~",a-o),o)}const u=2+o[1].length+3;return i.append(s(" ",u)),l=J(l,"^",t.colNum-1),i.append(l.replace(/ +$/,"")+"\n"),null!=t.nextLine&&a(2,t.nextLine,"  "),i.contents()}let W=[];function Q(e){W.push(e)}function Z(e,t){let r=1,n=1,s=0,i=0,o=null,a=null,c=-1;for(;s<t;){const t=e.charAt(s++);"\n"===t?(r++,n=1,c=i,i=s):"\r"!==t&&n++}let l=e.indexOf("\n",i);if(-1===l)l=e.length;else{const t=e.indexOf("\n",l+1);o=-1===t?e.slice(l):e.slice(l,t),o=o.replace(/^\r?\n/,"").replace(/\r$/,"")}return c>=0&&(a=e.slice(c,i).replace(/\r?\n$/,"")),{offset:t,lineNum:r,colNum:n,line:e.slice(i,l).replace(/\r$/,""),prevLine:a,nextLine:o,toString:H}}function Y(e,t,...r){return Z(e,t).toString(...r)}const X=(()=>{let e=0;return t=>""+t+e++})();class ee{constructor(e,t,r){this.sourceString=e,this.startIdx=t,this.endIdx=r}get contents(){return void 0===this._contents&&(this._contents=this.sourceString.slice(this.startIdx,this.endIdx)),this._contents}get length(){return this.endIdx-this.startIdx}coverageWith(...e){return ee.coverage(...e,this)}collapsedLeft(){return new ee(this.sourceString,this.startIdx,this.startIdx)}collapsedRight(){return new ee(this.sourceString,this.endIdx,this.endIdx)}getLineAndColumn(){return Z(this.sourceString,this.startIdx)}getLineAndColumnMessage(){const e=[this.startIdx,this.endIdx];return Y(this.sourceString,this.startIdx,e)}minus(e){if(this.sourceString!==e.sourceString)throw B();return this.startIdx===e.startIdx&&this.endIdx===e.endIdx?[]:this.startIdx<e.startIdx&&e.endIdx<this.endIdx?[new ee(this.sourceString,this.startIdx,e.startIdx),new ee(this.sourceString,e.endIdx,this.endIdx)]:this.startIdx<e.endIdx&&e.endIdx<this.endIdx?[new ee(this.sourceString,e.endIdx,this.endIdx)]:this.startIdx<e.startIdx&&e.startIdx<this.endIdx?[new ee(this.sourceString,this.startIdx,e.startIdx)]:[this]}relativeTo(e){if(this.sourceString!==e.sourceString)throw B();return n(this.startIdx>=e.startIdx&&this.endIdx<=e.endIdx,"other interval does not cover this one"),new ee(this.sourceString,this.startIdx-e.startIdx,this.endIdx-e.startIdx)}trimmed(){const{contents:e}=this,t=this.startIdx+e.match(/^\s*/)[0].length,r=this.endIdx-e.match(/\s*$/)[0].length;return new ee(this.sourceString,t,r)}subInterval(e,t){const r=this.startIdx+e;return new ee(this.sourceString,r,r+t)}}ee.coverage=function(e,...t){let{startIdx:r,endIdx:n}=e;for(const s of t){if(s.sourceString!==e.sourceString)throw B();r=Math.min(r,s.startIdx),n=Math.max(n,s.endIdx)}return new ee(e.sourceString,r,n)};class te{constructor(e){this.source=e,this.pos=0,this.examinedLength=0}atEnd(){const e=this.pos>=this.source.length;return this.examinedLength=Math.max(this.examinedLength,this.pos+1),e}next(){const e=this.source[this.pos++];return this.examinedLength=Math.max(this.examinedLength,this.pos),e}nextCharCode(){const e=this.next();return e&&e.charCodeAt(0)}nextCodePoint(){const e=this.source.slice(this.pos++).codePointAt(0);return e>65535&&(this.pos+=1),this.examinedLength=Math.max(this.examinedLength,this.pos),e}matchString(e,t){let r;if(t){for(r=0;r<e.length;r++){const t=this.next(),n=e[r];if(null==t||t.toUpperCase()!==n.toUpperCase())return!1}return!0}for(r=0;r<e.length;r++)if(this.next()!==e[r])return!1;return!0}sourceSlice(e,t){return this.source.slice(e,t)}interval(e,t){return new ee(this.source,e,t||this.pos)}}class re{constructor(e,t,r,n,i,o,a){this.matcher=e,this.input=t,this.startExpr=r,this._cst=n,this._cstOffset=i,this._rightmostFailurePosition=o,this._rightmostFailures=a,this.failed()&&(s(this,"message",(function(){const e="Expected "+this.getExpectedText();return Y(this.input,this.getRightmostFailurePosition())+e})),s(this,"shortMessage",(function(){const e="expected "+this.getExpectedText(),t=Z(this.input,this.getRightmostFailurePosition());return"Line "+t.lineNum+", col "+t.colNum+": "+e})))}succeeded(){return!!this._cst}failed(){return!this.succeeded()}getRightmostFailurePosition(){return this._rightmostFailurePosition}getRightmostFailures(){if(!this._rightmostFailures){this.matcher.setInput(this.input);const e=this.matcher._match(this.startExpr,{tracing:!1,positionToRecordFailures:this.getRightmostFailurePosition()});this._rightmostFailures=e.getRightmostFailures()}return this._rightmostFailures}toString(){return this.succeeded()?"[match succeeded]":"[match failed at position "+this.getRightmostFailurePosition()+"]"}getExpectedText(){if(this.succeeded())throw new Error("cannot get expected text of a successful MatchResult");const e=new m;let t=this.getRightmostFailures();t=t.filter((e=>!e.isFluffy()));for(let r=0;r<t.length;r++)r>0&&(r===t.length-1?e.append(t.length>2?", or ":" or "):e.append(", ")),e.append(t[r].toString());return e.contents()}getInterval(){const e=this.getRightmostFailurePosition();return new ee(this.input,e,e)}}class ne{constructor(){this.applicationMemoKeyStack=[],this.memo={},this.maxExaminedLength=0,this.maxRightmostFailureOffset=-1,this.currentLeftRecursion=void 0}isActive(e){return this.applicationMemoKeyStack.indexOf(e.toMemoKey())>=0}enter(e){this.applicationMemoKeyStack.push(e.toMemoKey())}exit(){this.applicationMemoKeyStack.pop()}startLeftRecursion(e,t){t.isLeftRecursion=!0,t.headApplication=e,t.nextLeftRecursion=this.currentLeftRecursion,this.currentLeftRecursion=t;const{applicationMemoKeyStack:r}=this,n=r.indexOf(e.toMemoKey())+1,s=r.slice(n);t.isInvolved=function(e){return s.indexOf(e)>=0},t.updateInvolvedApplicationMemoKeys=function(){for(let e=n;e<r.length;e++){const t=r[e];this.isInvolved(t)||s.push(t)}}}endLeftRecursion(){this.currentLeftRecursion=this.currentLeftRecursion.nextLeftRecursion}shouldUseMemoizedResult(e){if(!e.isLeftRecursion)return!0;const{applicationMemoKeyStack:t}=this;for(let r=0;r<t.length;r++){const n=t[r];if(e.isInvolved(n))return!1}return!0}memoize(e,t){return this.memo[e]=t,this.maxExaminedLength=Math.max(this.maxExaminedLength,t.examinedLength),this.maxRightmostFailureOffset=Math.max(this.maxRightmostFailureOffset,t.rightmostFailureOffset),t}clearObsoleteEntries(e,t){if(e+this.maxExaminedLength<=t)return;const{memo:r}=this;this.maxExaminedLength=0,this.maxRightmostFailureOffset=-1,Object.keys(r).forEach((n=>{const s=r[n];e+s.examinedLength>t?delete r[n]:(this.maxExaminedLength=Math.max(this.maxExaminedLength,s.examinedLength),this.maxRightmostFailureOffset=Math.max(this.maxRightmostFailureOffset,s.rightmostFailureOffset))}))}}const se={succeeded:1,isRootNode:2,isImplicitSpaces:4,isMemoized:8,isHeadOfLeftRecursion:16,terminatesLR:32};function ie(e){return"string"==typeof e?e.replace(/ /g,"⋅").replace(/\t/g,"␉").replace(/\n/g,"␊").replace(/\r/g,"␍"):String(e)}class oe{constructor(e,t,r,n,s,i,o){this.input=e,this.pos=this.pos1=t,this.pos2=r,this.source=new ee(e,t,r),this.expr=n,this.bindings=i,this.children=o||[],this.terminatingLREntry=null,this._flags=s?se.succeeded:0}get displayString(){return this.expr.toDisplayString()}clone(){return this.cloneWithExpr(this.expr)}cloneWithExpr(e){const t=new oe(this.input,this.pos,this.pos2,e,this.succeeded,this.bindings,this.children);return t.isHeadOfLeftRecursion=this.isHeadOfLeftRecursion,t.isImplicitSpaces=this.isImplicitSpaces,t.isMemoized=this.isMemoized,t.isRootNode=this.isRootNode,t.terminatesLR=this.terminatesLR,t.terminatingLREntry=this.terminatingLREntry,t}recordLRTermination(e,t){this.terminatingLREntry=new oe(this.input,this.pos,this.pos2,this.expr,!1,[t],[e]),this.terminatingLREntry.terminatesLR=!0}walk(e,t){let r=e;function n(e,s,i){let o=!0;r.enter&&r.enter.call(t,e,s,i)===oe.prototype.SKIP&&(o=!1),o&&(e.children.forEach((t=>{n(t,e,i+1)})),r.exit&&r.exit.call(t,e,s,i))}"function"==typeof r&&(r={enter:r}),this.isRootNode?this.children.forEach((e=>{n(e,null,0)})):n(this,null,0)}toString(){const e=new m;return this.walk(((t,r,n)=>{if(!t)return this.SKIP;if("Alt"!==t.expr.constructor.name){if(e.append(function(e,t,r){const n=ie(e.slice(t,t+10));return n.length<10?n+a(" ",10-n.length).join(""):n}(t.input,t.pos)+a(" ",2*n+1).join("")),e.append((t.succeeded?"✓":"✗")+" "+t.displayString),t.isHeadOfLeftRecursion&&e.append(" (LR)"),t.succeeded){const r=ie(t.source.contents);e.append(" ⇒  "),e.append("string"==typeof r?'"'+r+'"':r)}e.append("\n")}})),e.contents()}}let ae,ce;oe.prototype.SKIP={},Object.keys(se).forEach((e=>{const t=se[e];Object.defineProperty(oe.prototype,e,{get(){return 0!=(this._flags&t)},set(e){e?this._flags|=t:this._flags&=~t}})})),_.prototype.allowsSkippingPrecedingSpace=r("allowsSkippingPrecedingSpace"),I.allowsSkippingPrecedingSpace=x.allowsSkippingPrecedingSpace=D.prototype.allowsSkippingPrecedingSpace=b.prototype.allowsSkippingPrecedingSpace=w.prototype.allowsSkippingPrecedingSpace=j.prototype.allowsSkippingPrecedingSpace=function(){return!0},A.prototype.allowsSkippingPrecedingSpace=E.prototype.allowsSkippingPrecedingSpace=M.prototype.allowsSkippingPrecedingSpace=C.prototype.allowsSkippingPrecedingSpace=k.prototype.allowsSkippingPrecedingSpace=S.prototype.allowsSkippingPrecedingSpace=L.prototype.allowsSkippingPrecedingSpace=function(){return!1},Q((e=>{ae=e})),_.prototype.assertAllApplicationsAreValid=function(e,t){ce=0,this._assertAllApplicationsAreValid(e,t)},_.prototype._assertAllApplicationsAreValid=r("_assertAllApplicationsAreValid"),I._assertAllApplicationsAreValid=x._assertAllApplicationsAreValid=b.prototype._assertAllApplicationsAreValid=w.prototype._assertAllApplicationsAreValid=S.prototype._assertAllApplicationsAreValid=j.prototype._assertAllApplicationsAreValid=function(e,t){},M.prototype._assertAllApplicationsAreValid=function(e,t){ce++,this.expr._assertAllApplicationsAreValid(e,t),ce--},A.prototype._assertAllApplicationsAreValid=function(e,t){for(let r=0;r<this.terms.length;r++)this.terms[r]._assertAllApplicationsAreValid(e,t)},L.prototype._assertAllApplicationsAreValid=function(e,t){for(let r=0;r<this.factors.length;r++)this.factors[r]._assertAllApplicationsAreValid(e,t)},E.prototype._assertAllApplicationsAreValid=k.prototype._assertAllApplicationsAreValid=C.prototype._assertAllApplicationsAreValid=function(e,t){this.expr._assertAllApplicationsAreValid(e,t)},D.prototype._assertAllApplicationsAreValid=function(e,t,r=!1){const n=t.rules[this.ruleName],s=u(e)&&0===ce;if(!n)throw $(this.ruleName,t.name,this.source);if(!r&&u(this.ruleName)&&!s)throw function(e,t){return T("Cannot apply syntactic rule "+e+" from here (inside a lexical context)",t.source)}(this.ruleName,this);const i=this.args.length,o=n.formals.length;if(i!==o)throw function(e,t,r,n){return T("Wrong number of arguments for rule "+e+" (expected "+t+", got "+r+")",n)}(this.ruleName,o,i,this.source);const a=ae&&n===ae.rules.applySyntactic;if(ae&&n===ae.rules.caseInsensitive&&!(this.args[0]instanceof b))throw U('a Terminal (e.g. "abc")',this.args[0]);if(a){const e=this.args[0];if(!(e instanceof D))throw U("a syntactic rule application",e);if(!u(e.ruleName))throw function(e){const{ruleName:t}=e;return T(`applySyntactic is for syntactic rules, but '${t}' is a lexical rule. NOTE: A _syntactic rule_ is a rule whose name begins with a capital letter. See https://ohmjs.org/d/svl for more details.`,e.source)}(e);if(s)throw T("applySyntactic is not required here (in a syntactic context)",this.source)}this.args.forEach((r=>{if(r._assertAllApplicationsAreValid(e,t,a),1!==r.getArity())throw function(e,t){return T("Invalid parameter to rule "+e+": "+t+" has arity "+t.getArity()+", but parameter expressions must have arity 1",t.source)}(this.ruleName,r)}))},_.prototype.assertChoicesHaveUniformArity=r("assertChoicesHaveUniformArity"),I.assertChoicesHaveUniformArity=x.assertChoicesHaveUniformArity=b.prototype.assertChoicesHaveUniformArity=w.prototype.assertChoicesHaveUniformArity=S.prototype.assertChoicesHaveUniformArity=M.prototype.assertChoicesHaveUniformArity=j.prototype.assertChoicesHaveUniformArity=function(e){},A.prototype.assertChoicesHaveUniformArity=function(e){if(0===this.terms.length)return;const t=this.terms[0].getArity();for(let r=0;r<this.terms.length;r++){const n=this.terms[r];n.assertChoicesHaveUniformArity();const s=n.getArity();if(t!==s)throw V(e,t,s,n)}},N.prototype.assertChoicesHaveUniformArity=function(e){const t=this.terms[0].getArity(),r=this.terms[1].getArity();if(t!==r)throw V(e,r,t,this.terms[0])},L.prototype.assertChoicesHaveUniformArity=function(e){for(let t=0;t<this.factors.length;t++)this.factors[t].assertChoicesHaveUniformArity(e)},E.prototype.assertChoicesHaveUniformArity=function(e){this.expr.assertChoicesHaveUniformArity(e)},k.prototype.assertChoicesHaveUniformArity=function(e){},C.prototype.assertChoicesHaveUniformArity=function(e){this.expr.assertChoicesHaveUniformArity(e)},D.prototype.assertChoicesHaveUniformArity=function(e){},_.prototype.assertIteratedExprsAreNotNullable=r("assertIteratedExprsAreNotNullable"),I.assertIteratedExprsAreNotNullable=x.assertIteratedExprsAreNotNullable=b.prototype.assertIteratedExprsAreNotNullable=w.prototype.assertIteratedExprsAreNotNullable=S.prototype.assertIteratedExprsAreNotNullable=j.prototype.assertIteratedExprsAreNotNullable=function(e){},A.prototype.assertIteratedExprsAreNotNullable=function(e){for(let t=0;t<this.terms.length;t++)this.terms[t].assertIteratedExprsAreNotNullable(e)},L.prototype.assertIteratedExprsAreNotNullable=function(e){for(let t=0;t<this.factors.length;t++)this.factors[t].assertIteratedExprsAreNotNullable(e)},E.prototype.assertIteratedExprsAreNotNullable=function(e){if(this.expr.assertIteratedExprsAreNotNullable(e),this.expr.isNullable(e))throw K(this,[])},F.prototype.assertIteratedExprsAreNotNullable=k.prototype.assertIteratedExprsAreNotNullable=C.prototype.assertIteratedExprsAreNotNullable=M.prototype.assertIteratedExprsAreNotNullable=function(e){this.expr.assertIteratedExprsAreNotNullable(e)},D.prototype.assertIteratedExprsAreNotNullable=function(e){this.args.forEach((t=>{t.assertIteratedExprsAreNotNullable(e)}))};class le{constructor(e){this.matchLength=e}get ctorName(){throw new Error("subclass responsibility")}numChildren(){return this.children?this.children.length:0}childAt(e){if(this.children)return this.children[e]}indexOfChild(e){return this.children.indexOf(e)}hasChildren(){return this.numChildren()>0}hasNoChildren(){return!this.hasChildren()}onlyChild(){if(1!==this.numChildren())throw new Error("cannot get only child of a node of type "+this.ctorName+" (it has "+this.numChildren()+" children)");return this.firstChild()}firstChild(){if(this.hasNoChildren())throw new Error("cannot get first child of a "+this.ctorName+" node, which has no children");return this.childAt(0)}lastChild(){if(this.hasNoChildren())throw new Error("cannot get last child of a "+this.ctorName+" node, which has no children");return this.childAt(this.numChildren()-1)}childBefore(e){const t=this.indexOfChild(e);if(t<0)throw new Error("Node.childBefore() called w/ an argument that is not a child");if(0===t)throw new Error("cannot get child before first child");return this.childAt(t-1)}childAfter(e){const t=this.indexOfChild(e);if(t<0)throw new Error("Node.childAfter() called w/ an argument that is not a child");if(t===this.numChildren()-1)throw new Error("cannot get child after last child");return this.childAt(t+1)}isTerminal(){return!1}isNonterminal(){return!1}isIteration(){return!1}isOptional(){return!1}}class ue extends le{get ctorName(){return"_terminal"}isTerminal(){return!0}get primitiveValue(){throw new Error("The `primitiveValue` property was removed in Ohm v17.")}}class pe extends le{constructor(e,t,r,n){super(n),this.ruleName=e,this.children=t,this.childOffsets=r}get ctorName(){return this.ruleName}isNonterminal(){return!0}isLexical(){return p(this.ctorName)}isSyntactic(){return u(this.ctorName)}}class he extends le{constructor(e,t,r,n){super(r),this.children=e,this.childOffsets=t,this.optional=n}get ctorName(){return"_iter"}isIteration(){return!0}isOptional(){return this.optional}}function me(e,t){const r={};if(e.source&&t){const n=e.source.relativeTo(t);r.sourceInterval=[n.startIdx,n.endIdx]}return r}function de(e){return/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(e)}function fe(e){const t=Object.create(null);e.forEach((e=>{t[e]=(t[e]||0)+1})),Object.keys(t).forEach((r=>{if(t[r]<=1)return;let n=1;e.forEach(((t,s)=>{t===r&&(e[s]=t+"_"+n++)}))}))}_.prototype.eval=r("eval"),I.eval=function(e){const{inputStream:t}=e,r=t.pos,n=t.nextCodePoint();return void 0!==n?(e.pushBinding(new ue(String.fromCodePoint(n).length),r),!0):(e.processFailure(r,this),!1)},x.eval=function(e){const{inputStream:t}=e,r=t.pos;return t.atEnd()?(e.pushBinding(new ue(0),r),!0):(e.processFailure(r,this),!1)},b.prototype.eval=function(e){const{inputStream:t}=e,r=t.pos;return t.matchString(this.obj)?(e.pushBinding(new ue(this.obj.length),r),!0):(e.processFailure(r,this),!1)},w.prototype.eval=function(e){const{inputStream:t}=e,r=t.pos,n=this.matchCodePoint?t.nextCodePoint():t.nextCharCode();return void 0!==n&&this.from.codePointAt(0)<=n&&n<=this.to.codePointAt(0)?(e.pushBinding(new ue(String.fromCodePoint(n).length),r),!0):(e.processFailure(r,this),!1)},S.prototype.eval=function(e){return e.eval(e.currentApplication().args[this.index])},M.prototype.eval=function(e){e.enterLexifiedContext();const t=e.eval(this.expr);return e.exitLexifiedContext(),t},A.prototype.eval=function(e){for(let t=0;t<this.terms.length;t++)if(e.eval(this.terms[t]))return!0;return!1},L.prototype.eval=function(e){for(let t=0;t<this.factors.length;t++){const r=this.factors[t];if(!e.eval(r))return!1}return!0},E.prototype.eval=function(e){const{inputStream:t}=e,r=t.pos,n=this.getArity(),s=[],i=[];for(;s.length<n;)s.push([]),i.push([]);let o,a=0,c=r;for(;a<this.maxNumMatches&&e.eval(this.expr);){if(t.pos===c)throw K(this,e._applicationStack);c=t.pos,a++;const r=e._bindings.splice(e._bindings.length-n,n),l=e._bindingOffsets.splice(e._bindingOffsets.length-n,n);for(o=0;o<r.length;o++)s[o].push(r[o]),i[o].push(l[o])}if(a<this.minNumMatches)return!1;let l=e.posToOffset(r),u=0;if(a>0){const e=s[n-1],t=i[n-1],r=t[t.length-1]+e[e.length-1].matchLength;l=i[0][0],u=r-l}const p=this instanceof F;for(o=0;o<s.length;o++)e._bindings.push(new he(s[o],i[o],u,p)),e._bindingOffsets.push(l);return!0},k.prototype.eval=function(e){const{inputStream:t}=e,r=t.pos;e.pushFailuresInfo();const n=e.eval(this.expr);return e.popFailuresInfo(),n?(e.processFailure(r,this),!1):(t.pos=r,!0)},C.prototype.eval=function(e){const{inputStream:t}=e,r=t.pos;return!!e.eval(this.expr)&&(t.pos=r,!0)},D.prototype.eval=function(e){const t=e.currentApplication(),r=t?t.args:[],n=this.substituteParams(r),s=e.getCurrentPosInfo();if(s.isActive(n))return n.handleCycle(e);const i=n.toMemoKey(),o=s.memo[i];if(o&&s.shouldUseMemoizedResult(o)){if(e.hasNecessaryInfo(o))return e.useMemoizedResult(e.inputStream.pos,o);delete s.memo[i]}return n.reallyEval(e)},D.prototype.handleCycle=function(e){const t=e.getCurrentPosInfo(),{currentLeftRecursion:r}=t,n=this.toMemoKey();let s=t.memo[n];return r&&r.headApplication.toMemoKey()===n?s.updateInvolvedApplicationMemoKeys():s||(s=t.memoize(n,{matchLength:0,examinedLength:0,value:!1,rightmostFailureOffset:-1}),t.startLeftRecursion(this,s)),e.useMemoizedResult(e.inputStream.pos,s)},D.prototype.reallyEval=function(e){const{inputStream:t}=e,r=t.pos,s=e.getCurrentPosInfo(),i=e.grammar.rules[this.ruleName],{body:o}=i,{description:a}=i;e.enterApplication(s,this),a&&e.pushFailuresInfo();const c=t.examinedLength;t.examinedLength=0;let l=this.evalOnce(o,e);const u=s.currentLeftRecursion,p=this.toMemoKey(),h=u&&u.headApplication.toMemoKey()===p;let m;e.doNotMemoize?e.doNotMemoize=!1:h?(l=this.growSeedResult(o,e,r,u,l),s.endLeftRecursion(),m=u,m.examinedLength=t.examinedLength-r,m.rightmostFailureOffset=e._getRightmostFailureOffset(),s.memoize(p,m)):u&&u.isInvolved(p)||(m=s.memoize(p,{matchLength:t.pos-r,examinedLength:t.examinedLength-r,value:l,failuresAtRightmostPosition:e.cloneRecordedFailures(),rightmostFailureOffset:e._getRightmostFailureOffset()}));const d=!!l;if(a&&(e.popFailuresInfo(),d||e.processFailure(r,this),m&&(m.failuresAtRightmostPosition=e.cloneRecordedFailures())),e.isTracing()&&m){const t=e.getTraceEntry(r,this,d,d?[l]:[]);h&&(n(null!=t.terminatingLREntry||!d),t.isHeadOfLeftRecursion=!0),m.traceEntry=t}return t.examinedLength=Math.max(t.examinedLength,c),e.exitApplication(s,l),d},D.prototype.evalOnce=function(e,t){const{inputStream:r}=t,n=r.pos;if(t.eval(e)){const s=e.getArity(),i=t._bindings.splice(t._bindings.length-s,s),o=t._bindingOffsets.splice(t._bindingOffsets.length-s,s),a=r.pos-n;return new pe(this.ruleName,i,o,a)}return!1},D.prototype.growSeedResult=function(e,t,r,n,s){if(!s)return!1;const{inputStream:i}=t;for(;;){if(n.matchLength=i.pos-r,n.value=s,n.failuresAtRightmostPosition=t.cloneRecordedFailures(),t.isTracing()){const e=t.trace[t.trace.length-1];n.traceEntry=new oe(t.input,r,i.pos,this,!0,[s],[e.clone()])}if(i.pos=r,s=this.evalOnce(e,t),i.pos-r<=n.matchLength)break;t.isTracing()&&t.trace.splice(-2,1)}return t.isTracing()&&n.traceEntry.recordLRTermination(t.trace.pop(),s),i.pos=r+n.matchLength,n.value},j.prototype.eval=function(e){const{inputStream:t}=e,r=t.pos,n=t.next();return n&&this.pattern.test(n)?(e.pushBinding(new ue(n.length),r),!0):(e.processFailure(r,this),!1)},_.prototype.getArity=r("getArity"),I.getArity=x.getArity=b.prototype.getArity=w.prototype.getArity=S.prototype.getArity=D.prototype.getArity=j.prototype.getArity=function(){return 1},A.prototype.getArity=function(){return 0===this.terms.length?0:this.terms[0].getArity()},L.prototype.getArity=function(){let e=0;for(let t=0;t<this.factors.length;t++)e+=this.factors[t].getArity();return e},E.prototype.getArity=function(){return this.expr.getArity()},k.prototype.getArity=function(){return 0},C.prototype.getArity=M.prototype.getArity=function(){return this.expr.getArity()},_.prototype.outputRecipe=r("outputRecipe"),I.outputRecipe=function(e,t){return["any",me(this,t)]},x.outputRecipe=function(e,t){return["end",me(this,t)]},b.prototype.outputRecipe=function(e,t){return["terminal",me(this,t),this.obj]},w.prototype.outputRecipe=function(e,t){return["range",me(this,t),this.from,this.to]},S.prototype.outputRecipe=function(e,t){return["param",me(this,t),this.index]},A.prototype.outputRecipe=function(e,t){return["alt",me(this,t)].concat(this.terms.map((r=>r.outputRecipe(e,t))))},N.prototype.outputRecipe=function(e,t){return this.terms[0].outputRecipe(e,t)},O.prototype.outputRecipe=function(e,t){const r=this.terms.slice(0,this.expansionPos),n=this.terms.slice(this.expansionPos+1);return["splice",me(this,t),r.map((r=>r.outputRecipe(e,t))),n.map((r=>r.outputRecipe(e,t)))]},L.prototype.outputRecipe=function(e,t){return["seq",me(this,t)].concat(this.factors.map((r=>r.outputRecipe(e,t))))},P.prototype.outputRecipe=R.prototype.outputRecipe=F.prototype.outputRecipe=k.prototype.outputRecipe=C.prototype.outputRecipe=M.prototype.outputRecipe=function(e,t){return[this.constructor.name.toLowerCase(),me(this,t),this.expr.outputRecipe(e,t)]},D.prototype.outputRecipe=function(e,t){return["app",me(this,t),this.ruleName,this.args.map((r=>r.outputRecipe(e,t)))]},j.prototype.outputRecipe=function(e,t){return["unicodeChar",me(this,t),this.category]},_.prototype.introduceParams=r("introduceParams"),I.introduceParams=x.introduceParams=b.prototype.introduceParams=w.prototype.introduceParams=S.prototype.introduceParams=j.prototype.introduceParams=function(e){return this},A.prototype.introduceParams=function(e){return this.terms.forEach(((t,r,n)=>{n[r]=t.introduceParams(e)})),this},L.prototype.introduceParams=function(e){return this.factors.forEach(((t,r,n)=>{n[r]=t.introduceParams(e)})),this},E.prototype.introduceParams=k.prototype.introduceParams=C.prototype.introduceParams=M.prototype.introduceParams=function(e){return this.expr=this.expr.introduceParams(e),this},D.prototype.introduceParams=function(e){const t=e.indexOf(this.ruleName);if(t>=0){if(this.args.length>0)throw new Error("Parameterized rules cannot be passed as arguments to another rule.");return new S(t).withSource(this.source)}return this.args.forEach(((t,r,n)=>{n[r]=t.introduceParams(e)})),this},_.prototype.isNullable=function(e){return this._isNullable(e,Object.create(null))},_.prototype._isNullable=r("_isNullable"),I._isNullable=w.prototype._isNullable=S.prototype._isNullable=R.prototype._isNullable=j.prototype._isNullable=function(e,t){return!1},x._isNullable=function(e,t){return!0},b.prototype._isNullable=function(e,t){return"string"==typeof this.obj&&""===this.obj},A.prototype._isNullable=function(e,t){return 0===this.terms.length||this.terms.some((r=>r._isNullable(e,t)))},L.prototype._isNullable=function(e,t){return this.factors.every((r=>r._isNullable(e,t)))},P.prototype._isNullable=F.prototype._isNullable=k.prototype._isNullable=C.prototype._isNullable=function(e,t){return!0},M.prototype._isNullable=function(e,t){return this.expr._isNullable(e,t)},D.prototype._isNullable=function(e,t){const r=this.toMemoKey();if(!Object.prototype.hasOwnProperty.call(t,r)){const{body:n}=e.rules[this.ruleName],s=n.substituteParams(this.args);t[r]=!1,t[r]=s._isNullable(e,t)}return t[r]},_.prototype.substituteParams=r("substituteParams"),I.substituteParams=x.substituteParams=b.prototype.substituteParams=w.prototype.substituteParams=j.prototype.substituteParams=function(e){return this},S.prototype.substituteParams=function(e){return e[this.index]},A.prototype.substituteParams=function(e){return new A(this.terms.map((t=>t.substituteParams(e))))},L.prototype.substituteParams=function(e){return new L(this.factors.map((t=>t.substituteParams(e))))},E.prototype.substituteParams=k.prototype.substituteParams=C.prototype.substituteParams=M.prototype.substituteParams=function(e){return new this.constructor(this.expr.substituteParams(e))},D.prototype.substituteParams=function(e){if(0===this.args.length)return this;{const t=this.args.map((t=>t.substituteParams(e)));return new D(this.ruleName,t)}},_.prototype.toArgumentNameList=r("toArgumentNameList"),I.toArgumentNameList=function(e,t){return["any"]},x.toArgumentNameList=function(e,t){return["end"]},b.prototype.toArgumentNameList=function(e,t){return"string"==typeof this.obj&&/^[_a-zA-Z0-9]+$/.test(this.obj)?["_"+this.obj]:["$"+e]},w.prototype.toArgumentNameList=function(e,t){let r=this.from+"_to_"+this.to;return de(r)||(r="_"+r),de(r)||(r="$"+e),[r]},A.prototype.toArgumentNameList=function(e,t){const r=this.terms.map((t=>t.toArgumentNameList(e,!0))),n=[],s=r[0].length;for(let e=0;e<s;e++){const t=[];for(let n=0;n<this.terms.length;n++)t.push(r[n][e]);const s=l(t);n.push(s.join("_or_"))}return t||fe(n),n},L.prototype.toArgumentNameList=function(e,t){let r=[];return this.factors.forEach((t=>{const n=t.toArgumentNameList(e,!0);r=r.concat(n),e+=n.length})),t||fe(r),r},E.prototype.toArgumentNameList=function(e,t){const r=this.expr.toArgumentNameList(e,t).map((e=>"s"===e[e.length-1]?e+"es":e+"s"));return t||fe(r),r},F.prototype.toArgumentNameList=function(e,t){return this.expr.toArgumentNameList(e,t).map((e=>"opt"+e[0].toUpperCase()+e.slice(1)))},k.prototype.toArgumentNameList=function(e,t){return[]},C.prototype.toArgumentNameList=M.prototype.toArgumentNameList=function(e,t){return this.expr.toArgumentNameList(e,t)},D.prototype.toArgumentNameList=function(e,t){return[this.ruleName]},j.prototype.toArgumentNameList=function(e,t){return["$"+e]},S.prototype.toArgumentNameList=function(e,t){return["param"+this.index]},_.prototype.toDisplayString=r("toDisplayString"),A.prototype.toDisplayString=L.prototype.toDisplayString=function(){return this.source?this.source.trimmed().contents:"["+this.constructor.name+"]"},I.toDisplayString=x.toDisplayString=E.prototype.toDisplayString=k.prototype.toDisplayString=C.prototype.toDisplayString=M.prototype.toDisplayString=b.prototype.toDisplayString=w.prototype.toDisplayString=S.prototype.toDisplayString=function(){return this.toString()},D.prototype.toDisplayString=function(){if(this.args.length>0){const e=this.args.map((e=>e.toDisplayString()));return this.ruleName+"<"+e.join(",")+">"}return this.ruleName},j.prototype.toDisplayString=function(){return"Unicode ["+this.category+"] character"};class ge{constructor(e,t,r){if(!function(e){return"description"===e||"string"===e||"code"===e}(r))throw new Error("invalid Failure type: "+r);this.pexpr=e,this.text=t,this.type=r,this.fluffy=!1}getPExpr(){return this.pexpr}getText(){return this.text}getType(){return this.type}isDescription(){return"description"===this.type}isStringTerminal(){return"string"===this.type}isCode(){return"code"===this.type}isFluffy(){return this.fluffy}makeFluffy(){this.fluffy=!0}clearFluffy(){this.fluffy=!1}subsumes(e){return this.getText()===e.getText()&&this.type===e.type&&(!this.isFluffy()||this.isFluffy()&&e.isFluffy())}toString(){return"string"===this.type?JSON.stringify(this.getText()):this.getText()}clone(){const e=new ge(this.pexpr,this.text,this.type);return this.isFluffy()&&e.makeFluffy(),e}toKey(){return this.toString()+"#"+this.type}}_.prototype.toFailure=r("toFailure"),I.toFailure=function(e){return new ge(this,"any object","description")},x.toFailure=function(e){return new ge(this,"end of input","description")},b.prototype.toFailure=function(e){return new ge(this,this.obj,"string")},w.prototype.toFailure=function(e){return new ge(this,JSON.stringify(this.from)+".."+JSON.stringify(this.to),"code")},k.prototype.toFailure=function(e){const t=this.expr===I?"nothing":"not "+this.expr.toFailure(e);return new ge(this,t,"description")},C.prototype.toFailure=function(e){return this.expr.toFailure(e)},D.prototype.toFailure=function(e){let{description:t}=e.rules[this.ruleName];return t||(t=(/^[aeiouAEIOU]/.test(this.ruleName)?"an":"a")+" "+this.ruleName),new ge(this,t,"description")},j.prototype.toFailure=function(e){return new ge(this,"a Unicode ["+this.category+"] character","description")},A.prototype.toFailure=function(e){const t="("+this.terms.map((t=>t.toFailure(e))).join(" or ")+")";return new ge(this,t,"description")},L.prototype.toFailure=function(e){const t="("+this.factors.map((t=>t.toFailure(e))).join(" ")+")";return new ge(this,t,"description")},E.prototype.toFailure=function(e){const t="("+this.expr.toFailure(e)+this.operator+")";return new ge(this,t,"description")},_.prototype.toString=r("toString"),I.toString=function(){return"any"},x.toString=function(){return"end"},b.prototype.toString=function(){return JSON.stringify(this.obj)},w.prototype.toString=function(){return JSON.stringify(this.from)+".."+JSON.stringify(this.to)},S.prototype.toString=function(){return"$"+this.index},M.prototype.toString=function(){return"#("+this.expr.toString()+")"},A.prototype.toString=function(){return 1===this.terms.length?this.terms[0].toString():"("+this.terms.map((e=>e.toString())).join(" | ")+")"},L.prototype.toString=function(){return 1===this.factors.length?this.factors[0].toString():"("+this.factors.map((e=>e.toString())).join(" ")+")"},E.prototype.toString=function(){return this.expr+this.operator},k.prototype.toString=function(){return"~"+this.expr},C.prototype.toString=function(){return"&"+this.expr},D.prototype.toString=function(){if(this.args.length>0){const e=this.args.map((e=>e.toString()));return this.ruleName+"<"+e.join(",")+">"}return this.ruleName},j.prototype.toString=function(){return"\\p{"+this.category+"}"};class ye extends _{constructor(e){super(),this.obj=e}_getString(e){const t=e.currentApplication().args[this.obj.index];return n(t instanceof b,"expected a Terminal expression"),t.obj}allowsSkippingPrecedingSpace(){return!0}eval(e){const{inputStream:t}=e,r=t.pos,n=this._getString(e);return t.matchString(n,!0)?(e.pushBinding(new ue(n.length),r),!0):(e.processFailure(r,this),!1)}getArity(){return 1}substituteParams(e){return new ye(this.obj.substituteParams(e))}toDisplayString(){return this.obj.toDisplayString()+" (case-insensitive)"}toFailure(e){return new ge(this,this.obj.toFailure(e)+" (case-insensitive)","description")}_isNullable(e,t){return this.obj._isNullable(e,t)}}var ve=Object.freeze({__proto__:null,CaseInsensitiveTerminal:ye,PExpr:_,any:I,end:x,Terminal:b,Range:w,Param:S,Alt:A,Extend:N,Splice:O,Seq:L,Iter:E,Star:P,Plus:R,Opt:F,Not:k,Lookahead:C,Lex:M,Apply:D,UnicodeChar:j});let _e;Q((e=>{_e=e.rules.applySyntactic.body}));const Ie=new D("spaces");class xe{constructor(e,t,r){this.matcher=e,this.startExpr=t,this.grammar=e.grammar,this.input=e.getInput(),this.inputStream=new te(this.input),this.memoTable=e._memoTable,this.userData=void 0,this.doNotMemoize=!1,this._bindings=[],this._bindingOffsets=[],this._applicationStack=[],this._posStack=[0],this.inLexifiedContextStack=[!1],this.rightmostFailurePosition=-1,this._rightmostFailurePositionStack=[],this._recordedFailuresStack=[],void 0!==r&&(this.positionToRecordFailures=r,this.recordedFailures=Object.create(null))}posToOffset(e){return e-this._posStack[this._posStack.length-1]}enterApplication(e,t){this._posStack.push(this.inputStream.pos),this._applicationStack.push(t),this.inLexifiedContextStack.push(!1),e.enter(t),this._rightmostFailurePositionStack.push(this.rightmostFailurePosition),this.rightmostFailurePosition=-1}exitApplication(e,t){const r=this._posStack.pop();this._applicationStack.pop(),this.inLexifiedContextStack.pop(),e.exit(),this.rightmostFailurePosition=Math.max(this.rightmostFailurePosition,this._rightmostFailurePositionStack.pop()),t&&this.pushBinding(t,r)}enterLexifiedContext(){this.inLexifiedContextStack.push(!0)}exitLexifiedContext(){this.inLexifiedContextStack.pop()}currentApplication(){return this._applicationStack[this._applicationStack.length-1]}inSyntacticContext(){const e=this.currentApplication();return e?e.isSyntactic()&&!this.inLexifiedContext():this.startExpr.factors[0].isSyntactic()}inLexifiedContext(){return this.inLexifiedContextStack[this.inLexifiedContextStack.length-1]}skipSpaces(){return this.pushFailuresInfo(),this.eval(Ie),this.popBinding(),this.popFailuresInfo(),this.inputStream.pos}skipSpacesIfInSyntacticContext(){return this.inSyntacticContext()?this.skipSpaces():this.inputStream.pos}maybeSkipSpacesBefore(e){return e.allowsSkippingPrecedingSpace()&&e!==Ie?this.skipSpacesIfInSyntacticContext():this.inputStream.pos}pushBinding(e,t){this._bindings.push(e),this._bindingOffsets.push(this.posToOffset(t))}popBinding(){this._bindings.pop(),this._bindingOffsets.pop()}numBindings(){return this._bindings.length}truncateBindings(e){for(;this._bindings.length>e;)this.popBinding()}getCurrentPosInfo(){return this.getPosInfo(this.inputStream.pos)}getPosInfo(e){let t=this.memoTable[e];return t||(t=this.memoTable[e]=new ne),t}processFailure(e,t){if(this.rightmostFailurePosition=Math.max(this.rightmostFailurePosition,e),this.recordedFailures&&e===this.positionToRecordFailures){const e=this.currentApplication();e&&(t=t.substituteParams(e.args)),this.recordFailure(t.toFailure(this.grammar),!1)}}recordFailure(e,t){const r=e.toKey();this.recordedFailures[r]?this.recordedFailures[r].isFluffy()&&!e.isFluffy()&&this.recordedFailures[r].clearFluffy():this.recordedFailures[r]=t?e.clone():e}recordFailures(e,t){Object.keys(e).forEach((r=>{this.recordFailure(e[r],t)}))}cloneRecordedFailures(){if(!this.recordedFailures)return;const e=Object.create(null);return Object.keys(this.recordedFailures).forEach((t=>{e[t]=this.recordedFailures[t].clone()})),e}getRightmostFailurePosition(){return this.rightmostFailurePosition}_getRightmostFailureOffset(){return this.rightmostFailurePosition>=0?this.posToOffset(this.rightmostFailurePosition):-1}getMemoizedTraceEntry(e,t){const r=this.memoTable[e];if(r&&t instanceof D){const e=r.memo[t.toMemoKey()];if(e&&e.traceEntry){const r=e.traceEntry.cloneWithExpr(t);return r.isMemoized=!0,r}}return null}getTraceEntry(e,t,r,n){if(t instanceof D){const e=this.currentApplication(),r=e?e.args:[];t=t.substituteParams(r)}return this.getMemoizedTraceEntry(e,t)||new oe(this.input,e,this.inputStream.pos,t,r,n,this.trace)}isTracing(){return!!this.trace}hasNecessaryInfo(e){return!(this.trace&&!e.traceEntry||this.recordedFailures&&this.inputStream.pos+e.rightmostFailureOffset===this.positionToRecordFailures&&!e.failuresAtRightmostPosition)}useMemoizedResult(e,t){this.trace&&this.trace.push(t.traceEntry);const r=this.inputStream.pos+t.rightmostFailureOffset;return this.rightmostFailurePosition=Math.max(this.rightmostFailurePosition,r),this.recordedFailures&&this.positionToRecordFailures===r&&t.failuresAtRightmostPosition&&this.recordFailures(t.failuresAtRightmostPosition,!0),this.inputStream.examinedLength=Math.max(this.inputStream.examinedLength,t.examinedLength+e),!!t.value&&(this.inputStream.pos+=t.matchLength,this.pushBinding(t.value,e),!0)}eval(e){const{inputStream:t}=this,r=this._bindings.length,n=this.userData;let s;this.recordedFailures&&(s=this.recordedFailures,this.recordedFailures=Object.create(null));const i=t.pos,o=this.maybeSkipSpacesBefore(e);let a;this.trace&&(a=this.trace,this.trace=[]);const c=e.eval(this);if(this.trace){const t=this._bindings.slice(r),n=this.getTraceEntry(o,e,c,t);n.isImplicitSpaces=e===Ie,n.isRootNode=e===this.startExpr,a.push(n),this.trace=a}return c?this.recordedFailures&&t.pos===this.positionToRecordFailures&&Object.keys(this.recordedFailures).forEach((e=>{this.recordedFailures[e].makeFluffy()})):(t.pos=i,this.truncateBindings(r),this.userData=n),this.recordedFailures&&this.recordFailures(s,!1),e===_e&&this.skipSpaces(),c}getMatchResult(){let e;this.grammar._setUpMatchState(this),this.eval(this.startExpr),this.recordedFailures&&(e=Object.keys(this.recordedFailures).map((e=>this.recordedFailures[e])));const t=this._bindings[0];return t&&(t.grammar=this.grammar),new re(this.matcher,this.input,this.startExpr,t,this._bindingOffsets[0],this.rightmostFailurePosition,e)}getTrace(){this.trace=[];const e=this.getMatchResult(),t=this.trace[this.trace.length-1];return t.result=e,t}pushFailuresInfo(){this._rightmostFailurePositionStack.push(this.rightmostFailurePosition),this._recordedFailuresStack.push(this.recordedFailures)}popFailuresInfo(){this.rightmostFailurePosition=this._rightmostFailurePositionStack.pop(),this.recordedFailures=this._recordedFailuresStack.pop()}}class be{constructor(e){this.grammar=e,this._memoTable=[],this._input="",this._isMemoTableStale=!1}_resetMemoTable(){this._memoTable=[],this._isMemoTableStale=!1}getInput(){return this._input}setInput(e){return this._input!==e&&this.replaceInputRange(0,this._input.length,e),this}replaceInputRange(e,t,r){const n=this._input,s=this._memoTable;if(e<0||e>n.length||t<0||t>n.length||e>t)throw new Error("Invalid indices: "+e+" and "+t);this._input=n.slice(0,e)+r+n.slice(t),this._input!==n&&s.length>0&&(this._isMemoTableStale=!0);const i=s.slice(t);s.length=e;for(let e=0;e<r.length;e++)s.push(void 0);for(const e of i)s.push(e);for(let t=0;t<e;t++){const r=s[t];r&&r.clearObsoleteEntries(t,e)}return this}match(e,t={incremental:!0}){return this._match(this._getStartExpr(e),{incremental:t.incremental,tracing:!1})}trace(e,t={incremental:!0}){return this._match(this._getStartExpr(e),{incremental:t.incremental,tracing:!0})}_match(e,t={}){const r={tracing:!1,incremental:!0,positionToRecordFailures:void 0,...t};if(r.incremental){if(this._isMemoTableStale&&!this.grammar.supportsIncrementalParsing)throw T(`Grammar '${this.grammar.name}' does not support incremental parsing`)}else this._resetMemoTable();const n=new xe(this,e,r.positionToRecordFailures);return r.tracing?n.getTrace():n.getMatchResult()}_getStartExpr(e){const t=e||this.grammar.defaultStartRule;if(!t)throw new Error("Missing start rule argument -- the grammar has no default start rule.");const r=this.grammar.parseApplication(t);return new L([r,x])}}const we=[],Se=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);class Ae{constructor(e,t,r){this._node=e,this.source=t,this._baseInterval=r,e.isNonterminal()&&n(t===r),this._childWrappers=[]}_forgetMemoizedResultFor(e){delete this._node[this._semantics.attributeKeys[e]],this.children.forEach((t=>{t._forgetMemoizedResultFor(e)}))}child(e){if(!(0<=e&&e<this._node.numChildren()))return;let t=this._childWrappers[e];if(!t){const r=this._node.childAt(e),n=this._node.childOffsets[e],s=this._baseInterval.subInterval(n,r.matchLength),i=r.isNonterminal()?s:this._baseInterval;t=this._childWrappers[e]=this._semantics.wrap(r,s,i)}return t}_children(){for(let e=0;e<this._node.numChildren();e++)this.child(e);return this._childWrappers}isIteration(){return this._node.isIteration()}isTerminal(){return this._node.isTerminal()}isNonterminal(){return this._node.isNonterminal()}isSyntactic(){return this.isNonterminal()&&this._node.isSyntactic()}isLexical(){return this.isNonterminal()&&this._node.isLexical()}isOptional(){return this._node.isOptional()}iteration(e){const t=e||[],r=t.map((e=>e._node)),n=new he(r,[],-1,!1),s=this._semantics.wrap(n,null,null);return s._childWrappers=t,s}get children(){return this._children()}get ctorName(){return this._node.ctorName}get numChildren(){return this._node.numChildren()}get sourceString(){return this.source.contents}}class Ne{constructor(e,t){const r=this;if(this.grammar=e,this.checkedActionDicts=!1,this.Wrapper=class extends(t?t.Wrapper:Ae){constructor(e,t,n){super(e,t,n),r.checkActionDictsIfHaventAlready(),this._semantics=r}toString(){return"[semantics wrapper for "+r.grammar.name+"]"}},this.super=t,t){if(!e.equals(this.super.grammar)&&!e._inheritsFrom(this.super.grammar))throw new Error("Cannot extend a semantics for grammar '"+this.super.grammar.name+"' for use with grammar '"+e.name+"' (not a sub-grammar)");this.operations=Object.create(this.super.operations),this.attributes=Object.create(this.super.attributes),this.attributeKeys=Object.create(null);for(const e in this.attributes)Object.defineProperty(this.attributeKeys,e,{value:X(e)})}else this.operations=Object.create(null),this.attributes=Object.create(null),this.attributeKeys=Object.create(null)}toString(){return"[semantics for "+this.grammar.name+"]"}checkActionDictsIfHaventAlready(){this.checkedActionDicts||(this.checkActionDicts(),this.checkedActionDicts=!0)}checkActionDicts(){let e;for(e in this.operations)this.operations[e].checkActionDict(this.grammar);for(e in this.attributes)this.attributes[e].checkActionDict(this.grammar)}toRecipe(e){function t(e){return e.super!==Ne.BuiltInSemantics._getSemantics()}let r="(function(g) {\n";if(t(this)){r+="  var semantics = "+this.super.toRecipe(!0)+"(g";const e=this.super.grammar;let t=this.grammar;for(;t!==e;)r+=".superGrammar",t=t.superGrammar;r+=");\n",r+="  return g.extendSemantics(semantics)"}else r+="  return g.createSemantics()";return["Operation","Attribute"].forEach((e=>{const n=this[e.toLowerCase()+"s"];Object.keys(n).forEach((s=>{const{actionDict:i,formals:o,builtInDefault:a}=n[s];let c,l=s;o.length>0&&(l+="("+o.join(", ")+")"),c=t(this)&&this.super[e.toLowerCase()+"s"][s]?"extend"+e:"add"+e,r+="\n    ."+c+"("+JSON.stringify(l)+", {";const u=[];Object.keys(i).forEach((e=>{if(i[e]!==a){let t=i[e].toString().trim();t=t.replace(/^.*\(/,"function("),u.push("\n      "+JSON.stringify(e)+": "+t)}})),r+=u.join(",")+"\n    })"}))})),r+=";\n  })",e||(r="(function() {\n  var grammar = this.fromRecipe("+this.grammar.toRecipe()+");\n  var semantics = "+r+"(grammar);\n  return semantics;\n});\n"),r}addOperationOrAttribute(e,t,r){const n=e+"s",s=Oe(t,e),{name:i}=s,{formals:o}=s;this.assertNewName(i,e);const a=function(e,t,r){return function(...n){const s=(this._semantics.operations[t]||this._semantics.attributes[t]).formals.map((e=>this.args[e]));if(this.isIteration()||1!==n.length)throw function(e,t,r,n){let s=n.slice(0,-1).map((e=>{const t="  "+e[0].name+" > "+e[1];return 3===e.length?t+" for '"+e[2]+"'":t})).join("\n");s+="\n  "+t+" > "+e;let i="";"_iter"===e&&(i=["\nNOTE: as of Ohm v16, there is no default action for iteration nodes — see ","  https://ohmjs.org/d/dsa for details."].join("\n"));const o=T([`Missing semantic action for '${e}' in ${r} '${t}'.${i}`,"Action stack (most recent call last):",s].join("\n"));return o.name="missingSemanticAction",o}(this.ctorName,t,e,we);return r.apply(n[0],s)}}(e,i,u),c={_default:a};Object.keys(r).forEach((e=>{c[e]=r[e]}));const l="operation"===e?new Le(i,o,c,a):new Ee(i,c,a);function u(...t){const r=this._semantics[n][i];if(arguments.length!==r.formals.length)throw new Error("Invalid number of arguments passed to "+i+" "+e+" (expected "+r.formals.length+", got "+arguments.length+")");const s=Object.create(null);for(const[e,n]of Object.entries(t))s[r.formals[e]]=n;const o=this.args;this.args=s;const a=r.execute(this._semantics,this);return this.args=o,a}l.checkActionDict(this.grammar),this[n][i]=l,"operation"===e?(this.Wrapper.prototype[i]=u,this.Wrapper.prototype[i].toString=function(){return"["+i+" operation]"}):(Object.defineProperty(this.Wrapper.prototype,i,{get:u,configurable:!0}),Object.defineProperty(this.attributeKeys,i,{value:X(i)}))}extendOperationOrAttribute(e,t,r){const n=e+"s";if(Oe(t,"attribute"),!this.super||!(t in this.super[n]))throw new Error("Cannot extend "+e+" '"+t+"': did not inherit an "+e+" with that name");if(Se(this[n],t))throw new Error("Cannot extend "+e+" '"+t+"' again");const s=this[n][t].formals,i=this[n][t].actionDict,o=Object.create(i);Object.keys(r).forEach((e=>{o[e]=r[e]})),this[n][t]="operation"===e?new Le(t,s,o):new Ee(t,o),this[n][t].checkActionDict(this.grammar)}assertNewName(e,t){if(Se(Ae.prototype,e))throw new Error("Cannot add "+t+" '"+e+"': that's a reserved name");if(e in this.operations)throw new Error("Cannot add "+t+" '"+e+"': an operation with that name already exists");if(e in this.attributes)throw new Error("Cannot add "+t+" '"+e+"': an attribute with that name already exists")}wrap(e,t,r){const n=r||t;return e instanceof this.Wrapper?e:new this.Wrapper(e,t,n)}}function Oe(e,t){if(!Ne.prototypeGrammar)return n(-1===e.indexOf("(")),{name:e,formals:[]};const r=Ne.prototypeGrammar.match(e,"operation"===t?"OperationSignature":"AttributeSignature");if(r.failed())throw new Error(r.message);return Ne.prototypeGrammarSemantics(r).parse()}Ne.createSemantics=function(e,t){const r=new Ne(e,void 0!==t?t:Ne.BuiltInSemantics._getSemantics()),n=function(t){if(!(t instanceof re))throw new TypeError("Semantics expected a MatchResult, but got "+g(t));if(t.failed())throw new TypeError("cannot apply Semantics to "+t.toString());const n=t._cst;if(n.grammar!==e)throw new Error("Cannot use a MatchResult from grammar '"+n.grammar.name+"' with a semantics for '"+e.name+"'");const s=new te(t.input);return r.wrap(n,s.interval(t._cstOffset,t.input.length))};return n.addOperation=function(e,t){return r.addOperationOrAttribute("operation",e,t),n},n.extendOperation=function(e,t){return r.extendOperationOrAttribute("operation",e,t),n},n.addAttribute=function(e,t){return r.addOperationOrAttribute("attribute",e,t),n},n.extendAttribute=function(e,t){return r.extendOperationOrAttribute("attribute",e,t),n},n._getActionDict=function(t){const n=r.operations[t]||r.attributes[t];if(!n)throw new Error('"'+t+'" is not a valid operation or attribute name in this semantics for "'+e.name+'"');return n.actionDict},n._remove=function(e){let t;return e in r.operations?(t=r.operations[e],delete r.operations[e]):e in r.attributes&&(t=r.attributes[e],delete r.attributes[e]),delete r.Wrapper.prototype[e],t},n.getOperationNames=function(){return Object.keys(r.operations)},n.getAttributeNames=function(){return Object.keys(r.attributes)},n.getGrammar=function(){return r.grammar},n.toRecipe=function(e){return r.toRecipe(e)},n.toString=r.toString.bind(r),n._getSemantics=function(){return r},n};class Le{constructor(e,t,r,n){this.name=e,this.formals=t,this.actionDict=r,this.builtInDefault=n}checkActionDict(e){e._checkTopDownActionDict(this.typeName,this.name,this.actionDict)}execute(e,t){try{const{ctorName:e}=t._node;let r=this.actionDict[e];return r?(we.push([this,e]),r.apply(t,t._children())):t.isNonterminal()&&(r=this.actionDict._nonterminal,r)?(we.push([this,"_nonterminal",e]),r.apply(t,t._children())):(we.push([this,"default action",e]),this.actionDict._default.apply(t,t._children()))}finally{we.pop()}}}Le.prototype.typeName="operation";class Ee extends Le{constructor(e,t,r){super(e,[],t,r)}execute(e,t){const r=t._node,n=e.attributeKeys[this.name];return Se(r,n)||(r[n]=Le.prototype.execute.call(this,e,t)),r[n]}}Ee.prototype.typeName="attribute";const Pe=["_iter","_terminal","_nonterminal","_default"];function Re(e){return Object.keys(e.rules).sort().map((t=>e.rules[t]))}let Fe,ke;class Ce{constructor(e,t,r,n){if(this.name=e,this.superGrammar=t,this.rules=r,n){if(!(n in r))throw new Error("Invalid start rule: '"+n+"' is not a rule in grammar '"+e+"'");this.defaultStartRule=n}this._matchStateInitializer=void 0,this.supportsIncrementalParsing=!0}matcher(){return new be(this)}isBuiltIn(){return this===Ce.ProtoBuiltInRules||this===Ce.BuiltInRules}equals(e){if(this===e)return!0;if(null==e||this.name!==e.name||this.defaultStartRule!==e.defaultStartRule||this.superGrammar!==e.superGrammar&&!this.superGrammar.equals(e.superGrammar))return!1;const t=Re(this),r=Re(e);return t.length===r.length&&t.every(((e,t)=>e.description===r[t].description&&e.formals.join(",")===r[t].formals.join(",")&&e.body.toString()===r[t].body.toString()))}match(e,t){const r=this.matcher();return r.replaceInputRange(0,0,e),r.match(t)}trace(e,t){const r=this.matcher();return r.replaceInputRange(0,0,e),r.trace(t)}createSemantics(){return Ne.createSemantics(this)}extendSemantics(e){return Ne.createSemantics(this,e._getSemantics())}_checkTopDownActionDict(e,t,r){const n=[];for(const e in r){const t=r[e];if(!Pe.includes(e)&&!(e in this.rules)){n.push(`'${e}' is not a valid semantic action for '${this.name}'`);continue}if("function"!=typeof t){n.push(`'${e}' must be a function in an action dictionary for '${this.name}'`);continue}const s=t.length,i=this._topDownActionArity(e);if(s!==i){let t;t="_iter"===e||"_nonterminal"===e?`it should use a rest parameter, e.g. \`${e}(...children) {}\`. NOTE: this is new in Ohm v16 — see https://ohmjs.org/d/ati for details.`:`expected ${i}, got ${s}`,n.push(`Semantic action '${e}' has the wrong arity: ${t}`)}}if(n.length>0){const r=n.map((e=>"- "+e)),s=new Error([`Found errors in the action dictionary of the '${t}' ${e}:`,...r].join("\n"));throw s.problems=n,s}}_topDownActionArity(e){return Pe.includes(e)?0:this.rules[e].body.getArity()}_inheritsFrom(e){let t=this.superGrammar;for(;t;){if(t.equals(e,!0))return!0;t=t.superGrammar}return!1}toRecipe(e=void 0){const t={};this.source&&(t.source=this.source.contents);let r=null;this.defaultStartRule&&(r=this.defaultStartRule);const n={};Object.keys(this.rules).forEach((e=>{const t=this.rules[e],{body:r}=t,s=!this.superGrammar||!this.superGrammar.rules[e];let i;i=s?"define":r instanceof N?"extend":"override";const o={};if(t.source&&this.source){const e=t.source.relativeTo(this.source);o.sourceInterval=[e.startIdx,e.endIdx]}const a=s?t.description:null,c=r.outputRecipe(t.formals,this.source);n[e]=[i,o,a,t.formals,c]}));let s="null";e?s=e:this.superGrammar&&!this.superGrammar.isBuiltIn()&&(s=this.superGrammar.toRecipe());return`[${[...["grammar",t,this.name].map(JSON.stringify),s,...[r,n].map(JSON.stringify)].join(",")}]`.replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}toOperationActionDictionaryTemplate(){return this._toOperationOrAttributeActionDictionaryTemplate()}toAttributeActionDictionaryTemplate(){return this._toOperationOrAttributeActionDictionaryTemplate()}_toOperationOrAttributeActionDictionaryTemplate(){const e=new m;e.append("{");let t=!0;for(const r in this.rules){const{body:n}=this.rules[r];t?t=!1:e.append(","),e.append("\n"),e.append("  "),this.addSemanticActionTemplate(r,n,e)}return e.append("\n}"),e.contents()}addSemanticActionTemplate(e,t,r){r.append(e),r.append(": function(");const n=this._topDownActionArity(e);r.append(a("_",n).join(", ")),r.append(") {\n"),r.append("  }")}parseApplication(e){let t;if(-1===e.indexOf("<"))t=new D(e);else{const r=Fe.match(e,"Base_application");t=ke(r,{})}if(!(t.ruleName in this.rules))throw $(t.ruleName,this.name);const{formals:r}=this.rules[t.ruleName];if(r.length!==t.args.length){const{source:e}=this.rules[t.ruleName];throw q(t.ruleName,r.length,t.args.length,e)}return t}_setUpMatchState(e){this._matchStateInitializer&&this._matchStateInitializer(e)}}Ce.ProtoBuiltInRules=new Ce("ProtoBuiltInRules",void 0,{any:{body:I,formals:[],description:"any character",primitive:!0},end:{body:x,formals:[],description:"end of input",primitive:!0},caseInsensitive:{body:new ye(new S(0)),formals:["str"],primitive:!0},lower:{body:new j("Ll"),formals:[],description:"a lowercase letter",primitive:!0},upper:{body:new j("Lu"),formals:[],description:"an uppercase letter",primitive:!0},unicodeLtmo:{body:new j("Ltmo"),formals:[],description:"a Unicode character in Lt, Lm, or Lo",primitive:!0},spaces:{body:new P(new D("space")),formals:[]},space:{body:new w("\0"," "),formals:[],description:"a space"}}),Ce.initApplicationParser=function(e,t){Fe=e,ke=t};class Me{constructor(e){this.name=e}sourceInterval(e,t){return this.source.subInterval(e,t-e)}ensureSuperGrammar(){return this.superGrammar||this.withSuperGrammar("BuiltInRules"===this.name?Ce.ProtoBuiltInRules:Ce.BuiltInRules),this.superGrammar}ensureSuperGrammarRuleForOverriding(e,t){const r=this.ensureSuperGrammar().rules[e];if(!r)throw T("Cannot override rule "+e+" because it is not declared in "+this.superGrammar.name,t);return r}installOverriddenOrExtendedRule(e,t,r,n){const s=c(t);if(s.length>0)throw z(e,s,n);const i=this.ensureSuperGrammar().rules[e],o=i.formals,a=o?o.length:0;if(t.length!==a)throw q(e,a,t.length,n);return this.install(e,t,r,i.description,n)}install(e,t,r,n,s,i=!1){return this.rules[e]={body:r.introduceParams(t),formals:t,description:n,source:s,primitive:i},this}withSuperGrammar(e){if(this.superGrammar)throw new Error("the super grammar of a GrammarDecl cannot be set more than once");return this.superGrammar=e,this.rules=Object.create(e.rules),e.isBuiltIn()||(this.defaultStartRule=e.defaultStartRule),this}withDefaultStartRule(e){return this.defaultStartRule=e,this}withSource(e){return this.source=new te(e).interval(0,e.length),this}build(){const e=new Ce(this.name,this.ensureSuperGrammar(),this.rules,this.defaultStartRule);e._matchStateInitializer=e.superGrammar._matchStateInitializer,e.supportsIncrementalParsing=e.superGrammar.supportsIncrementalParsing;const t=[];let r=!1;return Object.keys(e.rules).forEach((n=>{const{body:s}=e.rules[n];try{s.assertChoicesHaveUniformArity(n)}catch(e){t.push(e)}try{s.assertAllApplicationsAreValid(n,e)}catch(e){t.push(e),r=!0}})),r||Object.keys(e.rules).forEach((r=>{const{body:n}=e.rules[r];try{n.assertIteratedExprsAreNotNullable(e,[])}catch(e){t.push(e)}})),t.length>0&&function(e){if(1===e.length)throw e[0];if(e.length>1)throw function(e){const t=e.map((e=>e.message));return T(["Errors:"].concat(t).join("\n- "),e[0].interval)}(e)}(t),this.source&&(e.source=this.source),e}define(e,t,r,n,s,i){if(this.ensureSuperGrammar(),this.superGrammar.rules[e])throw G(e,this.name,this.superGrammar.name,s);if(this.rules[e])throw G(e,this.name,this.name,s);const o=c(t);if(o.length>0)throw z(e,o,s);return this.install(e,t,r,n,s,i)}override(e,t,r,n,s){return this.ensureSuperGrammarRuleForOverriding(e,s),this.installOverriddenOrExtendedRule(e,t,r,s),this}extend(e,t,r,n,s){if(!this.ensureSuperGrammar().rules[e])throw T("Cannot extend rule "+e+" because it is not declared in "+this.superGrammar.name,s);const i=new N(this.superGrammar,e,r);return i.source=r.source,this.installOverriddenOrExtendedRule(e,t,i,s),this}}class De{constructor(){this.currentDecl=null,this.currentRuleName=null}newGrammar(e){return new Me(e)}grammar(e,t,r,n,s){const i=new Me(t);return r&&i.withSuperGrammar(r instanceof Ce?r:this.fromRecipe(r)),n&&i.withDefaultStartRule(n),e&&e.source&&i.withSource(e.source),this.currentDecl=i,Object.keys(s).forEach((e=>{this.currentRuleName=e;const t=s[e],r=t[0],n=t[1],o=t[2],a=t[3],c=this.fromRecipe(t[4]);let l;i.source&&n&&n.sourceInterval&&(l=i.source.subInterval(n.sourceInterval[0],n.sourceInterval[1]-n.sourceInterval[0])),i[r](e,a,c,o,l)})),this.currentRuleName=this.currentDecl=null,i.build()}terminal(e){return new b(e)}range(e,t){return new w(e,t)}param(e){return new S(e)}alt(...e){let t=[];for(let r of e)r instanceof _||(r=this.fromRecipe(r)),r instanceof A?t=t.concat(r.terms):t.push(r);return 1===t.length?t[0]:new A(t)}seq(...e){let t=[];for(let r of e)r instanceof _||(r=this.fromRecipe(r)),r instanceof L?t=t.concat(r.factors):t.push(r);return 1===t.length?t[0]:new L(t)}star(e){return e instanceof _||(e=this.fromRecipe(e)),new P(e)}plus(e){return e instanceof _||(e=this.fromRecipe(e)),new R(e)}opt(e){return e instanceof _||(e=this.fromRecipe(e)),new F(e)}not(e){return e instanceof _||(e=this.fromRecipe(e)),new k(e)}lookahead(e){return e instanceof _||(e=this.fromRecipe(e)),new C(e)}lex(e){return e instanceof _||(e=this.fromRecipe(e)),new M(e)}app(e,t){return t&&t.length>0&&(t=t.map((function(e){return e instanceof _?e:this.fromRecipe(e)}),this)),new D(e,t)}splice(e,t){return new O(this.currentDecl.superGrammar,this.currentRuleName,e.map((e=>this.fromRecipe(e))),t.map((e=>this.fromRecipe(e))))}fromRecipe(e){const t="grammar"===e[0]?e.slice(1):e.slice(2),r=this[e[0]](...t),n=e[1];return n&&n.sourceInterval&&this.currentDecl&&r.withSource(this.currentDecl.sourceInterval(...n.sourceInterval)),r}}function je(e){return"function"==typeof e?e.call(new De):("string"==typeof e&&(e=JSON.parse(e)),(new De).fromRecipe(e))}var Te,Be=je(["grammar",{source:'BuiltInRules {\n\n  alnum  (an alpha-numeric character)\n    = letter\n    | digit\n\n  letter  (a letter)\n    = lower\n    | upper\n    | unicodeLtmo\n\n  digit  (a digit)\n    = "0".."9"\n\n  hexDigit  (a hexadecimal digit)\n    = digit\n    | "a".."f"\n    | "A".."F"\n\n  ListOf<elem, sep>\n    = NonemptyListOf<elem, sep>\n    | EmptyListOf<elem, sep>\n\n  NonemptyListOf<elem, sep>\n    = elem (sep elem)*\n\n  EmptyListOf<elem, sep>\n    = /* nothing */\n\n  listOf<elem, sep>\n    = nonemptyListOf<elem, sep>\n    | emptyListOf<elem, sep>\n\n  nonemptyListOf<elem, sep>\n    = elem (sep elem)*\n\n  emptyListOf<elem, sep>\n    = /* nothing */\n\n  // Allows a syntactic rule application within a lexical context.\n  applySyntactic<app> = app\n}'},"BuiltInRules",null,null,{alnum:["define",{sourceInterval:[18,78]},"an alpha-numeric character",[],["alt",{sourceInterval:[60,78]},["app",{sourceInterval:[60,66]},"letter",[]],["app",{sourceInterval:[73,78]},"digit",[]]]],letter:["define",{sourceInterval:[82,142]},"a letter",[],["alt",{sourceInterval:[107,142]},["app",{sourceInterval:[107,112]},"lower",[]],["app",{sourceInterval:[119,124]},"upper",[]],["app",{sourceInterval:[131,142]},"unicodeLtmo",[]]]],digit:["define",{sourceInterval:[146,177]},"a digit",[],["range",{sourceInterval:[169,177]},"0","9"]],hexDigit:["define",{sourceInterval:[181,254]},"a hexadecimal digit",[],["alt",{sourceInterval:[219,254]},["app",{sourceInterval:[219,224]},"digit",[]],["range",{sourceInterval:[231,239]},"a","f"],["range",{sourceInterval:[246,254]},"A","F"]]],ListOf:["define",{sourceInterval:[258,336]},null,["elem","sep"],["alt",{sourceInterval:[282,336]},["app",{sourceInterval:[282,307]},"NonemptyListOf",[["param",{sourceInterval:[297,301]},0],["param",{sourceInterval:[303,306]},1]]],["app",{sourceInterval:[314,336]},"EmptyListOf",[["param",{sourceInterval:[326,330]},0],["param",{sourceInterval:[332,335]},1]]]]],NonemptyListOf:["define",{sourceInterval:[340,388]},null,["elem","sep"],["seq",{sourceInterval:[372,388]},["param",{sourceInterval:[372,376]},0],["star",{sourceInterval:[377,388]},["seq",{sourceInterval:[378,386]},["param",{sourceInterval:[378,381]},1],["param",{sourceInterval:[382,386]},0]]]]],EmptyListOf:["define",{sourceInterval:[392,434]},null,["elem","sep"],["seq",{sourceInterval:[438,438]}]],listOf:["define",{sourceInterval:[438,516]},null,["elem","sep"],["alt",{sourceInterval:[462,516]},["app",{sourceInterval:[462,487]},"nonemptyListOf",[["param",{sourceInterval:[477,481]},0],["param",{sourceInterval:[483,486]},1]]],["app",{sourceInterval:[494,516]},"emptyListOf",[["param",{sourceInterval:[506,510]},0],["param",{sourceInterval:[512,515]},1]]]]],nonemptyListOf:["define",{sourceInterval:[520,568]},null,["elem","sep"],["seq",{sourceInterval:[552,568]},["param",{sourceInterval:[552,556]},0],["star",{sourceInterval:[557,568]},["seq",{sourceInterval:[558,566]},["param",{sourceInterval:[558,561]},1],["param",{sourceInterval:[562,566]},0]]]]],emptyListOf:["define",{sourceInterval:[572,682]},null,["elem","sep"],["seq",{sourceInterval:[685,685]}]],applySyntactic:["define",{sourceInterval:[685,710]},null,["app"],["param",{sourceInterval:[707,710]},0]]}]);Ce.BuiltInRules=Be,Te=Ce.BuiltInRules,W.forEach((e=>{e(Te)})),W=null;var $e=je(["grammar",{source:'Ohm {\n\n  Grammars\n    = Grammar*\n\n  Grammar\n    = ident SuperGrammar? "{" Rule* "}"\n\n  SuperGrammar\n    = "<:" ident\n\n  Rule\n    = ident Formals? ruleDescr? "="  RuleBody  -- define\n    | ident Formals?            ":=" OverrideRuleBody  -- override\n    | ident Formals?            "+=" RuleBody  -- extend\n\n  RuleBody\n    = "|"? NonemptyListOf<TopLevelTerm, "|">\n\n  TopLevelTerm\n    = Seq caseName  -- inline\n    | Seq\n\n  OverrideRuleBody\n    = "|"? NonemptyListOf<OverrideTopLevelTerm, "|">\n\n  OverrideTopLevelTerm\n    = "..."  -- superSplice\n    | TopLevelTerm\n\n  Formals\n    = "<" ListOf<ident, ","> ">"\n\n  Params\n    = "<" ListOf<Seq, ","> ">"\n\n  Alt\n    = NonemptyListOf<Seq, "|">\n\n  Seq\n    = Iter*\n\n  Iter\n    = Pred "*"  -- star\n    | Pred "+"  -- plus\n    | Pred "?"  -- opt\n    | Pred\n\n  Pred\n    = "~" Lex  -- not\n    | "&" Lex  -- lookahead\n    | Lex\n\n  Lex\n    = "#" Base  -- lex\n    | Base\n\n  Base\n    = ident Params? ~(ruleDescr? "=" | ":=" | "+=")  -- application\n    | oneCharTerminal ".." oneCharTerminal           -- range\n    | terminal                                       -- terminal\n    | "(" Alt ")"                                    -- paren\n\n  ruleDescr  (a rule description)\n    = "(" ruleDescrText ")"\n\n  ruleDescrText\n    = (~")" any)*\n\n  caseName\n    = "--" (~"\\n" space)* name (~"\\n" space)* ("\\n" | &"}")\n\n  name  (a name)\n    = nameFirst nameRest*\n\n  nameFirst\n    = "_"\n    | letter\n\n  nameRest\n    = "_"\n    | alnum\n\n  ident  (an identifier)\n    = name\n\n  terminal\n    = "\\"" terminalChar* "\\""\n\n  oneCharTerminal\n    = "\\"" terminalChar "\\""\n\n  terminalChar\n    = escapeChar\n      | ~"\\\\" ~"\\"" ~"\\n" "\\u{0}".."\\u{10FFFF}"\n\n  escapeChar  (an escape sequence)\n    = "\\\\\\\\"                                     -- backslash\n    | "\\\\\\""                                     -- doubleQuote\n    | "\\\\\\\'"                                     -- singleQuote\n    | "\\\\b"                                      -- backspace\n    | "\\\\n"                                      -- lineFeed\n    | "\\\\r"                                      -- carriageReturn\n    | "\\\\t"                                      -- tab\n    | "\\\\u{" hexDigit hexDigit? hexDigit?\n             hexDigit? hexDigit? hexDigit? "}"   -- unicodeCodePoint\n    | "\\\\u" hexDigit hexDigit hexDigit hexDigit  -- unicodeEscape\n    | "\\\\x" hexDigit hexDigit                    -- hexEscape\n\n  space\n   += comment\n\n  comment\n    = "//" (~"\\n" any)* &("\\n" | end)  -- singleLine\n    | "/*" (~"*/" any)* "*/"  -- multiLine\n\n  tokens = token*\n\n  token = caseName | comment | ident | operator | punctuation | terminal | any\n\n  operator = "<:" | "=" | ":=" | "+=" | "*" | "+" | "?" | "~" | "&"\n\n  punctuation = "<" | ">" | "," | "--"\n}'},"Ohm",null,"Grammars",{Grammars:["define",{sourceInterval:[9,32]},null,[],["star",{sourceInterval:[24,32]},["app",{sourceInterval:[24,31]},"Grammar",[]]]],Grammar:["define",{sourceInterval:[36,83]},null,[],["seq",{sourceInterval:[50,83]},["app",{sourceInterval:[50,55]},"ident",[]],["opt",{sourceInterval:[56,69]},["app",{sourceInterval:[56,68]},"SuperGrammar",[]]],["terminal",{sourceInterval:[70,73]},"{"],["star",{sourceInterval:[74,79]},["app",{sourceInterval:[74,78]},"Rule",[]]],["terminal",{sourceInterval:[80,83]},"}"]]],SuperGrammar:["define",{sourceInterval:[87,116]},null,[],["seq",{sourceInterval:[106,116]},["terminal",{sourceInterval:[106,110]},"<:"],["app",{sourceInterval:[111,116]},"ident",[]]]],Rule_define:["define",{sourceInterval:[131,181]},null,[],["seq",{sourceInterval:[131,170]},["app",{sourceInterval:[131,136]},"ident",[]],["opt",{sourceInterval:[137,145]},["app",{sourceInterval:[137,144]},"Formals",[]]],["opt",{sourceInterval:[146,156]},["app",{sourceInterval:[146,155]},"ruleDescr",[]]],["terminal",{sourceInterval:[157,160]},"="],["app",{sourceInterval:[162,170]},"RuleBody",[]]]],Rule_override:["define",{sourceInterval:[188,248]},null,[],["seq",{sourceInterval:[188,235]},["app",{sourceInterval:[188,193]},"ident",[]],["opt",{sourceInterval:[194,202]},["app",{sourceInterval:[194,201]},"Formals",[]]],["terminal",{sourceInterval:[214,218]},":="],["app",{sourceInterval:[219,235]},"OverrideRuleBody",[]]]],Rule_extend:["define",{sourceInterval:[255,305]},null,[],["seq",{sourceInterval:[255,294]},["app",{sourceInterval:[255,260]},"ident",[]],["opt",{sourceInterval:[261,269]},["app",{sourceInterval:[261,268]},"Formals",[]]],["terminal",{sourceInterval:[281,285]},"+="],["app",{sourceInterval:[286,294]},"RuleBody",[]]]],Rule:["define",{sourceInterval:[120,305]},null,[],["alt",{sourceInterval:[131,305]},["app",{sourceInterval:[131,170]},"Rule_define",[]],["app",{sourceInterval:[188,235]},"Rule_override",[]],["app",{sourceInterval:[255,294]},"Rule_extend",[]]]],RuleBody:["define",{sourceInterval:[309,362]},null,[],["seq",{sourceInterval:[324,362]},["opt",{sourceInterval:[324,328]},["terminal",{sourceInterval:[324,327]},"|"]],["app",{sourceInterval:[329,362]},"NonemptyListOf",[["app",{sourceInterval:[344,356]},"TopLevelTerm",[]],["terminal",{sourceInterval:[358,361]},"|"]]]]],TopLevelTerm_inline:["define",{sourceInterval:[385,408]},null,[],["seq",{sourceInterval:[385,397]},["app",{sourceInterval:[385,388]},"Seq",[]],["app",{sourceInterval:[389,397]},"caseName",[]]]],TopLevelTerm:["define",{sourceInterval:[366,418]},null,[],["alt",{sourceInterval:[385,418]},["app",{sourceInterval:[385,397]},"TopLevelTerm_inline",[]],["app",{sourceInterval:[415,418]},"Seq",[]]]],OverrideRuleBody:["define",{sourceInterval:[422,491]},null,[],["seq",{sourceInterval:[445,491]},["opt",{sourceInterval:[445,449]},["terminal",{sourceInterval:[445,448]},"|"]],["app",{sourceInterval:[450,491]},"NonemptyListOf",[["app",{sourceInterval:[465,485]},"OverrideTopLevelTerm",[]],["terminal",{sourceInterval:[487,490]},"|"]]]]],OverrideTopLevelTerm_superSplice:["define",{sourceInterval:[522,543]},null,[],["terminal",{sourceInterval:[522,527]},"..."]],OverrideTopLevelTerm:["define",{sourceInterval:[495,562]},null,[],["alt",{sourceInterval:[522,562]},["app",{sourceInterval:[522,527]},"OverrideTopLevelTerm_superSplice",[]],["app",{sourceInterval:[550,562]},"TopLevelTerm",[]]]],Formals:["define",{sourceInterval:[566,606]},null,[],["seq",{sourceInterval:[580,606]},["terminal",{sourceInterval:[580,583]},"<"],["app",{sourceInterval:[584,602]},"ListOf",[["app",{sourceInterval:[591,596]},"ident",[]],["terminal",{sourceInterval:[598,601]},","]]],["terminal",{sourceInterval:[603,606]},">"]]],Params:["define",{sourceInterval:[610,647]},null,[],["seq",{sourceInterval:[623,647]},["terminal",{sourceInterval:[623,626]},"<"],["app",{sourceInterval:[627,643]},"ListOf",[["app",{sourceInterval:[634,637]},"Seq",[]],["terminal",{sourceInterval:[639,642]},","]]],["terminal",{sourceInterval:[644,647]},">"]]],Alt:["define",{sourceInterval:[651,685]},null,[],["app",{sourceInterval:[661,685]},"NonemptyListOf",[["app",{sourceInterval:[676,679]},"Seq",[]],["terminal",{sourceInterval:[681,684]},"|"]]]],Seq:["define",{sourceInterval:[689,704]},null,[],["star",{sourceInterval:[699,704]},["app",{sourceInterval:[699,703]},"Iter",[]]]],Iter_star:["define",{sourceInterval:[719,736]},null,[],["seq",{sourceInterval:[719,727]},["app",{sourceInterval:[719,723]},"Pred",[]],["terminal",{sourceInterval:[724,727]},"*"]]],Iter_plus:["define",{sourceInterval:[743,760]},null,[],["seq",{sourceInterval:[743,751]},["app",{sourceInterval:[743,747]},"Pred",[]],["terminal",{sourceInterval:[748,751]},"+"]]],Iter_opt:["define",{sourceInterval:[767,783]},null,[],["seq",{sourceInterval:[767,775]},["app",{sourceInterval:[767,771]},"Pred",[]],["terminal",{sourceInterval:[772,775]},"?"]]],Iter:["define",{sourceInterval:[708,794]},null,[],["alt",{sourceInterval:[719,794]},["app",{sourceInterval:[719,727]},"Iter_star",[]],["app",{sourceInterval:[743,751]},"Iter_plus",[]],["app",{sourceInterval:[767,775]},"Iter_opt",[]],["app",{sourceInterval:[790,794]},"Pred",[]]]],Pred_not:["define",{sourceInterval:[809,824]},null,[],["seq",{sourceInterval:[809,816]},["terminal",{sourceInterval:[809,812]},"~"],["app",{sourceInterval:[813,816]},"Lex",[]]]],Pred_lookahead:["define",{sourceInterval:[831,852]},null,[],["seq",{sourceInterval:[831,838]},["terminal",{sourceInterval:[831,834]},"&"],["app",{sourceInterval:[835,838]},"Lex",[]]]],Pred:["define",{sourceInterval:[798,862]},null,[],["alt",{sourceInterval:[809,862]},["app",{sourceInterval:[809,816]},"Pred_not",[]],["app",{sourceInterval:[831,838]},"Pred_lookahead",[]],["app",{sourceInterval:[859,862]},"Lex",[]]]],Lex_lex:["define",{sourceInterval:[876,892]},null,[],["seq",{sourceInterval:[876,884]},["terminal",{sourceInterval:[876,879]},"#"],["app",{sourceInterval:[880,884]},"Base",[]]]],Lex:["define",{sourceInterval:[866,903]},null,[],["alt",{sourceInterval:[876,903]},["app",{sourceInterval:[876,884]},"Lex_lex",[]],["app",{sourceInterval:[899,903]},"Base",[]]]],Base_application:["define",{sourceInterval:[918,979]},null,[],["seq",{sourceInterval:[918,963]},["app",{sourceInterval:[918,923]},"ident",[]],["opt",{sourceInterval:[924,931]},["app",{sourceInterval:[924,930]},"Params",[]]],["not",{sourceInterval:[932,963]},["alt",{sourceInterval:[934,962]},["seq",{sourceInterval:[934,948]},["opt",{sourceInterval:[934,944]},["app",{sourceInterval:[934,943]},"ruleDescr",[]]],["terminal",{sourceInterval:[945,948]},"="]],["terminal",{sourceInterval:[951,955]},":="],["terminal",{sourceInterval:[958,962]},"+="]]]]],Base_range:["define",{sourceInterval:[986,1041]},null,[],["seq",{sourceInterval:[986,1022]},["app",{sourceInterval:[986,1001]},"oneCharTerminal",[]],["terminal",{sourceInterval:[1002,1006]},".."],["app",{sourceInterval:[1007,1022]},"oneCharTerminal",[]]]],Base_terminal:["define",{sourceInterval:[1048,1106]},null,[],["app",{sourceInterval:[1048,1056]},"terminal",[]]],Base_paren:["define",{sourceInterval:[1113,1168]},null,[],["seq",{sourceInterval:[1113,1124]},["terminal",{sourceInterval:[1113,1116]},"("],["app",{sourceInterval:[1117,1120]},"Alt",[]],["terminal",{sourceInterval:[1121,1124]},")"]]],Base:["define",{sourceInterval:[907,1168]},null,[],["alt",{sourceInterval:[918,1168]},["app",{sourceInterval:[918,963]},"Base_application",[]],["app",{sourceInterval:[986,1022]},"Base_range",[]],["app",{sourceInterval:[1048,1056]},"Base_terminal",[]],["app",{sourceInterval:[1113,1124]},"Base_paren",[]]]],ruleDescr:["define",{sourceInterval:[1172,1231]},"a rule description",[],["seq",{sourceInterval:[1210,1231]},["terminal",{sourceInterval:[1210,1213]},"("],["app",{sourceInterval:[1214,1227]},"ruleDescrText",[]],["terminal",{sourceInterval:[1228,1231]},")"]]],ruleDescrText:["define",{sourceInterval:[1235,1266]},null,[],["star",{sourceInterval:[1255,1266]},["seq",{sourceInterval:[1256,1264]},["not",{sourceInterval:[1256,1260]},["terminal",{sourceInterval:[1257,1260]},")"]],["app",{sourceInterval:[1261,1264]},"any",[]]]]],caseName:["define",{sourceInterval:[1270,1338]},null,[],["seq",{sourceInterval:[1285,1338]},["terminal",{sourceInterval:[1285,1289]},"--"],["star",{sourceInterval:[1290,1304]},["seq",{sourceInterval:[1291,1302]},["not",{sourceInterval:[1291,1296]},["terminal",{sourceInterval:[1292,1296]},"\n"]],["app",{sourceInterval:[1297,1302]},"space",[]]]],["app",{sourceInterval:[1305,1309]},"name",[]],["star",{sourceInterval:[1310,1324]},["seq",{sourceInterval:[1311,1322]},["not",{sourceInterval:[1311,1316]},["terminal",{sourceInterval:[1312,1316]},"\n"]],["app",{sourceInterval:[1317,1322]},"space",[]]]],["alt",{sourceInterval:[1326,1337]},["terminal",{sourceInterval:[1326,1330]},"\n"],["lookahead",{sourceInterval:[1333,1337]},["terminal",{sourceInterval:[1334,1337]},"}"]]]]],name:["define",{sourceInterval:[1342,1382]},"a name",[],["seq",{sourceInterval:[1363,1382]},["app",{sourceInterval:[1363,1372]},"nameFirst",[]],["star",{sourceInterval:[1373,1382]},["app",{sourceInterval:[1373,1381]},"nameRest",[]]]]],nameFirst:["define",{sourceInterval:[1386,1418]},null,[],["alt",{sourceInterval:[1402,1418]},["terminal",{sourceInterval:[1402,1405]},"_"],["app",{sourceInterval:[1412,1418]},"letter",[]]]],nameRest:["define",{sourceInterval:[1422,1452]},null,[],["alt",{sourceInterval:[1437,1452]},["terminal",{sourceInterval:[1437,1440]},"_"],["app",{sourceInterval:[1447,1452]},"alnum",[]]]],ident:["define",{sourceInterval:[1456,1489]},"an identifier",[],["app",{sourceInterval:[1485,1489]},"name",[]]],terminal:["define",{sourceInterval:[1493,1531]},null,[],["seq",{sourceInterval:[1508,1531]},["terminal",{sourceInterval:[1508,1512]},'"'],["star",{sourceInterval:[1513,1526]},["app",{sourceInterval:[1513,1525]},"terminalChar",[]]],["terminal",{sourceInterval:[1527,1531]},'"']]],oneCharTerminal:["define",{sourceInterval:[1535,1579]},null,[],["seq",{sourceInterval:[1557,1579]},["terminal",{sourceInterval:[1557,1561]},'"'],["app",{sourceInterval:[1562,1574]},"terminalChar",[]],["terminal",{sourceInterval:[1575,1579]},'"']]],terminalChar:["define",{sourceInterval:[1583,1660]},null,[],["alt",{sourceInterval:[1602,1660]},["app",{sourceInterval:[1602,1612]},"escapeChar",[]],["seq",{sourceInterval:[1621,1660]},["not",{sourceInterval:[1621,1626]},["terminal",{sourceInterval:[1622,1626]},"\\"]],["not",{sourceInterval:[1627,1632]},["terminal",{sourceInterval:[1628,1632]},'"']],["not",{sourceInterval:[1633,1638]},["terminal",{sourceInterval:[1634,1638]},"\n"]],["range",{sourceInterval:[1639,1660]},"\0","􏿿"]]]],escapeChar_backslash:["define",{sourceInterval:[1703,1758]},null,[],["terminal",{sourceInterval:[1703,1709]},"\\\\"]],escapeChar_doubleQuote:["define",{sourceInterval:[1765,1822]},null,[],["terminal",{sourceInterval:[1765,1771]},'\\"']],escapeChar_singleQuote:["define",{sourceInterval:[1829,1886]},null,[],["terminal",{sourceInterval:[1829,1835]},"\\'"]],escapeChar_backspace:["define",{sourceInterval:[1893,1948]},null,[],["terminal",{sourceInterval:[1893,1898]},"\\b"]],escapeChar_lineFeed:["define",{sourceInterval:[1955,2009]},null,[],["terminal",{sourceInterval:[1955,1960]},"\\n"]],escapeChar_carriageReturn:["define",{sourceInterval:[2016,2076]},null,[],["terminal",{sourceInterval:[2016,2021]},"\\r"]],escapeChar_tab:["define",{sourceInterval:[2083,2132]},null,[],["terminal",{sourceInterval:[2083,2088]},"\\t"]],escapeChar_unicodeCodePoint:["define",{sourceInterval:[2139,2243]},null,[],["seq",{sourceInterval:[2139,2221]},["terminal",{sourceInterval:[2139,2145]},"\\u{"],["app",{sourceInterval:[2146,2154]},"hexDigit",[]],["opt",{sourceInterval:[2155,2164]},["app",{sourceInterval:[2155,2163]},"hexDigit",[]]],["opt",{sourceInterval:[2165,2174]},["app",{sourceInterval:[2165,2173]},"hexDigit",[]]],["opt",{sourceInterval:[2188,2197]},["app",{sourceInterval:[2188,2196]},"hexDigit",[]]],["opt",{sourceInterval:[2198,2207]},["app",{sourceInterval:[2198,2206]},"hexDigit",[]]],["opt",{sourceInterval:[2208,2217]},["app",{sourceInterval:[2208,2216]},"hexDigit",[]]],["terminal",{sourceInterval:[2218,2221]},"}"]]],escapeChar_unicodeEscape:["define",{sourceInterval:[2250,2309]},null,[],["seq",{sourceInterval:[2250,2291]},["terminal",{sourceInterval:[2250,2255]},"\\u"],["app",{sourceInterval:[2256,2264]},"hexDigit",[]],["app",{sourceInterval:[2265,2273]},"hexDigit",[]],["app",{sourceInterval:[2274,2282]},"hexDigit",[]],["app",{sourceInterval:[2283,2291]},"hexDigit",[]]]],escapeChar_hexEscape:["define",{sourceInterval:[2316,2371]},null,[],["seq",{sourceInterval:[2316,2339]},["terminal",{sourceInterval:[2316,2321]},"\\x"],["app",{sourceInterval:[2322,2330]},"hexDigit",[]],["app",{sourceInterval:[2331,2339]},"hexDigit",[]]]],escapeChar:["define",{sourceInterval:[1664,2371]},"an escape sequence",[],["alt",{sourceInterval:[1703,2371]},["app",{sourceInterval:[1703,1709]},"escapeChar_backslash",[]],["app",{sourceInterval:[1765,1771]},"escapeChar_doubleQuote",[]],["app",{sourceInterval:[1829,1835]},"escapeChar_singleQuote",[]],["app",{sourceInterval:[1893,1898]},"escapeChar_backspace",[]],["app",{sourceInterval:[1955,1960]},"escapeChar_lineFeed",[]],["app",{sourceInterval:[2016,2021]},"escapeChar_carriageReturn",[]],["app",{sourceInterval:[2083,2088]},"escapeChar_tab",[]],["app",{sourceInterval:[2139,2221]},"escapeChar_unicodeCodePoint",[]],["app",{sourceInterval:[2250,2291]},"escapeChar_unicodeEscape",[]],["app",{sourceInterval:[2316,2339]},"escapeChar_hexEscape",[]]]],space:["extend",{sourceInterval:[2375,2394]},null,[],["app",{sourceInterval:[2387,2394]},"comment",[]]],comment_singleLine:["define",{sourceInterval:[2412,2458]},null,[],["seq",{sourceInterval:[2412,2443]},["terminal",{sourceInterval:[2412,2416]},"//"],["star",{sourceInterval:[2417,2429]},["seq",{sourceInterval:[2418,2427]},["not",{sourceInterval:[2418,2423]},["terminal",{sourceInterval:[2419,2423]},"\n"]],["app",{sourceInterval:[2424,2427]},"any",[]]]],["lookahead",{sourceInterval:[2430,2443]},["alt",{sourceInterval:[2432,2442]},["terminal",{sourceInterval:[2432,2436]},"\n"],["app",{sourceInterval:[2439,2442]},"end",[]]]]]],comment_multiLine:["define",{sourceInterval:[2465,2501]},null,[],["seq",{sourceInterval:[2465,2487]},["terminal",{sourceInterval:[2465,2469]},"/*"],["star",{sourceInterval:[2470,2482]},["seq",{sourceInterval:[2471,2480]},["not",{sourceInterval:[2471,2476]},["terminal",{sourceInterval:[2472,2476]},"*/"]],["app",{sourceInterval:[2477,2480]},"any",[]]]],["terminal",{sourceInterval:[2483,2487]},"*/"]]],comment:["define",{sourceInterval:[2398,2501]},null,[],["alt",{sourceInterval:[2412,2501]},["app",{sourceInterval:[2412,2443]},"comment_singleLine",[]],["app",{sourceInterval:[2465,2487]},"comment_multiLine",[]]]],tokens:["define",{sourceInterval:[2505,2520]},null,[],["star",{sourceInterval:[2514,2520]},["app",{sourceInterval:[2514,2519]},"token",[]]]],token:["define",{sourceInterval:[2524,2600]},null,[],["alt",{sourceInterval:[2532,2600]},["app",{sourceInterval:[2532,2540]},"caseName",[]],["app",{sourceInterval:[2543,2550]},"comment",[]],["app",{sourceInterval:[2553,2558]},"ident",[]],["app",{sourceInterval:[2561,2569]},"operator",[]],["app",{sourceInterval:[2572,2583]},"punctuation",[]],["app",{sourceInterval:[2586,2594]},"terminal",[]],["app",{sourceInterval:[2597,2600]},"any",[]]]],operator:["define",{sourceInterval:[2604,2669]},null,[],["alt",{sourceInterval:[2615,2669]},["terminal",{sourceInterval:[2615,2619]},"<:"],["terminal",{sourceInterval:[2622,2625]},"="],["terminal",{sourceInterval:[2628,2632]},":="],["terminal",{sourceInterval:[2635,2639]},"+="],["terminal",{sourceInterval:[2642,2645]},"*"],["terminal",{sourceInterval:[2648,2651]},"+"],["terminal",{sourceInterval:[2654,2657]},"?"],["terminal",{sourceInterval:[2660,2663]},"~"],["terminal",{sourceInterval:[2666,2669]},"&"]]],punctuation:["define",{sourceInterval:[2673,2709]},null,[],["alt",{sourceInterval:[2687,2709]},["terminal",{sourceInterval:[2687,2690]},"<"],["terminal",{sourceInterval:[2693,2696]},">"],["terminal",{sourceInterval:[2699,2702]},","],["terminal",{sourceInterval:[2705,2709]},"--"]]]}]);const Ge=Object.create(_.prototype);function qe(e,t){for(const r in e)if(r===t)return!0;return!1}function ze(e,t,r){const s=new De;let i,o,a,c=!1;const l=(r||$e).createSemantics().addOperation("visit",{Grammars:e=>e.children.map((e=>e.visit())),Grammar(e,r,n,o,a){const c=e.visit();i=s.newGrammar(c),r.child(0)&&r.child(0).visit(),o.children.map((e=>e.visit()));const l=i.build();if(l.source=this.source.trimmed(),qe(t,c))throw function(e,t){return T("Grammar "+e.name+" is already declared in this namespace")}(l);return t[c]=l,l},SuperGrammar(e,r){const n=r.visit();if("null"===n)i.withSuperGrammar(null);else{if(!t||!qe(t,n))throw function(e,t,r){return T(t?`Grammar ${e} is not declared in namespace '${t}'`:"Undeclared grammar "+e,r)}(n,t,r.source);i.withSuperGrammar(t[n])}},Rule_define(e,t,r,n,s){o=e.visit(),a=t.children.map((e=>e.visit()))[0]||[],i.defaultStartRule||i.ensureSuperGrammar()===Ce.ProtoBuiltInRules||i.withDefaultStartRule(o);const c=s.visit(),l=r.children.map((e=>e.visit()))[0],u=this.source.trimmed();return i.define(o,a,c,l,u)},Rule_override(e,t,r,n){o=e.visit(),a=t.children.map((e=>e.visit()))[0]||[];const s=this.source.trimmed();i.ensureSuperGrammarRuleForOverriding(o,s),c=!0;const l=n.visit();return c=!1,i.override(o,a,l,null,s)},Rule_extend(e,t,r,n){o=e.visit(),a=t.children.map((e=>e.visit()))[0]||[];const s=n.visit(),c=this.source.trimmed();return i.extend(o,a,s,null,c)},RuleBody(e,t){return s.alt(...t.visit()).withSource(this.source)},OverrideRuleBody(e,t){const r=t.visit(),n=r.indexOf(Ge);if(n>=0){const e=r.slice(0,n),t=r.slice(n+1);return t.forEach((e=>{if(e===Ge)throw T("'...' can appear at most once in a rule body",e.source)})),new O(i.superGrammar,o,e,t).withSource(this.source)}return s.alt(...r).withSource(this.source)},Formals:(e,t,r)=>t.visit(),Params:(e,t,r)=>t.visit(),Alt(e){return s.alt(...e.visit()).withSource(this.source)},TopLevelTerm_inline(e,t){const r=o+"_"+t.visit(),n=e.visit(),l=this.source.trimmed(),u=!(i.superGrammar&&i.superGrammar.rules[r]);c&&!u?i.override(r,a,n,null,l):i.define(r,a,n,null,l);const p=a.map((e=>s.app(e)));return s.app(r,p).withSource(n.source)},OverrideTopLevelTerm_superSplice:e=>Ge,Seq(e){return s.seq(...e.children.map((e=>e.visit()))).withSource(this.source)},Iter_star(e,t){return s.star(e.visit()).withSource(this.source)},Iter_plus(e,t){return s.plus(e.visit()).withSource(this.source)},Iter_opt(e,t){return s.opt(e.visit()).withSource(this.source)},Pred_not(e,t){return s.not(t.visit()).withSource(this.source)},Pred_lookahead(e,t){return s.lookahead(t.visit()).withSource(this.source)},Lex_lex(e,t){return s.lex(t.visit()).withSource(this.source)},Base_application(e,t){const r=t.children.map((e=>e.visit()))[0]||[];return s.app(e.visit(),r).withSource(this.source)},Base_range(e,t,r){return s.range(e.visit(),r.visit()).withSource(this.source)},Base_terminal(e){return s.terminal(e.visit()).withSource(this.source)},Base_paren:(e,t,r)=>t.visit(),ruleDescr:(e,t,r)=>t.visit(),ruleDescrText(e){return this.sourceString.trim()},caseName:(e,t,r,n,s)=>r.visit(),name(e,t){return this.sourceString},nameFirst(e){},nameRest(e){},terminal:(e,t,r)=>t.children.map((e=>e.visit())).join(""),oneCharTerminal:(e,t,r)=>t.visit(),escapeChar(e){try{return f(this.sourceString)}catch(t){if(t instanceof RangeError&&t.message.startsWith("Invalid code point "))throw function(e){const t=e._node;n(t&&t.isNonterminal()&&"escapeChar_unicodeCodePoint"===t.ctorName);const r=e.children.slice(1,-1).map((e=>e.source)),s=r[0].coverageWith(...r.slice(1));return T(`U+${s.contents} is not a valid Unicode code point`,s)}(e);throw t}},NonemptyListOf:(e,t,r)=>[e.visit()].concat(r.children.map((e=>e.visit()))),EmptyListOf:()=>[],_terminal(){return this.sourceString}});return l(e).visit()}var Ue=je(["grammar",{source:'OperationsAndAttributes {\n\n  AttributeSignature =\n    name\n\n  OperationSignature =\n    name Formals?\n\n  Formals\n    = "(" ListOf<name, ","> ")"\n\n  name  (a name)\n    = nameFirst nameRest*\n\n  nameFirst\n    = "_"\n    | letter\n\n  nameRest\n    = "_"\n    | alnum\n\n}'},"OperationsAndAttributes",null,"AttributeSignature",{AttributeSignature:["define",{sourceInterval:[29,58]},null,[],["app",{sourceInterval:[54,58]},"name",[]]],OperationSignature:["define",{sourceInterval:[62,100]},null,[],["seq",{sourceInterval:[87,100]},["app",{sourceInterval:[87,91]},"name",[]],["opt",{sourceInterval:[92,100]},["app",{sourceInterval:[92,99]},"Formals",[]]]]],Formals:["define",{sourceInterval:[104,143]},null,[],["seq",{sourceInterval:[118,143]},["terminal",{sourceInterval:[118,121]},"("],["app",{sourceInterval:[122,139]},"ListOf",[["app",{sourceInterval:[129,133]},"name",[]],["terminal",{sourceInterval:[135,138]},","]]],["terminal",{sourceInterval:[140,143]},")"]]],name:["define",{sourceInterval:[147,187]},"a name",[],["seq",{sourceInterval:[168,187]},["app",{sourceInterval:[168,177]},"nameFirst",[]],["star",{sourceInterval:[178,187]},["app",{sourceInterval:[178,186]},"nameRest",[]]]]],nameFirst:["define",{sourceInterval:[191,223]},null,[],["alt",{sourceInterval:[207,223]},["terminal",{sourceInterval:[207,210]},"_"],["app",{sourceInterval:[217,223]},"letter",[]]]],nameRest:["define",{sourceInterval:[227,257]},null,[],["alt",{sourceInterval:[242,257]},["terminal",{sourceInterval:[242,245]},"_"],["app",{sourceInterval:[252,257]},"alnum",[]]]]}]);!function(e){const t={empty(){return this.iteration()},nonEmpty(e,t,r){return this.iteration([e].concat(r.children))}};Ne.BuiltInSemantics=Ne.createSemantics(e,null).addOperation("asIteration",{emptyListOf:t.empty,nonemptyListOf:t.nonEmpty,EmptyListOf:t.empty,NonemptyListOf:t.nonEmpty})}(Ce.BuiltInRules),function(e){Ne.prototypeGrammarSemantics=e.createSemantics().addOperation("parse",{AttributeSignature:e=>({name:e.parse(),formals:[]}),OperationSignature:(e,t)=>({name:e.parse(),formals:t.children.map((e=>e.parse()))[0]||[]}),Formals:(e,t,r)=>t.asIteration().children.map((e=>e.parse())),name(e,t){return this.sourceString}}),Ne.prototypeGrammar=e}(Ue);const Ke="an indented block",Ve="a dedent",Je=1114112;class He extends te{constructor(e){super(e.input),this.state=e}_indentationAt(e){return this.state.userData[e]||0}atEnd(){return super.atEnd()&&0===this._indentationAt(this.pos)}next(){if(0===this._indentationAt(this.pos))return super.next();this.examinedLength=Math.max(this.examinedLength,this.pos)}nextCharCode(){return 0!==this._indentationAt(this.pos)?(this.examinedLength=Math.max(this.examinedLength,this.pos),Je):super.nextCharCode()}nextCodePoint(){return 0!==this._indentationAt(this.pos)?(this.examinedLength=Math.max(this.examinedLength,this.pos),Je):super.nextCodePoint()}}class We extends _{constructor(e=!0){super(),this.isIndent=e}allowsSkippingPrecedingSpace(){return!0}eval(e){const{inputStream:t}=e,r=e.userData;e.doNotMemoize=!0;const n=t.pos,s=this.isIndent?1:-1;return(r[n]||0)*s>0?(e.userData=Object.create(r),e.userData[n]-=s,e.pushBinding(new ue(0),n),!0):(e.processFailure(n,this),!1)}getArity(){return 1}_assertAllApplicationsAreValid(e,t){}_isNullable(e,t){return!1}assertChoicesHaveUniformArity(e){}assertIteratedExprsAreNotNullable(e){}introduceParams(e){return this}substituteParams(e){return this}toString(){return this.isIndent?"indent":"dedent"}toDisplayString(){return this.toString()}toFailure(e){const t=this.isIndent?Ke:Ve;return new ge(this,t,"description")}}const Qe=new D("indent"),Ze=new D("dedent"),Ye=new O(Be,"any",[Qe,Ze],[]),Xe=(new De).newGrammar("IndentationSensitive").withSuperGrammar(Be).define("indent",[],new We(!0),Ke,void 0,!0).define("dedent",[],new We(!1),Ve,void 0,!0).extend("any",[],Ye,"any character",void 0).build();Object.assign(Xe,{_matchStateInitializer(e){e.userData=function(e){let t=0;const r=[0],n=()=>r[r.length-1],s={},i=/( *).*(?:$|\r?\n|\r)/g;let o;for(;null!=(o=i.exec(e));){const[e,i]=o;if(0===e.length)break;const a=i.length,c=n(),l=t+a;if(a>c)r.push(a),s[l]=1;else if(a<c){const e=r.length;for(;n()!==a;)r.pop();s[l]=-1*(e-r.length)}t+=e.length}return r.length>1&&(s[t]=1-r.length),s}(e.input),e.inputStream=new He(e)},supportsIncrementalParsing:!1}),Ce.initApplicationParser($e,ze);function et(e,t){const r=Object.create(t||{});if("string"!=typeof e){if(!(n=e).constructor||"function"!=typeof n.constructor.isBuffer||!n.constructor.isBuffer(n))throw new TypeError("Expected string as first argument, got "+g(e));e=e.toString()}var n;return function(e,t){const r=$e.match(e,"Grammars");if(r.failed())throw function(e){const t=new Error;return Object.defineProperty(t,"message",{enumerable:!0,get:()=>e.message}),Object.defineProperty(t,"shortMessage",{enumerable:!0,get:()=>"Expected "+e.getExpectedText()}),t.interval=e.getInterval(),t}(r);ze(r,t)}(e,r),r}t.ExperimentalIndentationSensitive=Xe,t._buildGrammar=ze,t.grammar=function(e,t){const r=et(e,t),n=Object.keys(r);if(0===n.length)throw new Error("Missing grammar definition");if(n.length>1){const e=r[n[1]].source;throw new Error(Y(e.sourceString,e.startIdx)+"Found more than one grammar definition -- use ohm.grammars() instead.")}return r[n[0]]},t.grammars=et,t.makeRecipe=je,t.ohmGrammar=$e,t.pexprs=ve,t.version="17.1.0"}},t={};!function r(n){var s=t[n];if(void 0!==s)return s.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}(138)})();